Notebook[{

Cell[CellGroupData[{
Cell["StylesEditor", "CodeSection",
 CellChangeTimes->{{3.685195966870777*^9, 
  3.685195975679967*^9}},ExpressionUUID->"85b1094d-24bd-4497-a0c2-\
1973e5049e92"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Styles\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.700003890652294*^9, 
  3.700003891782946*^9}},ExpressionUUID->"76058fb3-0554-47e3-930f-\
72d276016933"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$StyleSheetTitleCellStyles", "::", "usage"}], "=", 
   "\"\<The styles that are section-like\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"$StyleSheetSectionCellStyles", "::", "usage"}], "=", 
   "\"\<The styles that are section-like\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"$StyleSheetIOCellStyles", "::", "usage"}], "=", 
   "\"\<The styles that are code-like\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"$StyleSheetTextCellStyles", "::", "usage"}], "=", 
   "\"\<The styles that are text-like\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.687196125114172*^9, 3.687196147029951*^9}, 
   3.687196181387105*^9, 3.6871962926323137`*^9, {3.696785772545985*^9, 
   3.6967857939964733`*^9}, {3.6998874367894583`*^9, 3.699887450904407*^9}, {
   3.699978555826646*^9, 3.6999785960445433`*^9}, {3.710173358468441*^9, 
   3.7101733587135363`*^9}, {3.721838849287899*^9, 3.721838875803134*^9}, 
   3.721838909467738*^9, 3.7278303075128717`*^9, {3.727898449462537*^9, 
   3.727898464961833*^9}},ExpressionUUID->"9d50d84a-f9c5-4976-9a58-\
2ee472d8706d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"$StyleSheetCellDisplayStyleOptions", "::", "usage"}], "=", "\n", 
   "\t", "\"\<A listing of cell style options to make two cells look the same\
\>\""}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.709157153284047*^9, 3.709157214416912*^9}, 
   3.721838832749951*^9},ExpressionUUID->"cf684054-9e1f-45dd-8fc0-\
063fcebd1457"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]New\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7000038939001093`*^9, 
  3.700003897484646*^9}},ExpressionUUID->"be37cb52-e6c2-4c93-9a98-\
357f0e40cab4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetOpen", "::", "usage"}], "=", 
   "\"\<Opens the style definitions notebook for a given notebook\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetTemplate", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Creates a stylesheet editing template\n-Create in the current \
document by default\n-Opens a new one when passed Notebook[<ssname>] as the \
first argument\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetNew", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Creates a new style cell with a given name and optional parent style \
and options\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetDelete", "::", "usage"}], "=", 
   "\"\<Deletes all matching style cells\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetUpdate", "::", "usage"}], "=", 
   "\"\<StyleSheetDelete + StyleSheetNew\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6871140950580683`*^9, 3.6871141016296387`*^9}, {
  3.690746698709429*^9, 3.690746743101914*^9}, {3.696786056127264*^9, 
  3.696786088885553*^9}, {3.721838832755925*^9, 
  3.7218388327836847`*^9}},ExpressionUUID->"e83f8af5-ef75-4550-9fbc-\
94dddead88fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetDefaultStyles", "::", "usage"}], "=", 
   "\"\<Sets a default styling cascade\>\""}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.687114104647009*^9, 3.687114113508751*^9}, 
   3.72183883278841*^9},ExpressionUUID->"407923d2-6086-4d4c-adfc-ac2815330b6f"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Cells\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.700003907341711*^9, 
  3.7000039079159403`*^9}},ExpressionUUID->"d9f99772-2bda-4733-946b-\
214101849f9d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetCells", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Gets the cells in the current stylesheet that match a given style.\n\
Styles can be specified by a String, Symbol, or StyleData expression or a \
list thereof\>\""}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.6852001449286947`*^9, 3.6852001567856283`*^9}, {
   3.6852003432216578`*^9, 3.6852003662167873`*^9}, {3.685200838164661*^9, 
   3.685200872313528*^9}, {3.685218298728402*^9, 3.6852183139765387`*^9}, {
   3.685222543869891*^9, 3.68522256010673*^9}, {3.68536571425683*^9, 
   3.685365758414117*^9}, 3.696786091909066*^9, {3.696787203989876*^9, 
   3.696787268192474*^9}, {3.699983934167159*^9, 3.699983971144906*^9}, {
   3.699985588794774*^9, 3.699985608691431*^9}, {3.699986273072935*^9, 
   3.699986283818862*^9}, 
   3.721838832793253*^9},ExpressionUUID->"00d5ab2c-8b05-4572-ae05-\
769d9ecc9d9f"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"StylesheetNotebook", "::", "usage"}], "=", "\n", "\t", 
    "\"\<Finds the stylesheet notebook expression the given notebook depends \
on\>\""}], ";"}], "*)"}]], "CodeInput",
 CellChangeTimes->{{3.6852001449286947`*^9, 3.6852001567856283`*^9}, {
   3.6852003432216578`*^9, 3.6852003662167873`*^9}, {3.685200838164661*^9, 
   3.685200872313528*^9}, {3.685218298728402*^9, 3.6852183139765387`*^9}, {
   3.685222543869891*^9, 3.68522256010673*^9}, {3.68536571425683*^9, 
   3.685365758414117*^9}, 3.696786091909066*^9, {3.696787203989876*^9, 
   3.696787268192474*^9}, {3.699983934167159*^9, 3.699983971144906*^9}, {
   3.699985588794774*^9, 3.699985608691431*^9}, {3.699986273072935*^9, 
   3.699986285016712*^9}},ExpressionUUID->"a024dbe3-d7b5-4681-aea6-\
7e1cf0f3ccbf"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Notebook\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.700003910084114*^9, 
  3.700003911219941*^9}},ExpressionUUID->"3faeeacc-67ef-4394-90df-\
b9d347d92c17"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"$DefaultStyleSheetNotebook", "::", "usage"}], "=", "\n", "\t", 
    "\"\<Default.nb hidden notebook\>\""}], ";"}], 
  RowBox[{"(*", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"StyleSheetNotebookFind", "::", "usage"}], "=", "\n", "\t", 
     "\"\<Finds the notebook for a given stylesheet\>\""}], ";"}], 
   "*)"}]}]], "CodeInput",
 CellChangeTimes->{3.727898595162018*^9, 
  3.7278991484616833`*^9},ExpressionUUID->"481ad225-e0f8-4a9a-ada1-\
fb8e5b532158"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetNotebookObject", "::", "usage"}], "=", "\n", "\t", 
   "\"\<The style notebook object for editing a given notebook\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetParentNotebook", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Returns the NotebookObject that stores the styles of a given \
NotebookObject\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetNotebookGet", "::", "usage"}], "=", "\n", "\t", 
   "\"\<NotebookGets the StyleSheetParentNotebook\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetStyles", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Gets the styles from a stylesheet\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6852001449286947`*^9, 3.6852001567856283`*^9}, {
   3.6852003432216578`*^9, 3.6852003662167873`*^9}, {3.685200838164661*^9, 
   3.685200872313528*^9}, {3.685218298728402*^9, 3.6852183139765387`*^9}, {
   3.685222543869891*^9, 3.68522256010673*^9}, {3.68536571425683*^9, 
   3.685365758414117*^9}, 3.696786091909066*^9, {3.696787203989876*^9, 
   3.696787268192474*^9}, {3.699983934167159*^9, 3.699983971144906*^9}, {
   3.699985588794774*^9, 3.699985608691431*^9}, {3.699986273072935*^9, 
   3.699986292410757*^9}, {3.699986717027313*^9, 3.699986733030876*^9}, {
   3.72183883279783*^9, 3.721838832811133*^9}, {3.727899348989642*^9, 
   3.72789937017461*^9}, {3.7278994681546383`*^9, 
   3.7278994821565647`*^9}},ExpressionUUID->"582a79fc-40fb-425e-a4bd-\
8f78e9cac987"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Edit\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.700003915285318*^9, 
  3.700003916755829*^9}},ExpressionUUID->"e92ed7ad-f29f-4e6c-ad2d-\
49d83b3bbfef"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetApplyEdits", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Applies the edits from StyleSheetEdit\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetEdit", "::", "usage"}], "=", 
   "\"\<Applies the options given to the given cell styles in the given \
notebook\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetDrop", "::", "usage"}], 
   "\"\<Drops the options given from the given cell styles in the given \
notebook\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetValue", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Gets the value of a style option for a cell style\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetSync", "::", "usage"}], "=", 
   "\"\<Copies style options from one style to another\>\""}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6852001449286947`*^9, 3.6852001567856283`*^9}, {
   3.6852003432216578`*^9, 3.6852003662167873`*^9}, {3.685200838164661*^9, 
   3.685200872313528*^9}, 3.685218298728402*^9, {3.687114518728004*^9, 
   3.6871145307507677`*^9}, {3.687115073807754*^9, 3.687115089948007*^9}, {
   3.699986298256027*^9, 3.699986312948915*^9}, {3.7008782069179087`*^9, 
   3.700878215081093*^9}, {3.721838832816347*^9, 
   3.721838832838538*^9}},ExpressionUUID->"9f7cde8b-72e0-4b72-84b4-\
705ec86e4095"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetEditEvents", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Edits the \[Star]EventActions\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetEditAliases", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Edits the InputAliases\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetEditAutoReplacements", "::", "usage"}], "=", "\n", 
   "\t", "\"\<Edits the InputAutoReplacements\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetEditTaggingRules", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Edits the TaggingRules\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.685200807388476*^9, 3.6852008330822973`*^9}, {
   3.6852008841817427`*^9, 3.685200884584649*^9}, {3.685282157797049*^9, 
   3.685282194095482*^9}, {3.685282312598297*^9, 3.685282318061664*^9}, {
   3.6973980049880257`*^9, 3.697398007113484*^9}, 3.699296777697012*^9, {
   3.700935244140588*^9, 3.700935313623124*^9}, 3.709209431229254*^9, {
   3.716840649132902*^9, 3.716840658780424*^9}, {3.7218388328429203`*^9, 
   3.721838832856063*^9}},ExpressionUUID->"cd739c91-258b-4c2f-ab44-\
21c1b96176ed"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Style Attributes\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7296268448128223`*^9, 
  3.729626849459648*^9}},ExpressionUUID->"ad6b9efc-5fd0-4f98-ae39-\
79e0cb117d1c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"StyleDefinitionsValue", "::", "usage"}], "=", 
   "\"\<experimental\>\""}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.7296268505876217`*^9, 3.7296268647487803`*^9}, 
   3.7296272267675877`*^9},ExpressionUUID->"58d0061a-95fa-4000-a0c2-\
82ead3ec9c6d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"aee7ad35-1438-44e2-ba36-\
9687b1fdc968"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]frontEndExecuteBlock\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.716841007659235*^9, {3.716841548992594*^9, 3.716841549582745*^9}, {
   3.729721598059421*^9, 
   3.729721598291363*^9}},ExpressionUUID->"e0cd06c5-516b-49e4-8f53-\
2f7ce32e7cec"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"!", 
    RowBox[{"ValueQ", "[", "$frontEndExecuteBlock", "]"}]}], ",", "\n", "\t", 
   
   RowBox[{
    RowBox[{"$frontEndExecuteBlock", "=", "False"}], ";", "\n", "\t", 
    RowBox[{"$frontEndExecuteBlock", "//", "Protect"}]}]}], "\n", "\t", 
  "]"}]], "CodeInput",
 CellChangeTimes->{{3.716841851461426*^9, 
  3.7168418778513727`*^9}},ExpressionUUID->"2493267d-7930-4d20-a57c-\
7cabc2c4c1ee"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"frontEndExecuteSow", "[", "e_", "]"}], ":=", "\n", "\t", 
   RowBox[{"Sow", "[", 
    RowBox[{"e", ",", " ", "\"\<FrontEndExecute\>\""}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"frontEndExecuteRouter", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"If", "[", 
    RowBox[{"$frontEndExecuteBlock", ",", "\n", "\t\t", 
     RowBox[{"frontEndExecuteSow", "[", "a", "]"}], ",", "\n", "\t\t", "b"}], 
    "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "frontEndExecuteRouter", "~", "SetAttributes", "~", "HoldAllComplete"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"frontEndExecuteBlock", "[", "e_", "]"}], "/;", 
    RowBox[{"!", 
     RowBox[{"TrueQ", "[", "$frontEndExecuteBlock", "]"}]}]}], ":=", "\n", 
   "\t", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"$frontEndExecuteBlock", "=", "True"}], "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"rd", "=", 
         RowBox[{"Reap", "[", 
          RowBox[{"e", ",", "\"\<FrontEndExecute\>\""}], "]"}]}], "}"}], ",", 
       "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"rd", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ":", 
             RowBox[{"{", "__", "}"}]}], "}"}], ":>", "\n", "\t\t\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"a", ",", " ", "_Hold"}], "]"}], ",", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{
             "MathLink`CallFrontEndHeld", "@@", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"Append", "[", "\n", "\t\t\t\t\t\t\t ", 
               RowBox[{
                RowBox[{"Thread", "[", 
                 RowBox[{
                  RowBox[{"Replace", "[", 
                   RowBox[{"a", ",", " ", 
                    RowBox[{
                    RowBox[{"h", ":", 
                    RowBox[{"Except", "[", "_Hold", "]"}]}], "\[RuleDelayed]", 
                    RowBox[{"Hold", "[", "h", "]"}]}]}], "]"}], ",", "Hold"}],
                  "]"}], ",", "\n", "\t\t\t\t\t\t\t ", 
                "System`FrontEndDump`NoResult"}], "\n", "\t\t\t\t\t\t\t ", 
               "]"}]}], ",", "\n", "\t\t\t\t\t\t", 
             RowBox[{"MathLink`CallFrontEnd", "[", 
              RowBox[{"a", ",", " ", "System`FrontEndDump`NoResult"}], 
              "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t", 
         "]"}], ";", "\n", "\t\t\t", 
        RowBox[{"rd", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], "\n", "\t\t\t", "]"}]}], "\n", 
    "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"frontEndExecuteBlock", "[", "e_", "]"}], "/;", 
    RowBox[{"TrueQ", "[", "$frontEndExecuteBlock", "]"}]}], ":=", "e"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
  "frontEndExecuteBlock", "~", "SetAttributes", "~", "HoldAllComplete"}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.716840967849053*^9, 3.716840992762948*^9}, {
  3.716841113994576*^9, 3.71684111951997*^9}, {3.716841154858007*^9, 
  3.71684136709608*^9}, {3.716841551429181*^9, 3.716841591633135*^9}, {
  3.71684184086341*^9, 3.7168418485259523`*^9}, {3.71684188534975*^9, 
  3.7168418975954943`*^9}},ExpressionUUID->"5c9a1ae7-05a6-4cae-a51d-\
c51a452dc0da"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Styles\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.687196242622629*^9, 3.6871962434773417`*^9}, {
  3.7297215970274553`*^9, 
  3.729721597155303*^9}},ExpressionUUID->"08a14627-a7f3-4522-8625-\
70d6eeb1a245"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$StyleSheetTitleCellStyles", "=", "\n", "\t", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Title\>\"", ",", "\"\<Chapter\>\"", ",", "\"\<Subchapter\>\""}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$StyleSheetSectionCellStyles", "=", "\n", "\t", 
   RowBox[{"{", "\n", "\t\t", 
    RowBox[{
    "\"\<Section\>\"", ",", "\n", "\t\t", "\"\<Subsection\>\"", ",", " ", 
     "\"\<Subsubsection\>\"", ",", "\n", "\t\t", "\"\<Subsubsubsection\>\"", 
     ",", " ", "\"\<Subsubsubsubsection\>\""}], "\n", "\t\t", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$StyleSheetIOCellStyles", "=", "\n", "\t", 
   RowBox[{"{", 
    RowBox[{"\"\<Input\>\"", ",", "\"\<Code\>\"", ",", "\"\<Output\>\""}], 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$StyleSheetTextCellStyles", "=", "\n", "\t", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Text\>\"", ",", " ", "\"\<Item\>\"", ",", " ", 
     "\"\<ItemParagraph\>\"", ",", " ", "\"\<Subitem\>\"", ",", " ", 
     "\"\<SubitemParagraph\>\""}], "}"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.687196245102067*^9, 3.687196313052129*^9}, {
  3.6967857232469807`*^9, 3.696785768092935*^9}, {3.721838849296349*^9, 
  3.721838869106978*^9}, {3.7352303031410713`*^9, 
  3.735230335225609*^9}},ExpressionUUID->"36efb331-49af-4040-93d4-\
213e8dca2898"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$StyleSheetCellTextStyleOptions", "=", "\n", "\t", 
   RowBox[{"{", "\n", "\t\t", 
    RowBox[{
    "FontSize", ",", "\n", "\t\t", "FontColor", ",", "\n", "\t\t", 
     "FontSlant", ",", "\n", "\t\t", "FontWeight", ",", "\n", "\t\t", 
     "TabSpacings"}], "\n", "\t\t", "}"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.709157227050364*^9, 3.70915728770327*^9}, 
   3.721838832860882*^9},ExpressionUUID->"72cdaf97-3d5d-449d-82cd-\
ec40342d7476"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{"General", "::", "shdw"}], "]"}], ";"}], "\n", 
 RowBox[{"System`CellFrameStyle", ";"}], "\n", 
 RowBox[{"System`GroupOpenerColor", ";"}], "\n", 
 RowBox[{"System`GroupOpenerInsideFrame", ";"}], "\n", 
 RowBox[{
  RowBox[{"On", "[", 
   RowBox[{"General", "::", "shdw"}], "]"}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.721003037724268*^9, 
  3.721003059901574*^9}},ExpressionUUID->"30a8e1cc-41f6-45c1-a3b3-\
9d21d5babc53"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$StyleSheetCellFrameStyleOptions", "=", "\n", "\t", 
   RowBox[{"{", "\n", "\t\t", 
    RowBox[{
    "CellFrame", ",", "\n", "\t\t", "Background", ",", "\n", "\t\t", 
     "CellFrameColor", ",", "\n", "\t\t", "System`CellFrameStyle"}], "\n", 
    "\t\t", "}"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.709157227050364*^9, 3.709157254032412*^9}, {
   3.709157294894218*^9, 3.7091573244185953`*^9}, 
   3.7218388328688297`*^9},ExpressionUUID->"58503bd0-dc3d-4ed2-9604-\
8dc478cd0134"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$StyleSheetCellSpacingStyleOptions", "=", "\n", "\t", 
   RowBox[{"{", "\n", "\t\t", 
    RowBox[{"CellMargins", ",", "\n", "\t\t", "CellFrameMargins"}], "\n", 
    "\t\t", "}"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.709157227050364*^9, 3.709157254032412*^9}, {
   3.709157294894218*^9, 3.7091573244185953`*^9}, {3.709157357699589*^9, 
   3.709157366899035*^9}, 
   3.721838832876305*^9},ExpressionUUID->"9afaf86f-2121-4233-835c-\
bde1c47f340b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$StyleSheetCellDisplayStyleOptions", ":=", "\n", "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{
    "$StyleSheetCellTextStyleOptions", ",", "\n", "\t\t", 
     "$StyleSheetCellFrameStyleOptions", ",", "\n", "\t\t", 
     "$StyleSheetCellSpacingStyleOptions"}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.709157345643787*^9, 3.709157381417562*^9}, {
  3.721838832881896*^9, 
  3.721838832897251*^9}},ExpressionUUID->"f8e2b156-8429-4047-b95d-\
88add788b400"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]StyleSheetNotebookFind\[RightFloor]", "CodeSubsubsection",
 
 Evaluatable->True,
 CellChangeTimes->{{3.699985975830538*^9, 3.699985996866788*^9}, 
   3.721838909490369*^9, 3.727830307558359*^9, 3.727898595199312*^9, {
   3.7297215951315928`*^9, 
   3.729721595475514*^9}},ExpressionUUID->"6c9711a8-87be-45b3-8ab1-\
51445d044df3"],

Cell["A direct copy to make standalone", "Text",
 CellChangeTimes->{{3.727898814244298*^9, 
  3.727898821491349*^9}},ExpressionUUID->"cbc73063-a7b8-4d10-847f-\
f9999ed810ae"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ssFENotebooks", "[", 
    RowBox[{"f_String", "?", "FileExistsQ"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"List", "@", 
    RowBox[{"SelectFirst", "[", 
     RowBox[{
      RowBox[{"FrontEndExecute", "@", 
       RowBox[{"FrontEnd`ObjectChildren", "[", "$FrontEnd", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Quiet", "@", 
         RowBox[{"NotebookFileName", "@", "#"}]}], "===", "f"}], "&"}]}], 
     "\n", "\t\t", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ssFENotebooks", "[", 
    RowBox[{"Optional", "[", 
     RowBox[{"\"\<*\>\"", ",", "\"\<*\>\""}], "]"}], "]"}], ":=", "\n", "\t", 
   
   RowBox[{"FrontEndExecute", "@", 
    RowBox[{"FrontEnd`ObjectChildren", "[", "$FrontEnd", "]"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"ssFENotebooks", "[", 
   RowBox[{"pat", ":", 
    RowBox[{"Except", "[", 
     RowBox[{"\"\<*\>\"", "|", 
      RowBox[{"_String", "?", "FileExistsQ"}]}], "]"}]}], "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"FrontEndExecute", "@", 
     RowBox[{"FrontEnd`ObjectChildren", "[", "$FrontEnd", "]"}]}], ",", "\n", 
    "\t", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"Replace", "[", 
       RowBox[{
        RowBox[{"Quiet", "@", 
         RowBox[{"NotebookFileName", "@", "#"}]}], ",", 
        RowBox[{"{", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"s_String", "\[RuleDelayed]", "\n", "\t\t\t\t\t", 
           RowBox[{"StringMatchQ", "[", 
            RowBox[{"s", ",", "pat"}], "]"}]}], ",", "\n", "\t", "\t\t\t", 
          RowBox[{"_", "\[Rule]", "False"}]}], "\n", "\t", "\t\t\t", "}"}]}], 
       "\n", "\t", "\t\t", "]"}], "||", "\n", "\t", "\t", 
      RowBox[{"Replace", "[", 
       RowBox[{
        RowBox[{"Quiet", "@", 
         RowBox[{"NotebookFileName", "@", "#"}]}], ",", 
        RowBox[{"{", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"s_String", "\[RuleDelayed]", "\n", "\t\t\t\t\t", 
           RowBox[{"FileBaseName", "@", 
            RowBox[{"StringMatchQ", "[", 
             RowBox[{"s", ",", "pat"}], "]"}]}]}], ",", "\n", "\t", "\t\t\t", 
          
          RowBox[{"_", "\[Rule]", "False"}]}], "\n", "\t", "\t\t\t", "}"}]}], 
       "\n", "\t\t\t", "]"}], "||", "\n", "\t\t", 
      RowBox[{"StringMatchQ", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"WindowTitle", "/.", 
         RowBox[{"AbsoluteOptions", "[", 
          RowBox[{"#", ",", "WindowTitle"}], "]"}]}], ",", "\n", "\t", "\t\t",
         "pat"}], "\n", "\t", "\t\t", "]"}]}], "&"}]}], "\n", "\t", "\t", 
   "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.699967231847444*^9, 3.6999673514968233`*^9}, {
   3.6999673986729183`*^9, 3.699967472750443*^9}, {3.699968745734887*^9, 
   3.699968746597622*^9}, {3.6999713521008663`*^9, 3.6999713544036283`*^9}, 
   3.699982968508132*^9, {3.699983063040855*^9, 3.6999831697256603`*^9}, {
   3.699983710331695*^9, 3.699983716288301*^9}, {3.6999844402667017`*^9, 
   3.699984451429895*^9}, {3.699984551726568*^9, 3.6999845654905567`*^9}, {
   3.727898797621332*^9, 
   3.727898801591589*^9}},ExpressionUUID->"8080e188-459b-477d-9691-\
032a8a96dfce"],

Cell[BoxData[{
 RowBox[{"StyleSheetNotebookFind", "//", "Clear"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetNotebookFind", "[", 
    RowBox[{"name", ":", 
     RowBox[{"_String", "|", 
      RowBox[{"{", "__String", "}"}], "|", "_FrontEnd`FileName"}]}], "]"}], ":=",
    "\n", "\t", 
   RowBox[{"Replace", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"FrontEndExecute", "@", "\n", "\t\t\t", 
      RowBox[{"FrontEnd`FindFileOnPath", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"StringTrim", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"Replace", "[", 
            RowBox[{"name", ",", " ", "\n", "\t", "\t\t\t\t\t", 
             RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"l_List", "\[RuleDelayed]", 
                RowBox[{"FileNameJoin", "[", "l", "]"}]}], ",", "\n", "\t", 
               "\t\t\t\t\t\t", 
               RowBox[{"f_FrontEnd`FileName", "\[RuleDelayed]", 
                RowBox[{"ToFileName", "[", "f", "]"}]}]}], "\n", "\t", 
              "\t\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t\t\t\t", "]"}], ",", 
           "\n", "\t\t\t\t\t", "\"\<.nb\>\""}], "\n", "\t\t\t\t\t", "]"}], 
         "<>", "\"\<.nb\>\""}], ",", "\n", "\t\t\t\t", 
        "\"\<StyleSheetPath\>\""}], "\n", "\t\t\t\t", "]"}]}], ",", "\n", 
     "\t\t", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"f_String", "?", "FileExistsQ"}], ":>", "\n", "\t", "\t\t\t", 
        
        RowBox[{"Replace", "[", "\n", "\t", "\t\t\t\t", 
         RowBox[{
          RowBox[{"ssFENotebooks", "@", "f"}], ",", "\n", "\t", "\t\t\t\t", 
          RowBox[{"{", "\n", "\t", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"{", "}"}], "\[Rule]", 
             RowBox[{"Missing", "[", "\"\<NotFound\>\"", "]"}]}], ",", "\n", 
            "\t", "\t", "\t", "\t", "\t\t", 
            RowBox[{
             RowBox[{"{", "nb_", "}"}], "\[RuleDelayed]", "nb"}]}], "\n", 
           "\t", "\t\t\t\t\t", "}"}]}], "\n", "\t", "\t\t\t\t", "]"}]}], ",", 
       "\n", "\t", "\t\t", 
       RowBox[{"_", "->", 
        RowBox[{"Missing", "[", "\"\<FileNotFound\>\"", "]"}]}]}], "\n", 
      "\t\t\t", "}"}]}], "\n", "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.727898890308495*^9, 3.7278988923785763`*^9}, {
  3.727898980727962*^9, 
  3.727899025601656*^9}},ExpressionUUID->"88387b07-3c23-437a-8a62-\
0b5fe1c5c078"],

Cell[BoxData[
 RowBox[{"$DefaultStyleSheetNotebook", ":=", "\[IndentingNewLine]", 
  RowBox[{
  "StyleSheetNotebookFind", "[", "\"\<Default\>\"", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.699887456803743*^9, 3.699887471852294*^9}, 
   3.699887561215859*^9, {3.6999099264444647`*^9, 3.699909933106711*^9}, {
   3.699909970414607*^9, 3.699909972249926*^9}, {3.699971395204818*^9, 
   3.699971418082405*^9}, {3.699971474376274*^9, 3.699971528420122*^9}, {
   3.6999785339530687`*^9, 3.699978538054737*^9}, {3.7218388918218117`*^9, 
   3.7218389095094233`*^9}, 3.727830307581229*^9, 
   3.727898595219205*^9},ExpressionUUID->"99797694-bddb-487e-9bb0-\
204b373ca969"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ParentNotebook\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.69998133743228*^9, 3.699981343094871*^9}, 
   3.69998599066285*^9, {3.7278994126902237`*^9, 3.727899414482629*^9}, {
   3.7297215932843313`*^9, 
   3.7297215936831303`*^9}},ExpressionUUID->"558cfccb-5a00-4d8d-a113-\
9b197ec00505"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ssFileName\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.721840240852935*^9, 
  3.721840258084099*^9}},ExpressionUUID->"ab1a9ac2-4c79-4aaa-a9bb-\
cb77051956d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ssFileName", "[", "file_", "]"}], ":=", "\n", "\t", 
  RowBox[{"FrontEndExecute", "@", "\n", "\t\t", 
   RowBox[{"FrontEnd`FindFileOnPath", "[", "\n", "\t\t\t", 
    RowBox[{
     RowBox[{
      RowBox[{"StringTrim", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"Replace", "[", 
         RowBox[{"file", ",", " ", "\n", "\t\t\t\t\t", 
          RowBox[{"{", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"l_List", "\[RuleDelayed]", 
             RowBox[{"FileNameJoin", "[", "l", "]"}]}], ",", "\n", 
            "\t\t\t\t\t\t", 
            RowBox[{"f_FrontEnd`FileName", "\[RuleDelayed]", 
             RowBox[{"ToFileName", "[", "f", "]"}]}]}], "\n", "\t\t\t\t\t\t", 
           "}"}]}], "\n", "\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", 
        "\"\<.nb\>\""}], "\n", "\t\t\t\t", "]"}], "<>", "\"\<.nb\>\""}], ",", 
     "\n", "\t\t\t", "\"\<StyleSheetPath\>\""}], "\n", "\t\t\t", 
    "]"}]}]}]], "CodeInput",
 CellChangeTimes->{{3.699982725147447*^9, 3.699982756677902*^9}, {
   3.699982894123269*^9, 3.6999828944487667`*^9}, 3.699984533455413*^9, {
   3.721840282849289*^9, 3.721840303774027*^9}, {3.727899191483498*^9, 
   3.727899207236018*^9}},ExpressionUUID->"bdf973a1-92bd-4061-a674-\
577eef4bff9c"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ssNotebookInformationNotebook\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.721840240852935*^9},ExpressionUUID->"9efafd53-91ce-4265-855e-\
25f66fd72512"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ssNotebookInformationNotebook", "[", "nb_", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"Replace", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"Lookup", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"Replace", "[", 
       RowBox[{
        RowBox[{"NotebookInformation", "[", "nb", "]"}], ",", " ", 
        RowBox[{
         RowBox[{"Except", "[", 
          RowBox[{"_", "?", "OptionQ"}], "]"}], "\[Rule]", 
         RowBox[{"{", "}"}]}]}], "]"}], ",", "\n", "\t\t\t", 
      "\"\<StyleDefinitions\>\""}], "\n", "\t\t\t", "]"}], ",", "\n", "\t\t", 
    
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n_NotebookObject", ",", "___"}], "}"}], "\[RuleDelayed]", 
     "n"}]}], "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.72184016260106*^9, 3.721840188695191*^9}, 
   3.727151384863134*^9},ExpressionUUID->"3ac4f81f-ed2d-4bfc-9d76-\
2a178e101ddd"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]StyleSheetNotebookFileName\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.721840240852935*^9, 
  3.721840249004513*^9}},ExpressionUUID->"bf94ca1a-ae47-4610-a768-\
d3d049091f84"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetNotebookFileName", "[", "nb_NotebookObject", "]"}], ":=",
    "\n", "\t", 
   RowBox[{"Replace", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"CurrentValue", "[", 
      RowBox[{"nb", ",", "StyleDefinitions"}], "]"}], ",", "\n", "\t\t", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"f", ":", 
         RowBox[{"_String", "|", "_FrontEnd`FileName"}]}], "\[RuleDelayed]", 
        "\n", "\t", "\t\t\t", 
        RowBox[{"ssFileName", "[", "f", "]"}]}], ",", "\n", "\t", "\t\t", 
       RowBox[{"_Notebook", ":>", "\n", "\t", "\t\t\t", 
        RowBox[{"Missing", "[", "\"\<NotAvailable\>\"", "]"}]}]}], "\n", 
      "\t\t\t", "}"}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.699981344845587*^9, 3.69998136951822*^9}, {
   3.699981482025834*^9, 3.699981576284783*^9}, {3.699981740970085*^9, 
   3.69998184317236*^9}, {3.6999836200605583`*^9, 3.699983655291586*^9}, {
   3.6999837202008038`*^9, 3.699983777537898*^9}, {3.699984237235594*^9, 
   3.699984251231406*^9}, 3.721838832901931*^9, {3.727899215863031*^9, 
   3.7278992218215513`*^9}},ExpressionUUID->"6c4831b7-6bad-4ede-8284-\
857def1b9a5b"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]StyleSheetParentNotebook\[RightFloor]", \
"CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.721840240852935*^9, 3.721840246971013*^9}, 
   3.727899348854507*^9},ExpressionUUID->"d109764a-d671-4d74-bbce-\
1185a077f544"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"AssociationQ", "@", "$ssNbObjCache"}]}], ",", "\n", "\t", 
    RowBox[{"$ssNbObjCache", "=", 
     RowBox[{"<|", "|>"}]}]}], "\n", "\t", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetParentNotebook", "[", "nb_NotebookObject", "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"Replace", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Replace", "[", 
      RowBox[{
       RowBox[{"ssNotebookInformationNotebook", "[", "nb", "]"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{
        RowBox[{"Except", "[", 
         RowBox[{"_NotebookObject", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"NotebookInformation", "@", "#"}], "=!=", "$Failed"}], 
            "&"}], ")"}]}], "]"}], ":>", "\n", "\t\t\t\t", 
        RowBox[{"Lookup", "[", 
         RowBox[{"$ssNbObjCache", ",", " ", "nb"}], "]"}]}]}], "\n", "\t\t\t",
       "]"}], ",", "\n", "\t\t", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"_Missing", "|", 
        RowBox[{"_NotebookObject", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"NotebookInformation", "@", "#"}], "===", "$Failed"}], 
           "&"}], ")"}]}]}], ":>", "\n", "\t", "\t\t\t", 
       RowBox[{"Set", "[", 
        RowBox[{
         RowBox[{"$ssNbObjCache", "[", "nb", "]"}], ",", "\n", "\t\t\t\t\t", 
         RowBox[{"First", "@", "\n", "\t\t\t\t\t\t", 
          RowBox[{"Lookup", "[", "\n", "\t\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"Replace", "[", 
             RowBox[{
              RowBox[{"NotebookInformation", "[", "nb", "]"}], ",", " ", 
              RowBox[{
               RowBox[{"Except", "[", 
                RowBox[{"_", "?", "OptionQ"}], "]"}], "\[Rule]", 
               RowBox[{"{", "}"}]}]}], "]"}], ",", "\n", "\t", 
            "\t\t\t\t\t\t", "\"\<StyleDefinitons\>\"", ",", "\n", "\t", 
            "\t\t\t\t\t\t", 
            RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t", 
             RowBox[{"Replace", "[", 
              RowBox[{
               RowBox[{"StyleSheetNotebookFileName", "[", "nb", "]"}], ",", 
               RowBox[{
               "{", "\n", "\t", "\t", "\t", "\t", "\t", "\t", "\t", "\t\t", 
                RowBox[{
                 RowBox[{"f_String", ":>", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                  RowBox[{"Replace", "[", 
                   RowBox[{
                    RowBox[{"ssFENotebooks", "[", "f", "]"}], ",", 
                    RowBox[{
                    "{", "\n", "\t", "\t", "\t", "\t", "\t", "\t", "\t", 
                    "\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", "}"}], "\[RuleDelayed]", 
                    RowBox[{"Missing", "[", "\"\<NotFound\>\"", "]"}]}], ",", 
                    "\n", "\t", "\t", "\t", "\t", "\t", "\t", "\t", 
                    "\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"n_", ",", "___"}], "}"}], "\[RuleDelayed]", 
                    "n"}]}], "\n", "\t", "\t", "\t", "\t", "\t", "\t", "\t", 
                    "\t\t\t\t", "}"}]}], "]"}]}], ",", "\n", "\t", "\t", "\t",
                  "\t", "\t", "\t", "\t", "\t\t", 
                 RowBox[{
                 "_Missing", ":>", "\n", "\t", "\t", "\t", "\t", "\t", "\t", 
                  "\t", "\t\t\t", 
                  RowBox[{"With", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"n", "=", 
                    RowBox[{"CurrentValue", "[", 
                    RowBox[{"nb", ",", "StyleDefinitions"}], "]"}]}], "}"}], 
                    ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"SelectFirst", "[", 
                    RowBox[{
                    RowBox[{"ssFENotebooks", "[", "]"}], ",", "\n", "\t", 
                    "\t", "\t", "\t", "\t", "\t", "\t", "\t", "\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"NotebookGet", "@", "#"}], "===", "n"}], "&"}]}], 
                    "]"}]}], "\n", "\t", "\t", "\t", "\t", "\t", "\t", "\t", 
                   "\t\t\t\t", "]"}]}]}], "\n", "\t", "\t\t\t\t\t\t\t\t", 
                "}"}]}], "]"}], "\n", "\t", "\t\t\t\t\t\t\t", "}"}]}], "\n", 
           "\t", "\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n",
       "\t\t\t", "}"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"StyleSheetParentNotebook", "[", 
   RowBox[{"name", ":", 
    RowBox[{"_String", "|", 
     RowBox[{"{", "__String", "}"}], "|", "_FrontEnd`FileName"}]}], "]"}], ":=",
   "\n", "\t", 
  RowBox[{"Replace", "[", 
   RowBox[{
    RowBox[{"StyleSheetNotebookFind", "[", "name", "]"}], ",", "\n", "\t\t", 
    RowBox[{"nb_NotebookObject", ":>", 
     RowBox[{"StyleSheetParentNotebook", "[", "nb", "]"}]}]}], "\n", "\t\t", 
   "]"}]}]}], \
"CodeInput",ExpressionUUID->"fea8c7f3-017d-4be9-95b4-e3307788f310"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"StyleSheetParentNotebook", "/:", "\n", "\t", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"Unset", "[", 
     RowBox[{"StyleSheetParentNotebook", "[", "nb_NotebookObject", "]"}], 
     "]"}], "]"}], ":=", "\n", "\t\t", 
   RowBox[{
    RowBox[{"$ssNbObjCache", "[", "nb", "]"}], "=."}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"StyleSheetParentNotebook", "/:", "\n", "\t", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"Unset", "[", 
     RowBox[{"StyleSheetParentNotebook", "[", 
      RowBox[{"nb", ":", 
       RowBox[{
        RowBox[{"EvaluationNotebook", "[", "]"}], "|", 
        RowBox[{"InputNotebook", "[", "]"}]}]}], "]"}], "]"}], "]"}], ":=", 
   "\n", "\t\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", "=", "nb"}], "}"}], ",", "\n", "\t\t\t", 
     RowBox[{"Unset", "[", 
      RowBox[{"StyleSheetParentNotebook", "[", "n", "]"}], "]"}]}], "\n", 
    "\t\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"StyleSheetParentNotebook", "/:", "\n", "\t", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"Set", "[", 
     RowBox[{
      RowBox[{"StyleSheetParentNotebook", "[", "nb_NotebookObject", "]"}], 
      ",", "n_NotebookObject"}], "]"}], "]"}], ":=", "\n", "\t\t", 
   RowBox[{
    RowBox[{"$ssNbObjCache", "[", "nb", "]"}], "=", "n"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"StyleSheetParentNotebook", "/:", "\n", "\t", 
   RowBox[{"HoldPattern", "[", "\n", "\t\t", 
    RowBox[{"Set", "[", 
     RowBox[{
      RowBox[{"StyleSheetParentNotebook", "[", 
       RowBox[{"nb", ":", 
        RowBox[{
         RowBox[{"EvaluationNotebook", "[", "]"}], "|", 
         RowBox[{"InputNotebook", "[", "]"}]}]}], "]"}], ",", "\n", "\t\t\t", 
      "n_NotebookObject"}], "]"}], "\n", "\t\t", "]"}], ":=", "\n", "\t\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"e", "=", "nb"}], "}"}], ",", "\n", "\t\t\t", 
     RowBox[{"Set", "[", 
      RowBox[{
       RowBox[{"StyleSheetParentNotebook", "[", "e", "]"}], ",", "n"}], 
      "]"}]}], "\n", "\t\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"StyleSheetParentNotebook", "/:", "\n", "\t", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"SetDelayed", "[", 
     RowBox[{
      RowBox[{"StyleSheetParentNotebook", "[", "nb_NotebookObject", "]"}], 
      ",", "n_"}], "]"}], "]"}], ":=", "\n", "\t\t", 
   RowBox[{
    RowBox[{"$ssNbObjCache", "[", "nb", "]"}], ":=", "n"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"StyleSheetParentNotebook", "/:", "\n", "\t", 
   RowBox[{"HoldPattern", "[", "\n", "\t\t", 
    RowBox[{"SetDelayed", "[", 
     RowBox[{
      RowBox[{"StyleSheetParentNotebook", "[", 
       RowBox[{"nb", ":", 
        RowBox[{
         RowBox[{"EvaluationNotebook", "[", "]"}], "|", 
         RowBox[{"InputNotebook", "[", "]"}]}]}], "]"}], ",", "\n", "\t\t\t", 
      "n_"}], "]"}], "\n", "\t\t", "]"}], ":=", "\n", "\t\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"e", "=", "nb"}], "}"}], ",", "\n", "\t\t\t", 
     RowBox[{"SetDelayed", "[", 
      RowBox[{
       RowBox[{"StyleSheetParentNotebook", "[", "e", "]"}], ",", "n"}], 
      "]"}]}], "\n", "\t\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699983762331685*^9, 3.699983923459196*^9}, {
  3.699984056134569*^9, 3.699984057142363*^9}, {3.6999841855542994`*^9, 
  3.6999842118948603`*^9}, {3.699984812044589*^9, 3.6999849126125383`*^9}, {
  3.6999858045163193`*^9, 3.699985822929978*^9}, {3.6999861485120783`*^9, 
  3.69998622596529*^9}, {3.6999863327533007`*^9, 3.699986424011833*^9}, {
  3.699986461841112*^9, 3.699986465085147*^9}, {3.721838832918619*^9, 
  3.7218388329949923`*^9}, {3.727899348887464*^9, 
  3.727899348965539*^9}},ExpressionUUID->"38608d34-b04b-42b6-9493-\
bb0067175a50"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]NotebookGet\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699986695777955*^9, 3.6999866990395823`*^9}, 
   3.699986752247262*^9},ExpressionUUID->"283095d9-5c8f-4ef3-8182-\
353dc97e02d9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetNotebookGet", "[", "nb_NotebookObject", "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"NotebookGet", "@", 
    RowBox[{"StyleSheetParentNotebook", "@", "nb"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetNotebookGet", "[", 
    RowBox[{"Optional", "[", 
     RowBox[{"Automatic", ",", "Automatic"}], "]"}], "]"}], ":=", "\n", "\t", 
   
   RowBox[{"StyleSheetNotebookGet", "@", 
    RowBox[{"EvaluationNotebook", "[", "]"}]}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.699986738024*^9, 3.6999867884622393`*^9}, {
   3.7218388330006332`*^9, 3.7218388330138893`*^9}, 
   3.727899348969922*^9},ExpressionUUID->"97d1ca48-2525-401b-9328-\
7e3f3ccd9f11"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]NotebookObject\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.699985986550849*^9, 3.699985988517898*^9}, {
  3.727899409390019*^9, 
  3.727899411240399*^9}},ExpressionUUID->"72480f46-ebf4-4068-9fa5-\
d62d5ea71a5c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetNotebookObject", "[", 
    RowBox[{"nb", ":", 
     RowBox[{"_NotebookObject", "|", "Automatic"}], ":", "Automatic"}], "]"}],
    ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"e", "=", 
       RowBox[{"Replace", "[", 
        RowBox[{"nb", ",", 
         RowBox[{"Automatic", ":>", 
          RowBox[{"EvaluationNotebook", "[", "]"}]}]}], "]"}]}], "}"}], ",", 
     "\n", "\t\t", 
     RowBox[{"Replace", "[", 
      RowBox[{
       RowBox[{"CurrentValue", "[", 
        RowBox[{"e", ",", "StyleDefinitions"}], "]"}], ",", 
       RowBox[{"{", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{
          "\"\<StylesheetFormatting.nb\>\"", "|", 
           "\"\<PrivateStylesheetFormatting.nb\>\"", "|", "\n", "\t\t\t\t", 
           RowBox[{"Notebook", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"___", ",", "\n", "\t\t\t\t\t", 
               RowBox[{"Cell", "[", "\n", "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"StyleData", "[", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{
                  "StyleDefinitions", "->", "\n", "\t\t\t\t\t\t\t\t", 
                   RowBox[{"(", 
                    RowBox[{
                    "\"\<PrivateStylesheetFormatting.nb\>\"", "|", 
                    "\"\<StylesheetFormatting.nb\>\""}], ")"}]}], "\n", 
                  "\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t", "___"}], 
                "]"}], ",", "\n", "\t\t\t\t\t", "___"}], "\n", "\t\t\t\t\t", 
              "}"}], ",", "\n", "\t\t\t\t\t", "___"}], "\n", "\t\t\t\t\t", 
            "]"}]}], "\[Rule]", "e"}], ",", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{"s", ":", 
           RowBox[{"_String", "|", "_FrontEnd`FileName"}]}], ":>", "\n", 
          "\t\t\t\t", 
          RowBox[{"(", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"SetOptions", "[", 
             RowBox[{"e", ",", "\n", "\t", "\t\t\t\t\t", 
              RowBox[{"StyleDefinitions", "->", "\n", "\t", "\t\t\t\t\t\t", 
               RowBox[{"Notebook", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Cell", "[", 
                   RowBox[{"StyleData", "[", 
                    RowBox[{"StyleDefinitions", "->", "s"}], "]"}], "]"}], 
                  "}"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
                 RowBox[{
                 "StyleDefinitions", "\[Rule]", "\n", "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{
                  "(", "\"\<PrivateStylesheetFormatting.nb\>\"", ")"}]}]}], 
                "\n", "\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t\t\t", 
             "]"}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"$ssNbObjCache", "[", "e", "]"}], "=."}], ";", "\n", 
            "\t\t\t\t\t", 
            RowBox[{"StyleSheetParentNotebook", "[", "e", "]"}]}], "\n", 
           "\t\t\t\t\t", ")"}]}], ",", "\n", "\t\t\t", 
         RowBox[{"_", ":>", "\n", "\t\t\t\t", 
          RowBox[{"StyleSheetParentNotebook", "[", "e", "]"}]}]}], "\n", 
        "\t\t\t", "}"}]}], "]"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"StyleSheetNotebookObject", "[", 
   RowBox[{"name", ":", 
    RowBox[{"_String", "|", 
     RowBox[{"{", "__String", "}"}], "|", "_FrontEnd`FileName"}]}], "]"}], ":=",
   "\n", "\t", 
  RowBox[{"Replace", "[", 
   RowBox[{
    RowBox[{"StyleSheetNotebookFind", "[", "name", "]"}], ",", "\n", "\t\t", 
    RowBox[{"nb_NotebookObject", ":>", 
     RowBox[{"StyleSheetNotebookObject", "[", "nb", "]"}]}]}], "\n", "\t\t", 
   "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.699984963895537*^9, 3.699985021849532*^9}, 
   3.699985206008259*^9, {3.6999852572895813`*^9, 3.699985308360332*^9}, {
   3.6999853612325153`*^9, 3.699985366063388*^9}, {3.699985400061108*^9, 
   3.6999855797916813`*^9}, 3.6999856315339327`*^9, 3.699985732335429*^9, {
   3.699985854675861*^9, 3.6999858623245583`*^9}, {3.6999861086663513`*^9, 
   3.699986123852797*^9}, {3.70087855641947*^9, 3.700878557289247*^9}, {
   3.7015278351482697`*^9, 3.701527877729485*^9}, {3.7064532656611757`*^9, 
   3.70645328177538*^9}, {3.7086944925689583`*^9, 3.708694492830022*^9}, {
   3.7086954465506763`*^9, 3.70869544851826*^9}, {3.71552618201083*^9, 
   3.715526197055545*^9}, {3.7218388330209837`*^9, 3.7218388330362453`*^9}, {
   3.727899348977594*^9, 3.7278993700802526`*^9}, {3.727899498780423*^9, 
   3.727899523461329*^9}, {3.727899584234026*^9, 
   3.727899588549326*^9}},ExpressionUUID->"03a5d7a9-4d9f-46ea-8b07-\
ec2a9cd636e9"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]StyleSheetTemplate\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6967917670214787`*^9, 3.696791768180718*^9}, 
   3.721838833276196*^9},ExpressionUUID->"c6c0ab1c-1cad-400b-8e21-\
80205d0fae61"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetTemplate", "[", 
    RowBox[{
     RowBox[{"newNB", ":", 
      RowBox[{"_Notebook", "|", "_NotebookObject", "|", "None"}], ":", 
      "None"}], ",", "\n", "\t", 
     RowBox[{"defaultStyle", ":", "_DefaultStyle", ":", 
      RowBox[{"DefaultStyle", "[", "\"\<Default.nb\>\"", "]"}]}], ",", "\n", 
     "\t", 
     RowBox[{"styles", ":", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"_String", "|", "_Directive"}], ")"}], "..."}]}], ",", "\n", 
     "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"_Rule", "|", 
       RowBox[{"_RuleDelayed", "..."}]}]}]}], "\n", "\t", "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nb", "=", 
       RowBox[{"Replace", "[", 
        RowBox[{"newNB", ",", 
         RowBox[{"{", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{"_Notebook", ":>", "\n", "\t\t\t", 
            RowBox[{"CreateDocument", "[", 
             RowBox[{
             "\"\<\>\"", ",", "\n", "\t\t\t\t", "ops", ",", "\n", "\t\t\t\t", 
              
              RowBox[{"WindowTitle", "\[Rule]", 
               RowBox[{"First", "@", "newNB"}]}], ",", "\n", "\t\t\t\t", 
              RowBox[{"StyleDefinitions", "\[Rule]", "\n", "\t\t\t\t\t", 
               RowBox[{"Notebook", "[", 
                RowBox[{"{", "\n", "\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"Cell", "[", 
                   RowBox[{"StyleData", "[", 
                    RowBox[{
                    "StyleDefinitions", "->", 
                    "\"\<StylesheetFormatting.nb\>\""}], "]"}], "]"}], ",", 
                  "\n", "\t\t\t\t\t\t", 
                  RowBox[{"Cell", "[", 
                   RowBox[{
                    RowBox[{"StyleData", "[", "\"\<Notebook\>\"", "]"}], ",", 
                    "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{"Saveable", "\[Rule]", "True"}], ",", "\n", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{"Editable", "\[Rule]", "True"}]}], "\n", 
                   "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", "}"}], 
                "]"}]}], ",", "\n", "\t\t\t\t\t", 
              RowBox[{"Saveable", "\[Rule]", "True"}]}], "]"}]}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{"None", ":>", "Automatic"}]}], "\n", "\t\t\t\t", "}"}]}], 
        "]"}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"StyleSheetNew", "[", 
       RowBox[{"nb", ",", "defaultStyle", ",", "Next"}], "]"}], ";", "\n", 
      "\t\t", 
      RowBox[{"Do", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"StyleSheetNew", "[", 
           RowBox[{"nb", ",", "##"}], "]"}], "&"}], "@@", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{"s", ",", "_Directive"}], "]"}], ",", "s", ",", 
           RowBox[{"{", "s", "}"}]}], "]"}]}], ",", "\n", "\t\t\t", 
        RowBox[{"{", 
         RowBox[{"s", ",", 
          RowBox[{"{", "styles", "}"}]}], "}"}]}], "]"}], ";", "\n", "\t\t", 
      RowBox[{"Replace", "[", 
       RowBox[{"nb", ",", 
        RowBox[{"Automatic", "\[RuleDelayed]", "Null"}]}], "]"}]}]}], "\n", 
    "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetTemplate", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"newNB", ":", 
      RowBox[{"_Notebook", "|", "_NotebookObject", "|", "None"}], ":", 
      "None"}], ",", "\n", "\t", 
     RowBox[{"defaultStyle", ":", "_DefaultStyle", ":", 
      RowBox[{"DefaultStyle", "[", "\"\<Default.nb\>\"", "]"}]}], ",", "\n", 
     "\t", "Default"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"StyleSheetTemplate", "[", 
    RowBox[{
    "newNB", ",", "defaultStyle", ",", "\n", "\t\t", "\"\<Notebook\>\"", ",", 
     "\n", "\t\t", "\"\<Title\>\"", ",", "\"\<Chapter\>\"", ",", 
     "\"\<Subchapter\>\"", ",", "\n", "\t\t", "\"\<Section\>\"", ",", 
     "\"\<Subsection\>\"", ",", "\"\<Subsubsection\>\"", ",", "\n", "\t\t", 
     "\"\<Text\>\"", ",", "\"\<Code\>\"", ",", "\"\<Input\>\"", ",", "\n", 
     "\t\t", "\"\<Item\>\"", ",", "\"\<ItemParagraph\>\""}], "\n", "\t\t", 
    "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.68452165702324*^9, 3.684521892877322*^9}, {
  3.684521942335169*^9, 3.684522059018845*^9}, {3.684522105154936*^9, 
  3.6845221088178596`*^9}, {3.6846806209455214`*^9, 3.684680655325056*^9}, {
  3.685198311962241*^9, 3.685198348737804*^9}, {3.685198774020797*^9, 
  3.68519879170374*^9}, {3.685198870674602*^9, 3.685198898630095*^9}, {
  3.6851989360642548`*^9, 3.685198966751504*^9}, {3.685239694074895*^9, 
  3.6852397390461903`*^9}, {3.687112206889627*^9, 3.687112306092102*^9}, {
  3.687113646841282*^9, 3.687113649285041*^9}, {3.70645322165434*^9, 
  3.70645322228421*^9}, {3.707998296954651*^9, 3.707998356909789*^9}, {
  3.707998418218442*^9, 3.707998418431931*^9}, {3.721838833296565*^9, 
  3.721838833323358*^9}},ExpressionUUID->"b784e38d-53b6-4b9e-932e-\
40c87bd34300"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]StyleSheetOpen\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.696791775690338*^9, 3.6967917765250797`*^9}, 
   3.7218388333405037`*^9},ExpressionUUID->"315f7824-41ae-4c7e-8775-\
e7218736e80c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetOpen", "[", 
    RowBox[{"nb", ":", 
     RowBox[{"_NotebookObject", "|", "Automatic"}], ":", "Automatic"}], "]"}],
    ":=", "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"notebook", "=", 
       RowBox[{"Replace", "[", 
        RowBox[{"nb", ",", 
         RowBox[{"Automatic", "\[RuleDelayed]", 
          RowBox[{"StyleSheetNotebookObject", "[", "]"}]}]}], "]"}]}], "}"}], 
     ",", "\n", "\t", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"FrontEndTokenExecute", "@", "\"\<EditStyleDefinitions\>\""}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Replace", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"StyleDefinitions", "/.", 
        RowBox[{"Options", "[", 
         RowBox[{"notebook", ",", "StyleDefinitions"}], "]"}]}], ",", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"s", ":", 
           RowBox[{"(", 
            RowBox[{"_String", "|", "_FrontEnd`FileName"}], ")"}]}], 
          "\[RuleDelayed]", "\n", "\t\t\t", 
          RowBox[{"SystemOpen", "@", "s"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"n", ":", 
           RowBox[{"(", "_Notebook", ")"}]}], "\[RuleDelayed]", "\n", 
          "\t\t\t", 
          RowBox[{"CreateDocument", "[", 
           RowBox[{"n", ",", "\n", "\t\t\t\t", 
            RowBox[{"WindowTitle", "\[Rule]", 
             RowBox[{"\"\<StyleDefintions for \>\"", "<>", 
              RowBox[{"FileNameTake", "@", 
               RowBox[{"NotebookFileName", "[", "notebook", "]"}]}]}]}]}], 
           "]"}]}]}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.6851960490889263`*^9, 3.685196182544615*^9}, {
   3.685198024164209*^9, 3.68519802792072*^9}, {3.6851980739447527`*^9, 
   3.685198203131629*^9}, {3.685198234171751*^9, 3.685198241459413*^9}, {
   3.69076611658276*^9, 3.690766124872345*^9}, {3.699981306022402*^9, 
   3.6999813080912952`*^9}, 3.699985730608281*^9, {3.7218388333568707`*^9, 
   3.721838833364509*^9}, 
   3.727899370089241*^9},ExpressionUUID->"8a3c3a21-fb8b-4f8f-aa4d-\
2d489d5fb18f"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]StyleSheetDefaultStyles\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6967917810845823`*^9, 3.6967917834282017`*^9}, 
   3.7218388333823347`*^9},ExpressionUUID->"283fd8ff-47ae-4377-af2a-\
abb50c87be7d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetDefaultStyles", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"nb", ":", 
      RowBox[{"_NotebookObject", "|", "Automatic"}], ":", "Automatic"}], ",", 
     "\n", "\t", "styles__String"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sList", "=", 
       RowBox[{"{", "styles", "}"}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"Do", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"StyleSheetEdit", "[", 
        RowBox[{"nb", ",", 
         RowBox[{"sList", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"DefaultNewCellStyle", "\[Rule]", 
          RowBox[{"sList", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], "]"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"Length", "@", "sList"}], "-", "1"}]}], "}"}]}], "\n", 
      "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.687113843618804*^9, 3.687114080790492*^9}, {
  3.72183883339648*^9, 
  3.721838833401772*^9}},ExpressionUUID->"3928f725-51a8-434f-9993-\
74c3df25013d"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]StyleSheetStyleData\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.727890324215061*^9},ExpressionUUID->"fc5216fe-9be5-4960-a3cf-\
98ad041b4182"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ssNormalizeStyleName", "[", "s_String", "]"}], ":=", "\n", "\t", 
   RowBox[{"Replace", "[", 
    RowBox[{
     RowBox[{"StringSplit", "[", 
      RowBox[{"s", ",", " ", "\"\</\>\""}], "]"}], ",", "\n", "\t\t", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "n_", "}"}], "\[RuleDelayed]", "n"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{
        RowBox[{"{", "n__", "}"}], ":>", 
        RowBox[{"StyleData", "[", "n", "]"}]}]}], "\n", "\t\t\t", "}"}]}], 
    "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ssNormalizeStyleName", "[", "e_", "]"}], ":=", "e"}]}], "CodeInput",
 CellChangeTimes->{{3.7278310669219627`*^9, 
  3.727831117048068*^9}},ExpressionUUID->"dbaf03c5-70ce-4f6e-97f7-\
a060d279ed6f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"iStyleSheetStyleData", "[", "canonicalStyles_", "]"}], ":=", "\n",
    "\t", 
   RowBox[{
    RowBox[{
     RowBox[{"Replace", "[", "\n", "\t\t", 
      RowBox[{"canonicalStyles", ",", "\n", "\t\t", 
       RowBox[{"{", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Rule", "|", "RuleDelayed"}], ")"}], "[", 
           RowBox[{"s_String", ",", " ", "p_String"}], "]"}], ":>", "\n", 
          "\t\t\t\t", 
          RowBox[{"StyleData", "[", 
           RowBox[{"s", ",", " ", 
            RowBox[{"StyleDefinitions", "\[Rule]", 
             RowBox[{"StyleData", "[", "p", "]"}]}]}], "]"}]}], ",", "\n", 
         "\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Rule", "|", "RuleDelayed"}], ")"}], "[", 
           RowBox[{
            RowBox[{"{", "s__String", "}"}], ",", "p_String"}], "]"}], ":>", 
          "\n", "\t\t\t\t", 
          RowBox[{"StyleData", "[", 
           RowBox[{"s", ",", " ", 
            RowBox[{"StyleDefinitions", "\[Rule]", 
             RowBox[{"StyleData", "[", "p", "]"}]}]}], "]"}]}], ",", "\n", 
         "\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Rule", "|", "RuleDelayed"}], ")"}], "[", 
           RowBox[{"s_String", ",", 
            RowBox[{"{", "p__String", "}"}]}], "]"}], ":>", "\n", "\t\t\t\t", 
          
          RowBox[{"StyleData", "[", 
           RowBox[{"s", ",", " ", 
            RowBox[{"StyleDefinitions", "\[Rule]", 
             RowBox[{"StyleData", "[", "p", "]"}]}]}], "]"}]}], ",", "\n", 
         "\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Rule", "|", "RuleDelayed"}], ")"}], "[", 
           RowBox[{
            RowBox[{"{", "s__String", "}"}], ",", " ", 
            RowBox[{"{", "p__String", "}"}]}], "]"}], ":>", "\n", "\t\t\t\t", 
          
          RowBox[{"StyleData", "[", 
           RowBox[{"s", ",", " ", 
            RowBox[{"StyleDefinitions", "\[Rule]", 
             RowBox[{"StyleData", "[", "p", "]"}]}]}], "]"}]}], ",", "\n", 
         "\t\t\t", 
         RowBox[{"e_", ":>", "\n", "\t\t\t\t", 
          RowBox[{"StyleData", "[", "e", "]"}]}]}], "\n", "\t\t\t", "}"}], 
       ",", "\n", "\t\t", "1"}], "\n", "\t\t", "]"}], "//.", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Rule", "|", "RuleDelayed"}], ")"}], "[", 
        RowBox[{
         RowBox[{"name", ":", 
          RowBox[{"Except", "[", "StyleDefinitions", "]"}]}], ",", "env_"}], 
        "]"}], ":>", "\n", "\t\t\t\t", 
       RowBox[{"StyleData", "@@", 
        RowBox[{"Flatten", "@", 
         RowBox[{"{", 
          RowBox[{"name", ",", "env"}], "}"}]}]}]}], "\n", "\t\t\t", "}"}]}], 
    "//.", 
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"DefaultStyle", "[", "f__", "]"}], "\[RuleDelayed]", 
       RowBox[{"(", "\n", "\t\t\t\t", 
        RowBox[{"StyleDefinitions", "\[Rule]", "\n", "\t\t\t\t\t", 
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"{", "f", "}"}], ",", 
           RowBox[{"{", "\n", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"{", "s_String", "}"}], "\[RuleDelayed]", "\n", 
              "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"StringTrim", "[", 
                RowBox[{"s", ",", "\"\<.nb\>\""}], "]"}], "<>", 
               "\"\<.nb\>\""}]}], ",", "\n", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"path__", ",", "name_"}], "}"}], ":>", "\n", 
              "\t\t\t\t\t\t\t", 
              RowBox[{"FrontEnd`FileName", "[", 
               RowBox[{
                RowBox[{"{", "path", "}"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{"Evaluate", "[", 
                 RowBox[{
                  RowBox[{"StringTrim", "[", 
                   RowBox[{"name", ",", "\"\<.nb\>\""}], "]"}], "<>", 
                  "\"\<.nb\>\""}], "]"}]}], "]"}]}], ",", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"{", "e_", "}"}], ":>", "\n", "\t\t\t\t\t\t\t", "e"}]}],
             "\n", "\t\t\t\t\t\t", "}"}]}], "]"}]}], "\n", "\t\t\t\t", 
        ")"}]}], ",", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"StyleData", "[", 
        RowBox[{"a___", ",", " ", 
         RowBox[{"StyleData", "[", "b___", "]"}], ",", " ", "c___"}], "]"}], ":>",
        "\n", "\t\t\t\t", 
       RowBox[{"StyleData", "[", 
        RowBox[{"a", ",", "b", ",", "c"}], "]"}]}]}], "\n", "\t\t\t", 
     "}"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetStyleData", "[", "styleNames_", "]"}], ":=", "\n", 
   "\t\t", 
   RowBox[{"iStyleSheetStyleData", "@", 
    RowBox[{"Flatten", "@", "\n", "\t\t\t", 
     RowBox[{"Replace", "[", "\n", "\t\t\t\t", 
      RowBox[{
       RowBox[{"ssNormalizeStyleName", "/@", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"{", "styleNames", "}"}], ",", " ", "1"}], "]"}]}], ",", 
       "\n", "\t\t\t\t", 
       RowBox[{"{", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"h", ":", 
             RowBox[{"Rule", "|", "RuleDelayed"}]}], ")"}], "[", 
           RowBox[{"s_List", ",", "e_"}], "]"}], ":>", "\n", "\t\t\t\t\t\t\t", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"h", "[", 
               RowBox[{"#", ",", "e"}], "]"}], "]"}], "&"}], ",", "s"}], 
           "]"}]}], ",", "\n", "\t", "\t\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"h", ":", 
             RowBox[{"Rule", "|", "RuleDelayed"}]}], ")"}], "[", 
           RowBox[{"s_", ",", "e_List"}], "]"}], ":>", "\n", "\t", 
          "\t\t\t\t\t\t", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"h", "[", 
               RowBox[{"s", ",", "#"}], "]"}], "]"}], "&"}], ",", "e"}], 
           "]"}]}]}], "\n", "\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t", "1"}],
       "\n", "\t\t\t\t", "]"}]}]}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.697214727569787*^9, 3.697214766493772*^9}, {
   3.697214820597845*^9, 3.697214876725713*^9}, {3.697215651192834*^9, 
   3.6972158076070127`*^9}, {3.697215885939371*^9, 3.6972159327978697`*^9}, {
   3.697215980022583*^9, 3.6972160156853333`*^9}, {3.697216073238171*^9, 
   3.69721609843043*^9}, {3.69721613256108*^9, 3.697216184637465*^9}, {
   3.697216386404436*^9, 3.697216436809791*^9}, {3.6972164752560387`*^9, 
   3.697216495388597*^9}, {3.697216554939649*^9, 3.697216620680448*^9}, {
   3.697216679129918*^9, 3.697216729875176*^9}, {3.6972167858364067`*^9, 
   3.697216809136837*^9}, {3.697217086276738*^9, 3.6972171582069407`*^9}, {
   3.701027615936549*^9, 3.701027662550048*^9}, 3.70102777421344*^9, {
   3.7010278334849977`*^9, 3.701027835323263*^9}, {3.701027867963902*^9, 
   3.701027880766601*^9}, {3.701214564160984*^9, 3.701214564886348*^9}, {
   3.701214663609198*^9, 3.70121466920753*^9}, 3.721838833109653*^9, {
   3.7278311895476723`*^9, 3.72783129930383*^9}, {3.727831330108821*^9, 
   3.727831330560801*^9}, {3.727890344791789*^9, 3.727890345686571*^9}, {
   3.727890428706572*^9, 3.727890435974874*^9}, {3.727890480536829*^9, 
   3.727890506694022*^9}, {3.727890756800349*^9, 3.727890781725295*^9}, {
   3.7278908568345747`*^9, 3.7278909562792997`*^9}, {3.7278910213498383`*^9, 
   3.727891117469571*^9}, {3.7278912727781897`*^9, 3.7278915049964867`*^9}, {
   3.727891536512723*^9, 3.7278916033958683`*^9}, {3.727891664768038*^9, 
   3.727891741256278*^9}},ExpressionUUID->"bc043150-776c-4ee4-93d5-\
640ded1c39e7"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]StyleSheetCells\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.685196039604414*^9, 3.685196040180355*^9}, {
   3.699981274014044*^9, 3.69998127416405*^9}, 
   3.721838833416874*^9},ExpressionUUID->"45e6cc09-7e18-468d-b3d2-\
5e5aa84e6031"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$StyleSheetCellStyleBaseStylePattern", "=", "\n", "\t", 
   RowBox[{
   "All", "|", "_String", "|", "_StyleData", "|", "_Verbatim", "|", 
    "Default"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$StyleSheetCellStyleSubStylePattern", "=", "\n", "\t", 
   RowBox[{
    RowBox[{"$StyleSheetCellStyleBaseStylePattern", "|", 
     RowBox[{"{", 
      RowBox[{"$StyleSheetCellStyleBaseStylePattern", ".."}], "}"}]}], "->", 
    "\n", "\t\t", 
    RowBox[{"$StyleSheetCellStyleBaseStylePattern", "|", 
     RowBox[{"{", 
      RowBox[{"$StyleSheetCellStyleBaseStylePattern", ".."}], "}"}]}]}]}], 
  ";"}], "\n", 
 RowBox[{"$StyleSheetCellStyleSinglePattern", "=", "\n", "\t", 
  RowBox[{
  "$StyleSheetCellStyleBaseStylePattern", "|", "\n", "\t\t", 
   "$StyleSheetCellStyleSubStylePattern", "|", "\n", "\t\t", 
   RowBox[{"_", "?", "StringPattern`StringPatternQ"}]}]}]}], "CodeInput",
 CellChangeTimes->{{3.709209688703774*^9, 3.709209689624714*^9}, {
  3.709243352283258*^9, 3.709243352674638*^9}, {3.709951065865752*^9, 
  3.709951066968326*^9}, {3.7218379410432997`*^9, 3.721838005740758*^9}, {
  3.7218384185870028`*^9, 3.721838430941783*^9}, {3.721838833427847*^9, 
  3.721838833465114*^9}, {3.7278905542609243`*^9, 
  3.7278905782858553`*^9}},ExpressionUUID->"c7d198e6-9505-443c-b0ab-\
f03399b80701"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$StyleSheetCellStylePatterns", "=", "\n", "\t", 
   RowBox[{"$StyleSheetCellStyleSinglePattern", "|", 
    RowBox[{"{", 
     RowBox[{"$StyleSheetCellStyleSinglePattern", ".."}], "}"}]}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.70920959666352*^9, 3.709209611314342*^9}, {
  3.709209687475675*^9, 3.709209697561496*^9}, {3.709243581356262*^9, 
  3.709243582465345*^9}, {3.7218379372560673`*^9, 3.721837937909955*^9}, {
  3.721838833469417*^9, 3.7218388334781733`*^9}, {3.7278905432306023`*^9, 
  3.727890547171714*^9}},ExpressionUUID->"20749b5a-bfaa-447e-bf0d-\
fb5abe44f82b"],

Cell[CellGroupData[{

Cell["cellTypeMatchQ", "CodeSubsubsubsection",
 CellChangeTimes->{{3.700936237710785*^9, 3.7009362399899673`*^9}, 
   3.708702536419922*^9},ExpressionUUID->"071aebea-9b60-4891-8735-\
a54c70f7d1e4"],

Cell[BoxData[
 RowBox[{"cellTypeMatchQ", "//", "Clear"}]], "CodeInput",
 CellChangeTimes->{{3.724084375662058*^9, 
  3.724084377982226*^9}},ExpressionUUID->"a0e19503-37fd-4af5-a649-\
a1dc691e6655"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"cellTypeMatchQ", "[", 
    RowBox[{
     RowBox[{"type", ":", 
      RowBox[{"_String", "|", "All"}]}], ",", " ", "types_"}], "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"Which", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"types", "===", 
      RowBox[{"{", "\"\<*\>\"", "}"}]}], ",", "\n", "\t\t\t", "True", ",", 
     "\n", "\t\t", 
     RowBox[{"types", "===", 
      RowBox[{"{", "}"}]}], ",", "\n", "\t\t\t", "False", ",", "\n", "\t\t", 
     RowBox[{"MatchQ", "[", 
      RowBox[{"types", ",", " ", 
       RowBox[{"StyleData", "[", "_", "]"}]}], "]"}], ",", "\n", "\t\t\t", 
     RowBox[{"cellTypeMatchQ", "[", 
      RowBox[{"type", ",", " ", 
       RowBox[{"First", "@", "types"}]}], "]"}], ",", "\n", "\t\t", 
     RowBox[{"StringPattern`StringPatternQ", "[", "type", "]"}], ",", "\n", 
     "\t\t\t", 
     RowBox[{"StringMatchQ", "[", 
      RowBox[{"type", ",", "\n", "\t\t\t\t", 
       RowBox[{"Alternatives", "@@", "\n", "\t\t\t\t\t", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Flatten", "@", 
           RowBox[{"List", "@", "types"}]}], ",", " ", 
          "StringPattern`StringPatternQ"}], "]"}]}]}], "\n", "\t\t\t\t", 
      "]"}], ",", "\n", "\t\t", "True", ",", "\n", "\t\t\t", 
     RowBox[{"MemberQ", "[", "\n", "\t\t\t\t", 
      RowBox[{
       RowBox[{"Replace", "[", 
        RowBox[{"types", ",", "\n", "\t", "\t\t\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"s_", ",", " ", 
            RowBox[{"\"\<*\>\"", ".."}]}], "}"}], "\[RuleDelayed]", 
          RowBox[{"{", "s", "}"}]}], ",", "\n", "\t\t\t\t\t", "1"}], "\n", 
        "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", "type"}], "\n", 
      "\t\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"cellTypeMatchQ", "[", 
    RowBox[{"type_Symbol", ",", " ", "\"\<*\>\""}], "]"}], ":=", "True"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"cellTypeMatchQ", "[", 
    RowBox[{
     RowBox[{"type", ":", 
      RowBox[{"Except", "[", "_String", "]"}]}], ",", "_"}], "]"}], ":=", 
   "False"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cellTypeMatchQ", "[", "types_", "]"}], "[", "type_", "]"}], ":=", 
   RowBox[{"cellTypeMatchQ", "[", 
    RowBox[{"type", ",", "types"}], "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.685277410023521*^9, 3.685277509443552*^9}, {
   3.6852775768039713`*^9, 3.685277580680621*^9}, {3.685371612361245*^9, 
   3.685371623654235*^9}, {3.690765947039336*^9, 3.690765986433193*^9}, {
   3.696785881139592*^9, 3.6967859213895206`*^9}, {3.7087023507609863`*^9, 
   3.7087023752547207`*^9}, {3.708702445213191*^9, 3.708702536362753*^9}, {
   3.708702584967368*^9, 3.708702587387705*^9}, {3.7087029287733603`*^9, 
   3.7087029336338367`*^9}, {3.70870336930614*^9, 3.708703395402279*^9}, {
   3.708703450438919*^9, 3.708703456036908*^9}, {3.7087035148188343`*^9, 
   3.708703542018387*^9}, {3.7091548894677134`*^9, 3.709154935121612*^9}, 
   3.709155069248868*^9, {3.709243237922028*^9, 3.7092432487668467`*^9}, {
   3.72183806075637*^9, 3.721838093619787*^9}, 3.721838245083748*^9, {
   3.724083056687851*^9, 3.724083060726204*^9}, {3.724083478378035*^9, 
   3.724083502636945*^9}, 3.724083550765333*^9, {3.72408358784247*^9, 
   3.72408359359291*^9}, {3.724084122727243*^9, 3.7240841692586737`*^9}, {
   3.7240842070846453`*^9, 3.7240842500708303`*^9}, {3.7240843299165077`*^9, 
   3.724084397387288*^9}, 3.724153948215288*^9, {3.7241540093217793`*^9, 
   3.724154014934059*^9}, 3.727891918991926*^9, {3.7278919521931868`*^9, 
   3.7278919759662457`*^9}, {3.7278920326526327`*^9, 3.727892035193466*^9}, {
   3.727892121673996*^9, 
   3.7278921688269987`*^9}},ExpressionUUID->"c3066973-ab07-48b0-b66c-\
ef288c9fb05a"]
}, Closed]],

Cell[CellGroupData[{

Cell["cellStyleNameMatchQ", "CodeSubsubsubsection",
 CellChangeTimes->{{3.700936237710785*^9, 3.700936248426206*^9}, 
   3.708702552062889*^9},ExpressionUUID->"b33e97d8-19ed-4b46-830e-\
b36a6fd428a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cellStyleMovingMatchQ", "[", 
   RowBox[{"s_", ",", " ", "types_"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"styleDatas", "=", "\n", "\t\t", 
      RowBox[{"Replace", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"Flatten", "@", 
           RowBox[{"{", "types", "}"}]}], ",", " ", 
          RowBox[{"_StyleData", "|", "_Verbatim"}]}], "]"}], ",", "\n", 
        "\t\t\t", 
        RowBox[{"{", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"HoldPattern", "[", "Verbatim", "]"}], "[", "d_StyleData",
             "]"}], "\[RuleDelayed]", "\n", "\t", "\t\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", "d"}], "!=", 
              RowBox[{"Length", "@", "s"}]}], ",", "\n", "\t", "\t\t\t\t\t", 
             "Nothing", ",", "\n", "\t", "\t\t\t\t\t", 
             RowBox[{"List", "@@", "d"}]}], "\n", "\t", "\t\t\t\t\t", "]"}]}],
           ",", "\n", "\t", "\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"HoldPattern", "[", "Verbatim", "]"}], "[", "e_", "]"}], 
           "\[RuleDelayed]", "\n", "\t", "\t\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", "s"}], "\[NotEqual]", "1"}], ",", "\n", 
             "\t", "\t\t\t\t\t", "Nothing", ",", "\n", "\t", "\t\t\t\t\t", 
             RowBox[{"{", "e", "}"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], ",", 
          "\n", "\t\t\t\t", 
          RowBox[{"d_StyleData", ":>", "\n", "\t\t\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", "d"}], ">", 
              RowBox[{"Length", "@", "s"}]}], ",", "\n", "\t", "\t\t\t\t\t", 
             "Nothing", ",", "\n", "\t", "\t\t\t\t\t", 
             RowBox[{"Join", "[", "\n", "\t", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"List", "@@", "d"}], ",", "\n", "\t", "\t\t\t\t\t\t", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{"\"\<*\>\"", ",", " ", 
                 RowBox[{"Max", "@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "s"}], "-", 
                    RowBox[{"Length", "@", "d"}]}], ",", "0"}], "}"}]}]}], 
                "]"}]}], "\n", "\t", "\t\t\t\t\t\t", "]"}]}], "\n", "\t", 
            "\t\t\t\t\t", "]"}]}]}], "\n", "\t", "\t\t\t", "}"}], ",", "\n", 
        "\t\t\t", "1"}], "]"}]}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
    RowBox[{"AnyTrue", "[", "\n", "\t\t\t", 
     RowBox[{"styleDatas", ",", "\n", "\t\t\t\t", 
      RowBox[{
       RowBox[{"And", "@@", 
        RowBox[{"MapThread", "[", 
         RowBox[{"cellTypeMatchQ", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"List", "@@", "s"}], ",", "#"}], "}"}]}], "]"}]}], 
       "&"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.7218381427661867`*^9, 3.7218382328755417`*^9}, {
  3.724084079849238*^9, 3.724084082908966*^9}, {3.7278918675366793`*^9, 
  3.7278918870068283`*^9}},ExpressionUUID->"6a74e26f-b849-43c7-8fa8-\
0be60a2c3b31"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cellStyleNameMatchQ", "[", "\n", "\t", 
    RowBox[{"s_StyleData", ",", "\n", "\t", "types_"}], "\n", "\t", "]"}], ":=",
    "\n", "\t", 
   RowBox[{
    RowBox[{"types", "=!=", 
     RowBox[{"{", "}"}]}], "&&", "\n", "\t\t", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "@", "s"}], "==", "1"}], ",", "\n", "\t", "\t\t", 
      RowBox[{"cellTypeMatchQ", "[", 
       RowBox[{
        RowBox[{"First", "@", "s"}], ",", " ", "\n", "\t\t\t\t", 
        RowBox[{"First", "/@", 
         RowBox[{"Select", "[", 
          RowBox[{"types", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", "#"}], "\[Equal]", "1"}], "&"}]}], 
          "]"}]}]}], "\n", "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "s"}], ">", "0"}], "&&", "\n", "\t\t\t\t", 
       RowBox[{"(", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"cellTypeMatchQ", "[", "\n", "\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{"First", "@", "s"}], ",", "\n", "\t\t\t\t\t\t", 
           RowBox[{"First", "/@", 
            RowBox[{"Select", "[", 
             RowBox[{"types", ",", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "@", "#"}], "\[Equal]", "1"}], "&"}]}], 
             "]"}]}]}], "\n", "\t\t\t\t\t\t", "]"}], "||", "\n", "\t\t\t\t\t", 
         RowBox[{"cellStyleMovingMatchQ", "[", 
          RowBox[{"s", ",", " ", "types"}], "]"}]}], "\n", "\t\t\t\t\t", 
        ")"}]}]}], "\n", "\t\t\t", "]"}]}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.696786237091066*^9, 3.6967863947959642`*^9}, {
   3.696786435670377*^9, 3.696786450426927*^9}, {3.6967864825962477`*^9, 
   3.696786683106558*^9}, {3.696786723157936*^9, 3.696786770865953*^9}, {
   3.696786860059167*^9, 3.696786893789008*^9}, {3.6967869351032667`*^9, 
   3.6967869492194157`*^9}, {3.6967870078470783`*^9, 3.696787056950848*^9}, {
   3.696787089098559*^9, 3.696787110261538*^9}, {3.6967876252207212`*^9, 
   3.696787646642605*^9}, {3.696787676744115*^9, 3.696787724284897*^9}, {
   3.696798727949993*^9, 3.696798748792285*^9}, 3.7009362787972107`*^9, {
   3.708702514269861*^9, 3.70870253637941*^9}, {3.708702656816791*^9, 
   3.7087027627555447`*^9}, 3.708702995041346*^9, {3.708703082564851*^9, 
   3.7087030833786583`*^9}, {3.708703222195838*^9, 3.7087032410111713`*^9}, {
   3.7087033029486094`*^9, 3.708703345831284*^9}, {3.708703477031568*^9, 
   3.708703479301435*^9}, 3.708703551211309*^9, {3.709154707743207*^9, 
   3.709154777579088*^9}, {3.70915481897293*^9, 3.7091548295224867`*^9}, {
   3.7092432905204678`*^9, 3.709243308795548*^9}, {3.709243439472784*^9, 
   3.709243442718432*^9}, {3.7218381052394648`*^9, 3.721838199242413*^9}, {
   3.72408409612642*^9, 3.724084108420073*^9}, {3.727892208495295*^9, 
   3.7278922356339407`*^9}, {3.7278922782269993`*^9, 
   3.7278923151037807`*^9}},ExpressionUUID->"280a5364-0c0a-4d76-9b6e-\
7fa6371e1bce"]
}, Closed]],

Cell[CellGroupData[{

Cell["cellStyleDataMatchQ", "CodeSubsubsubsection",
 CellChangeTimes->{{3.700936237710785*^9, 3.70093625769105*^9}, 
   3.708702559801539*^9},ExpressionUUID->"bd969860-8cb3-463e-8461-\
7d13f2ffe5cb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"cellStyleDataMatchQ", "[", 
    RowBox[{"s_StyleData", ",", " ", "types_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{"matchData", "=", "\n", "\t\t\t\t", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{"s", ",", " ", 
         RowBox[{"Except", "[", 
          RowBox[{"_String", "|", "_Symbol", "|", 
           RowBox[{"_", "?", "StringPattern`StringPatternQ"}]}], "]"}]}], 
        "]"}]}], "\n", "\t", "\t\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"MatchQ", "[", 
       RowBox[{"matchData", ",", "\n", "\t\t\t", 
        RowBox[{"Alternatives", "@@", "\n", "\t\t\t\t", 
         RowBox[{"Replace", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"Flatten", "@", 
            RowBox[{"{", "types", "}"}]}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{"{", "\n", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"DefaultStyle", "[", "d_", "]"}], ":>", "\n", "\t", 
              "\t\t\t\t\t\t", 
              RowBox[{"StyleData", "[", 
               RowBox[{"StyleDefinitions", "\[Rule]", "d"}], "]"}]}], ",", 
             "\n", "\t", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"DefaultStyle", "[", 
               RowBox[{"p_List", ",", " ", "f_String"}], "]"}], ":>", "\n", 
              "\t\t\t\t\t\t\t", 
              RowBox[{"StyleData", "[", 
               RowBox[{"StyleDefinitions", "\[Rule]", 
                RowBox[{"FrontEnd`FileName", "[", 
                 RowBox[{
                  RowBox[{"{", "p", "}"}], ",", "f"}], "]"}]}], "]"}]}], ",", 
             "\n", "\t", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"DefaultStyle", "[", 
               RowBox[{"a__", ",", "b_"}], "]"}], ":>", "\n", "\t", 
              "\t\t\t\t\t\t", 
              RowBox[{"StyleData", "[", 
               RowBox[{"StyleDefinitions", "\[Rule]", 
                RowBox[{"StyleData", "[", 
                 RowBox[{"a", ",", "b"}], "]"}]}], "]"}]}]}], "\n", "\t", 
            "\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t", "1"}], "\n", 
          "\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t", "]"}], "||", "\n", "\t\t", 
      
      RowBox[{"cellStyleNameMatchQ", "[", 
       RowBox[{"matchData", ",", " ", "types"}], "]"}]}]}], "\n", "\t\t", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cellStyleDataMatchQ", "[", "types_", "]"}], "[", "s_", "]"}], ":=",
    "\n", "\t", 
   RowBox[{"cellStyleDataMatchQ", "[", 
    RowBox[{"s", ",", " ", "types"}], "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.696786237091066*^9, 3.6967863947959642`*^9}, {
   3.696786435670377*^9, 3.696786450426927*^9}, {3.6967864825962477`*^9, 
   3.69678650190882*^9}, {3.696786691686122*^9, 3.6967867190180683`*^9}, {
   3.6967868007334633`*^9, 3.696786808983841*^9}, {3.696798632731619*^9, 
   3.69679863533423*^9}, {3.696798678496122*^9, 3.6967986863548594`*^9}, {
   3.696798716658448*^9, 3.696798719646723*^9}, {3.69679875303761*^9, 
   3.696798753288745*^9}, {3.701215197124302*^9, 3.7012152963860817`*^9}, {
   3.701215386064769*^9, 3.701215584996626*^9}, {3.708702552030514*^9, 
   3.7087025597614326`*^9}, {3.724083287104533*^9, 3.724083344837666*^9}, {
   3.724084018832837*^9, 3.724084068447299*^9}, {3.7278918190705338`*^9, 
   3.7278918510408688`*^9}, 
   3.727892200194936*^9},ExpressionUUID->"963d8f20-832e-4b57-bda4-\
0eb63b3d3cef"]
}, Closed]],

Cell[CellGroupData[{

Cell["cellMatchQ", "CodeSubsubsubsection",
 CellChangeTimes->{{3.700936237710785*^9, 3.70093625769105*^9}, 
   3.700936299561347*^9},ExpressionUUID->"ccf86bb8-e300-4774-ad36-\
2fc3d7eb98a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cellMatchQ", "[", 
    RowBox[{"cell_", ",", " ", "types_", ",", " ", 
     RowBox[{"Optional", "[", 
      RowBox[{"StyleData", ",", "StyleData"}], "]"}]}], "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"Replace", "[", "\n", "\t\t", 
    RowBox[{"cell", ",", "\n", "\t\t", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"Cell", "[", 
         RowBox[{"_", ",", " ", "_String", ",", " ", "___"}], "]"}], 
        "\[RuleDelayed]", "\n", "\t\t\t\t", "False"}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"Cell", "[", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"types", "===", "Default"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"StyleData", "[", 
             RowBox[{
              RowBox[{"StyleDefinitions", "\[Rule]", "_"}], ",", "___"}], 
             "]"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"_StyleData", "?", 
             RowBox[{"(", 
              RowBox[{"cellStyleDataMatchQ", "[", "types", "]"}], ")"}]}]}], 
           "\n", "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", "___"}], "\n", 
         "\t\t\t\t", "]"}], "\[RuleDelayed]", "\n", "\t\t\t\t", "True"}], ",",
        "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"Cell", "[", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"_", "?", 
           RowBox[{"(", "\n", "\t", "\t\t\t\t", 
            RowBox[{
             RowBox[{"MatchQ", "[", "\n", "\t", "\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Replace", "[", 
                RowBox[{"#", ",", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{"_BoxData", ":>", 
                  RowBox[{"ToExpression", "[", 
                   RowBox[{"#", ",", "StandardForm", ",", "Hold"}], "]"}]}]}],
                 "\n", "\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t\t", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"types", "===", "Default"}], ",", "\n", "\t", 
                 "\t\t\t\t\t\t", 
                 RowBox[{"StyleData", "[", 
                  RowBox[{
                   RowBox[{"StyleDefinitions", "\[Rule]", "_"}], ",", "___"}],
                   "]"}], ",", "\n", "\t", "\t\t\t\t\t\t", 
                 RowBox[{"_StyleData", "?", 
                  RowBox[{"(", 
                   RowBox[{"cellStyleDataMatchQ", "[", "types", "]"}], 
                   ")"}]}]}], "\n", "\t", "\t", "\t", "\t", "\t", "\t", "\t", 
                "]"}]}], "\n", "\t", "\t\t\t\t\t", "]"}], "&"}], "\n", "\t", 
            "\t\t\t\t", ")"}]}], ",", "\n", "\t", "\t\t\t", "___"}], "\n", 
         "\t\t\t\t", "]"}], "\[RuleDelayed]", "\n", "\t\t\t\t", "True"}], ",",
        "\n", "\t\t\t", 
       RowBox[{"_", "\[Rule]", "\n", "\t\t\t\t", "False"}]}], "\n", "\t\t\t", 
      "}"}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.685277078556501*^9, 3.6852770918245487`*^9}, {
   3.685277136438933*^9, 3.685277146702281*^9}, {3.685277202592741*^9, 
   3.6852772965458384`*^9}, {3.685277363373354*^9, 3.685277407214512*^9}, {
   3.6852775366701183`*^9, 3.6852775667932587`*^9}, {3.6852777411745872`*^9, 
   3.685277742899378*^9}, {3.685277837339059*^9, 3.685277851509961*^9}, {
   3.6852779939968777`*^9, 3.685278000525882*^9}, {3.685278156657658*^9, 
   3.685278164080124*^9}, {3.685278511869396*^9, 3.6852785125060387`*^9}, {
   3.6852785636100683`*^9, 3.685278565432447*^9}, {3.68530263972993*^9, 
   3.685302670982891*^9}, 3.690765967190567*^9, {3.696785995000126*^9, 
   3.6967860412277107`*^9}, {3.696786111268141*^9, 3.6967861621618013`*^9}, {
   3.6967867873013372`*^9, 3.696786798401058*^9}, {3.7012148972835913`*^9, 
   3.7012149019413557`*^9}, {3.7012149722159357`*^9, 
   3.7012149781924667`*^9}, {3.701215015935874*^9, 3.701215046545094*^9}, {
   3.701215112256198*^9, 3.7012151279429283`*^9}, 3.7012151699126253`*^9, {
   3.708702536386489*^9, 3.708702559771085*^9}, 3.709243344605908*^9, {
   3.724083159756587*^9, 3.724083229281801*^9}, {3.724083368525931*^9, 
   3.724083399534659*^9}, 3.724083664387042*^9, {3.724083847301786*^9, 
   3.724083972579434*^9}},ExpressionUUID->"d50aa1a6-42ce-4920-bcfd-\
9d030080f40e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"cellMatchQ", "[", 
    RowBox[{"cell_", ",", "types_", ",", "Normal"}], "]"}], ":=", "\n", "\t", 
   
   RowBox[{"Replace", "[", "\n", "\t\t", 
    RowBox[{"cell", ",", "\n", "\t", "\t", 
     RowBox[{"{", "\n", "\t", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"Cell", "[", 
         RowBox[{"_", ",", " ", 
          RowBox[{"_", "?", 
           RowBox[{"(", 
            RowBox[{"cellTypeMatchQ", "[", "types", "]"}], ")"}]}], ",", " ", 
          "___"}], "]"}], "\[RuleDelayed]", "\n", "\t\t\t\t", "True"}], ",", 
       "\n", "\t", "\t\t", 
       RowBox[{"_", "\[RuleDelayed]", "\n", "\t", "\t\t\t", "False"}]}], "\n",
       "\t", "\t\t", "}"}]}], "\n", "\t", "\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cellMatchQ", "[", 
   RowBox[{"cell_", ",", "types_", ",", "_"}], "]"}], ":=", 
  "False"}]}], "CodeInput",
 CellChangeTimes->{{3.685277078556501*^9, 3.6852770918245487`*^9}, {
   3.685277136438933*^9, 3.685277146702281*^9}, {3.685277202592741*^9, 
   3.6852772965458384`*^9}, {3.685277363373354*^9, 3.685277407214512*^9}, {
   3.6852775366701183`*^9, 3.6852775667932587`*^9}, {3.6852777411745872`*^9, 
   3.685277742899378*^9}, {3.685277837339059*^9, 3.685277851509961*^9}, {
   3.6852779939968777`*^9, 3.685278000525882*^9}, {3.685278156657658*^9, 
   3.685278164080124*^9}, {3.685278511869396*^9, 3.6852785125060387`*^9}, {
   3.6852785636100683`*^9, 3.685278565432447*^9}, {3.68530263972993*^9, 
   3.685302670982891*^9}, 3.690765967190567*^9, {3.696785995000126*^9, 
   3.6967860412277107`*^9}, {3.696786111268141*^9, 3.6967861621618013`*^9}, {
   3.6967867873013372`*^9, 3.696786798401058*^9}, {3.7012148972835913`*^9, 
   3.7012149019413557`*^9}, {3.7012149722159357`*^9, 
   3.7012149781924667`*^9}, {3.701215015935874*^9, 3.701215046545094*^9}, {
   3.701215112256198*^9, 3.7012151279429283`*^9}, 3.7012151699126253`*^9, {
   3.708702536386489*^9, 3.708702559771085*^9}, 3.709243344605908*^9, {
   3.724083159756587*^9, 3.724083229281801*^9}, {3.724083368525931*^9, 
   3.724083399534659*^9}, 3.724083664387042*^9, {3.724083847301786*^9, 
   3.724083957582985*^9}},ExpressionUUID->"f4678791-6e4b-4a4e-a3e5-\
caa6da7a020c"]
}, Closed]],

Cell[CellGroupData[{

Cell["stylesheetNotebook", "CodeSubsubsubsection",
 CellChangeTimes->{{3.700936237710785*^9, 3.70093625769105*^9}, {
  3.700936299561347*^9, 
  3.700936310105445*^9}},ExpressionUUID->"e64c406f-8181-4096-8ecb-\
c4217a3c1a36"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"stylesheetNotebook", "[", 
    RowBox[{"nb_", ",", 
     RowBox[{"file_String", "?", "FileExistsQ"}]}], "]"}], ":=", 
   RowBox[{"Get", "@", "file"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"stylesheetNotebook", "[", 
    RowBox[{"nb_", ",", "file_FrontEnd`FileName"}], "]"}], ":=", 
   RowBox[{"Get", "@", 
    RowBox[{"ToFileName", "@", "file"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"stylesheetNotebook", "[", 
    RowBox[{"nb_NotebookObject", ",", "file_String"}], "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"stylesheetNotebook", "[", 
    RowBox[{
     RowBox[{"NotebookGet", "@", "nb"}], ",", 
     RowBox[{"Quiet", "@", 
      RowBox[{"NotebookDirectory", "@", "nb"}]}], ",", "file"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"stylesheetNotebook", "[", "\n", "\t\t", 
    RowBox[{"nb_Notebook", ",", "\n", "\t\t", 
     RowBox[{"dir", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"_String", "?", "DirectoryQ"}], "|", "Automatic", "|", 
        "$Failed"}], ")"}], ":", "Automatic"}], ",", "\n", "\t", "\t", 
     "file_String"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"testDir", "=", "\n", "\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"Quiet", "@", 
          RowBox[{"NotebookDirectory", "@", "nb"}]}], ",", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{"_NotebookDirectory", "|", "$Failed"}], "\[RuleDelayed]", 
          "\n", "\t\t\t", 
          RowBox[{"Replace", "[", 
           RowBox[{"dir", ",", 
            RowBox[{
             RowBox[{"$Failed", "|", "Automatic"}], ":>", 
             "$UserDocumentsDirectory"}]}], "]"}]}]}], "\n", "\t\t\t", 
        "]"}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "@", 
        RowBox[{"FileNameJoin", "@", 
         RowBox[{"{", 
          RowBox[{"testDir", ",", "file"}], "}"}]}]}], ",", "\n", "\t", 
       "\t\t", 
       RowBox[{"Get", "@", 
        RowBox[{"FileNameJoin", "@", 
         RowBox[{"{", 
          RowBox[{"testDir", ",", "file"}], "}"}]}]}], ",", "\n", "\t", 
       "\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"Flatten", "@", 
            RowBox[{"Table", "[", "\n", "\t", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"FileNames", "[", 
               RowBox[{"\"\<*\>\"", ",", 
                RowBox[{"FileNameJoin", "@", 
                 RowBox[{"{", 
                  RowBox[{
                  "d", ",", "\"\<FrontEnd\>\"", ",", "\"\<Stylesheets\>\""}], 
                  "}"}]}]}], "]"}], ",", "\n", "\t", "\t\t\t\t\t\t\t\t", 
              RowBox[{"{", 
               RowBox[{"d", ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                RowBox[{"FileNames", "[", 
                 RowBox[{"\"\<*\>\"", ",", 
                  RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"FileNameJoin", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    "$UserBaseDirectory", ",", "\"\<Applications\>\""}], 
                    "}"}]}], ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    "$InstallationDirectory"}], "\n", "\t", 
                   "\t\t\t\t\t\t\t\t\t", "}"}]}], "]"}]}], "\n", "\t", 
               "\t\t\t\t\t\t\t\t", "}"}]}], "]"}]}], ",", "\n", "\t", 
           "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"s_", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"FileNameTake", "@", "#"}], "===", "file"}], "&"}], 
              ")"}]}], "\[RuleDelayed]", "s"}]}], "]"}], ",", "\n", "\t", 
         "\t\t\t\t", 
         RowBox[{"{", "\n", "\t", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "}"}], ":>", "$Failed"}], ",", "\n", "\t", "\t", 
           "\t\t\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"s_", ",", "___"}], "}"}], "\[RuleDelayed]", 
            RowBox[{"Get", "@", "s"}]}]}], "\n", "\t", "\t\t\t", "}"}]}], 
        "\n", "\t", "\t\t\t\t", "]"}]}], "\n", "\t", "\t\t\t", "]"}]}], "\n", 
    "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6852246467299843`*^9, 3.6852247278150454`*^9}, {
   3.685224791007307*^9, 3.685225130299077*^9}, {3.685225219991593*^9, 
   3.6852252293019323`*^9}, {3.685225264279405*^9, 3.685225278765312*^9}, {
   3.685225397058816*^9, 3.685225447649825*^9}, {3.685225525152171*^9, 
   3.685225534956674*^9}, {3.6852256065551147`*^9, 3.685225606642336*^9}, {
   3.685225650202574*^9, 3.685225720718741*^9}, {3.6853683382012444`*^9, 
   3.685368578585495*^9}, {3.685368971399013*^9, 3.6853690839286346`*^9}, 
   3.685369172355709*^9, {3.68536921175098*^9, 3.685369280756426*^9}, {
   3.6853693647116947`*^9, 3.6853694379199257`*^9}, {3.687192118759778*^9, 
   3.68719212027607*^9}, {3.687192151467108*^9, 3.687192164014999*^9}, {
   3.687192922510865*^9, 3.6871929436091137`*^9}, {3.687193007535947*^9, 
   3.687193010660561*^9}},ExpressionUUID->"81385652-a217-44de-953c-\
2fd3187a9f1c"]
}, Closed]],

Cell[CellGroupData[{

Cell["ssMakeEnvDatas", "CodeSubsubsubsection",
 CellChangeTimes->{{3.700936237710785*^9, 3.70093625769105*^9}, {
   3.700936299561347*^9, 3.700936310105445*^9}, 3.721838458690978*^9, {
   3.727890735999082*^9, 
   3.727890737879778*^9}},ExpressionUUID->"544283df-abbe-4e3b-b884-\
b9016dac52b6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ssMakeEnvDatas", "[", "typeData_", "]"}], ":=", "\n", "\t", 
   RowBox[{"Replace", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"ssNormalizeStyleName", "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"List", "@", "typeData"}]}]}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a_", "\[Rule]", "b_"}], ")"}], ":>", "\n", "\t\t\t", 
      RowBox[{"StyleData", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"Sequence", "@@", 
         RowBox[{"Flatten", "@", 
          RowBox[{"{", "a", "}"}]}]}], ",", "\n", "\t\t\t\t", 
        RowBox[{"StyleDefinitions", "\[Rule]", "\n", "\t\t\t\t\t", 
         RowBox[{"StyleData", "[", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"Flatten", "@", 
            RowBox[{"{", "b", "}"}]}]}], "]"}]}]}], "\n", "\t\t\t\t", "]"}]}],
      ",", "\n", "\t\t", "1"}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.7218383261617727`*^9, 3.7218383535497713`*^9}, {
   3.727831136274296*^9, 3.727831139799941*^9}, 
   3.7278907393029137`*^9},ExpressionUUID->"a37007e6-e813-46f6-ac89-\
295b35686c4f"]
}, Closed]],

Cell[CellGroupData[{

Cell["StyleSheetCells", "CodeSubsubsubsection",
 CellChangeTimes->{3.700936322593102*^9, 
  3.721838833496272*^9},ExpressionUUID->"1b2c6a00-1f62-4181-98bb-\
7ac4415e5de8"],

Cell[BoxData[{
 RowBox[{"StyleSheetCells", "//", "Clear"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "StyleSheetCells", "]"}], "=", 
   RowBox[{"{", "\n", "\t", 
    RowBox[{
     RowBox[{"\"\<MakeCell\>\"", "\[Rule]", "False"}], ",", "\n", "\t", 
     RowBox[{"\"\<SelectMode\>\"", "\[Rule]", "StyleData"}], ",", "\n", "\t", 
     
     RowBox[{"\"\<DetectStylesheet\>\"", "\[Rule]", "True"}]}], "\n", "\t", 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetCells", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"nb", ":", 
      RowBox[{"_Notebook", "|", "_NotebookObject", "|", "Automatic"}], ":", 
      "Automatic"}], ",", "\n", "\t", 
     RowBox[{"typeData", ":", 
      RowBox[{"$StyleSheetCellStylePatterns", "|", 
       RowBox[{"{", "}"}]}]}], ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"make", "=", 
        RowBox[{"TrueQ", "@", 
         RowBox[{"OptionValue", "[", "\"\<MakeCell\>\"", "]"}]}]}], ",", "\n",
        "\t\t", 
       RowBox[{"mode", "=", "\n", "\t\t\t", 
        RowBox[{"Replace", "[", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<SelectMode\>\"", "]"}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{
           RowBox[{"Except", "[", 
            RowBox[{"Normal", "|", "StyleData"}], "]"}], "\[Rule]", 
           "StyleData"}]}], "\n", "\t\t\t\t", "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"types", "=", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{"#", ",", " ", "_Rule"}], "]"}], "&"}], "/@", 
         RowBox[{"StyleSheetStyleData", "[", "typeData", "]"}]}]}]}], "\n", 
      "\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"Replace", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Select", "[", "\n", "\t\t\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "get", " ", "the", " ", "CellObjects", " ", "against", " ", "which", 
          " ", "to", " ", "match"}], " ", "*)"}], "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"Replace", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"TrueQ", "@", 
              RowBox[{"OptionValue", "[", "\"\<DetectStylesheet\>\"", "]"}]}],
              ",", "\n", "\t\t\t\t\t\t", 
             RowBox[{"StyleSheetNotebookObject", "[", "nb", "]"}], ",", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{"Replace", "[", 
              RowBox[{"nb", ",", " ", 
               RowBox[{"Automatic", "\[RuleDelayed]", 
                RowBox[{"EvaluationNotebook", "[", "]"}]}]}], "]"}]}], "\n", 
            "\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{"{", "\n", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"n_NotebookObject", "\[RuleDelayed]", 
              RowBox[{"Cells", "[", "n", "]"}]}], ",", "\n", "\t", 
             "\t\t\t\t\t", 
             RowBox[{"n_Notebook", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{"First", "@", 
                RowBox[{"NotebookTools`FlattenCellGroups", "[", "n", "]"}]}], 
               ")"}]}]}], "\n", "\t\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t\t", 
          "]"}], ",", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"cellMatchQ", "[", 
           RowBox[{
            RowBox[{"Replace", "[", 
             RowBox[{"#", ",", 
              RowBox[{"c_CellObject", ":>", 
               RowBox[{"NotebookRead", "@", "c"}]}]}], "]"}], ",", " ", 
            "types", ",", " ", "mode"}], "]"}], "&"}]}], "\n", "\t\t\t\t", 
        "]"}], ",", "\n", "\t\t\t", 
       RowBox[{"{", "\n", "\t\t\t\t", 
        RowBox[{"l_List", ":>", "\n", "\t\t\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"mode", "===", "StyleData"}], "&&", "make"}], ",", "\n", 
           "\t\t\t\t\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "if", " ", "there", " ", "were", " ", "styles", " ", "that", " ", 
              RowBox[{"weren", "'"}], "t", " ", "found"}], ",", " ", 
             RowBox[{"make", " ", "them"}]}], " ", "*)"}], "\n", 
           "\t\t\t\t\t\t", 
           RowBox[{"With", "[", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"missingStyles", "=", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{"Select", "[", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"Cases", "[", 
                  RowBox[{
                   RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"{", "types", "}"}], ",", "1"}], "]"}], ",", " ", 
                   
                   RowBox[{"_StyleData", "|", "_String"}]}], "]"}], ",", "\n",
                  "\t", "\t\t\t\t\t\t\t\t", 
                 RowBox[{"With", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"c", "=", 
                    RowBox[{"NotebookRead", "/@", "l"}]}], "}"}], ",", "\n", 
                   "\t", "\t", "\t", "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"s", "=", "#"}], "}"}], ",", "\n", "\t", "\t", 
                    "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Not", "@", 
                    RowBox[{"AnyTrue", "[", 
                    RowBox[{"c", ",", " ", 
                    RowBox[{
                    RowBox[{"cellMatchQ", "[", 
                    RowBox[{"#", ",", " ", "s", ",", " ", "StyleData"}], 
                    "]"}], "&"}]}], "]"}]}]}], "\n", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t", "]"}], "&"}]}], "\n", "\t", "\t", 
                  "\t", "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t", "\t", "\t", 
                "\t\t\t\t\t\t", "]"}]}], "\n", "\t", "\t\t\t\t\t\t\t", "}"}], 
             ",", "\n", "\t", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"StyleSheetNew", "[", 
               RowBox[{"nb", ",", " ", "missingStyles"}], "]"}], ";", "\n", 
              "\t", "\t\t\t\t\t\t", 
              RowBox[{"Join", "[", "\n", "\t", "\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"StyleSheetCells", "[", 
                 RowBox[{
                 "nb", ",", "\n", "\t", "\t\t\t\t\t\t\t\t", "missingStyles", 
                  ",", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                  RowBox[{"\"\<MakeCell\>\"", "\[Rule]", "False"}], ",", "\n",
                   "\t", "\t\t\t\t\t\t\t\t", "ops"}], "\n", "\t", 
                 "\t\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t", "\t\t\t\t\t\t\t",
                 "l"}], "\n", "\t", "\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t", 
            "\t\t\t\t\t\t", "]"}], ",", "\n", "\t", "\t\t\t\t\t", "l"}], 
          "]"}]}], "\t", "\n", "\t", "\t\t\t", "}"}]}], "\n", "\t\t\t", 
      "]"}]}], "\n", "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.721838436765482*^9, 3.721838442417049*^9}, {
   3.7218388316164627`*^9, 3.7218388316618557`*^9}, {3.7240830971354237`*^9, 
   3.724083100536955*^9}, {3.7240837515527554`*^9, 3.72408380467546*^9}, {
   3.7278311259162188`*^9, 3.727831130946816*^9}, {3.727890602463469*^9, 
   3.72789070523744*^9}, 3.727890746568902*^9, {3.727891767398827*^9, 
   3.727891785264874*^9}, {3.72789207530896*^9, 3.7278920838391447`*^9}, 
   3.7278993701016703`*^9, 3.728182624650236*^9, {3.728183314450029*^9, 
   3.728183396047935*^9}},ExpressionUUID->"e484edf9-e65e-402d-ab06-\
436257330341"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]StyleSheetNew\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6851960347326183`*^9, 3.685196037556448*^9}, {
   3.69679174455299*^9, 3.696791746197444*^9}, 
   3.721838833054016*^9},ExpressionUUID->"5c234f25-8714-4e28-8424-\
b0d132d6a6f6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "$StyleSheetNewCellStyles", "=", "\n", "\t", 
   "$StyleSheetCellStylePatterns"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$StyleSheetNewParentStyles", "=", "\n", "\t", 
   RowBox[{
   "_FrontEnd`FileName", "|", "_String", "|", "_StyleData", "|", "None", "|", 
    "\n", "\t\t\t", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
       "_FrontEnd`FileName", "|", "_String", "|", "_StyleData", "|", "None"}],
        ")"}], ".."}], "}"}]}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.721837816525523*^9, 3.7218378595903053`*^9}, {
  3.72183883307172*^9, 3.721838833076593*^9}, {3.727890274823794*^9, 
  3.727890276124896*^9}},ExpressionUUID->"30c75b21-59db-4730-b659-\
564f1202e8a9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "StyleSheetNew", "]"}], "=", "\n", "\t", 
   RowBox[{"DeleteDuplicatesBy", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Join", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Options", "[", "Cell", "]"}], ",", "\n", "\t", "\t\t", 
       RowBox[{"Options", "[", "Notebook", "]"}], ",", "\n", "\t", "\t\t", 
       RowBox[{"Options", "[", "NotebookWrite", "]"}], ",", "\n", "\t\t\t", 
       RowBox[{"{", "\n", "\t\t\t\t", 
        RowBox[{"\"\<DetectStylesheet\>\"", "\[Rule]", "True"}], "\n", 
        "\t\t\t\t", "}"}]}], "\n", "\t\t\t", "]"}], ",", "\n", "\t\t", 
     "First"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetNew", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"nb", ":", 
      RowBox[{"_NotebookObject", "|", "Automatic"}], ":", "Automatic"}], ",", 
     "\n", "\t", 
     RowBox[{"type", ":", "$StyleSheetNewCellStyles"}], ",", "\n", "\t", 
     RowBox[{"placement", ":", 
      RowBox[{"Next", "|", "First", "|", "Last", "|", "Automatic"}], ":", 
      "Automatic"}], ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t", "\t", 
      RowBox[{
       RowBox[{"ec", "=", 
        RowBox[{"EvaluationCell", "[", "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"notebook", "=", "\n", "\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"TrueQ", "@", 
           RowBox[{"OptionValue", "[", "\"\<DetectStylesheet\>\"", "]"}]}], 
          ",", "\n", "\t\t\t\t", 
          RowBox[{"StyleSheetNotebookObject", "[", "nb", "]"}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{"Replace", "[", 
           RowBox[{"nb", ",", " ", 
            RowBox[{"Automatic", "\[RuleDelayed]", 
             RowBox[{"EvaluationNotebook", "[", "]"}]}]}], "]"}]}], "\n", 
         "\t\t\t\t", "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"position", "=", "\n", "\t\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{"placement", ",", "\n", "\t", "\t", "\t\t\t", 
          RowBox[{"Automatic", "\[RuleDelayed]", 
           RowBox[{"Replace", "[", 
            RowBox[{"type", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"_DefaultStyle", "\[Rule]", "First"}], ",", 
               RowBox[{"_", "\[Rule]", "Next"}]}], "}"}]}], "]"}]}]}], 
         "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"styleDecs", "=", "\n", "\t\t\t", 
        RowBox[{"StyleSheetStyleData", "[", "type", "]"}]}]}], "\n", "\t\t", 
      "}"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"Switch", "[", 
       RowBox[{"position", ",", "\n", "\t\t\t", "First", ",", 
        RowBox[{"SelectionMove", "[", 
         RowBox[{"notebook", ",", "Before", ",", "Notebook"}], "]"}], ",", 
        "\n", "\t", "\t", "\t", "Next", ",", 
        RowBox[{"SelectionMove", "[", 
         RowBox[{"notebook", ",", "After", ",", "Cell"}], "]"}], ",", "\n", 
        "\t", "\t", "\t", "Last", ",", 
        RowBox[{"SelectionMove", "[", 
         RowBox[{"notebook", ",", "After", ",", "Notebook"}], "]"}]}], "\n", 
       "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"NotebookWrite", "[", 
         RowBox[{"notebook", ",", "\n", "\t\t\t", 
          RowBox[{"Cell", "[", 
           RowBox[{"#", ",", "\n", "\t\t\t\t", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"FilterRules", "[", 
              RowBox[{
               RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t\t", 
               RowBox[{"Except", "[", 
                RowBox[{"Alternatives", "@@", 
                 RowBox[{"Map", "[", 
                  RowBox[{"First", ",", 
                   RowBox[{"Options", "[", "NotebookWrite", "]"}]}], "]"}]}], 
                "]"}]}], "\n", "\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t", 
           "]"}], ",", "\n", "\t\t\t", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"FilterRules", "[", 
            RowBox[{
             RowBox[{"{", "ops", "}"}], ",", 
             RowBox[{"Options", "@", "NotebookWrite"}]}], "]"}]}]}], "\n", 
         "\t\t\t", "]"}], "&"}], "/@", "styleDecs"}], ";"}]}], "\n", "\t\t", 
    "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.684520132172505*^9, 3.684520253296995*^9}, {
   3.6845203012981586`*^9, 3.684520517023663*^9}, {3.68452061501256*^9, 
   3.684520672179372*^9}, {3.684520729312011*^9, 3.684520747663398*^9}, {
   3.6845211646237926`*^9, 3.684521235187975*^9}, {3.684521268231245*^9, 
   3.6845214783300333`*^9}, 3.684521520704937*^9, {3.684521584683675*^9, 
   3.68452159021938*^9}, {3.684521630851108*^9, 3.684521637226313*^9}, {
   3.6845221311462307`*^9, 3.6845221696386957`*^9}, {3.6845225236316433`*^9, 
   3.684522535597466*^9}, {3.6845225853729553`*^9, 3.684522624896104*^9}, {
   3.685200097525194*^9, 3.685200110409655*^9}, {3.6852959162781887`*^9, 
   3.68529593630503*^9}, {3.689540097573072*^9, 3.689540137411993*^9}, 
   3.690746749408228*^9, {3.690766155361533*^9, 3.6907661560068502`*^9}, {
   3.6967882320142307`*^9, 3.696788243764311*^9}, {3.6972129981622057`*^9, 
   3.697213032976965*^9}, {3.697213065710471*^9, 3.697213167682972*^9}, {
   3.69721321024771*^9, 3.6972133975746117`*^9}, {3.697213427606986*^9, 
   3.697213622955619*^9}, {3.697213660675582*^9, 3.6972136668684483`*^9}, {
   3.6972137492560787`*^9, 3.697213753604727*^9}, {3.697213793742724*^9, 
   3.69721384717177*^9}, {3.697213878472878*^9, 3.6972139266711884`*^9}, {
   3.697214003264583*^9, 3.697214005301036*^9}, {3.69721403793477*^9, 
   3.697214039364265*^9}, {3.697214074505661*^9, 3.697214148376527*^9}, {
   3.697214220981546*^9, 3.697214232333384*^9}, {3.697214271034032*^9, 
   3.697214403128895*^9}, {3.697214439077776*^9, 3.697214564219092*^9}, {
   3.697214671964004*^9, 3.6972147186400633`*^9}, {3.697214890464788*^9, 
   3.697214898256261*^9}, {3.6972149440157747`*^9, 3.69721505421771*^9}, {
   3.6972150844398813`*^9, 3.697215141746153*^9}, {3.6972151755013037`*^9, 
   3.69721528142994*^9}, {3.69721551836474*^9, 3.697215634108096*^9}, 
   3.697215739166335*^9, {3.697215816514175*^9, 3.6972158461564217`*^9}, {
   3.697216866646347*^9, 3.69721687314017*^9}, 3.697217280200901*^9, 
   3.6999857287675257`*^9, {3.7092071642591953`*^9, 3.709207175606443*^9}, {
   3.721837832833503*^9, 3.721837858233593*^9}, {3.7218388331506367`*^9, 
   3.72183883318281*^9}, 3.7278311795147142`*^9, 3.727831255387341*^9, {
   3.727890374922418*^9, 3.7278903775899878`*^9}, 3.727899370108109*^9, {
   3.728180162459364*^9, 3.7281801671790237`*^9}, {3.7281836209705*^9, 
   3.7281836407611513`*^9}},ExpressionUUID->"cf56dc33-be2b-416f-a43a-\
5e313e41bda9"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]StyleSheetDelete\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6967917499198713`*^9, 3.696791754413047*^9}, 
   3.721838833198729*^9},ExpressionUUID->"3e9043e2-52c6-49c2-ae25-\
0bd326a0b0ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetDelete", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"nb", ":", 
      RowBox[{"_NotebookObject", "|", "Automatic"}], ":", "Automatic"}], ",", 
     "\n", "\t", 
     RowBox[{"type", ":", 
      RowBox[{"_String", "|", "_List", "|", "_DefaultStyle"}]}]}], "]"}], ":=",
    "\n", "\t", 
   RowBox[{"Replace", "[", 
    RowBox[{
     RowBox[{"StyleSheetCells", "[", 
      RowBox[{"nb", ",", "type"}], "]"}], ",", 
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"c", ":", 
        RowBox[{"{", "__CellObject", "}"}]}], ":>", "\n", "\t\t\t", 
       RowBox[{"NotebookDelete", "@", "c"}]}], "\n", "\t\t", "}"}]}], "]"}]}],
   ";"}]], "CodeInput",
 CellChangeTimes->{{3.6907467639290257`*^9, 3.690746811019277*^9}, {
  3.699986583895462*^9, 3.699986598329639*^9}, {3.721838833212865*^9, 
  3.721838833218*^9}},ExpressionUUID->"9b7c773b-3fee-48cb-a3a3-0003bfd2639a"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]StylesheetNotebook\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6967967375590563`*^9, 
  3.696796740974313*^9}},ExpressionUUID->"10982de1-0144-45eb-8260-\
6919b511da5a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"StylesheetNotebook", "[", 
    RowBox[{"nb", ":", 
     RowBox[{"_Notebook", "|", "_NotebookObject", "|", "Automatic"}], ":", 
     "Automatic"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", "=", 
       RowBox[{"Replace", "[", 
        RowBox[{"nb", ",", 
         RowBox[{"Automatic", "\[RuleDelayed]", 
          RowBox[{"StyleSheetNotebookObject", "[", "]"}]}]}], "]"}]}], "}"}], 
     ",", "\n", "\t", "\t", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"styleDefs", "=", 
          RowBox[{"StyleDefinitions", "/.", 
           RowBox[{"Options", "[", 
            RowBox[{"n", ",", "StyleDefinitions"}], "]"}]}]}], ",", "\n", 
         "\t", "\t\t\t", "parentNB", ",", "extraStyles"}], "}"}], ",", "\n", 
       "\t\t\t\t", 
       RowBox[{
        RowBox[{"parentNB", "=", "\n", "\t\t\t\t\t", 
         RowBox[{"Replace", "[", 
          RowBox[{"styleDefs", ",", "\n", "\t\t\t\t\t\t", 
           RowBox[{"sd_Notebook", "\[RuleDelayed]", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{"Replace", "[", 
             RowBox[{
              RowBox[{"StyleSheetCells", "[", 
               RowBox[{"sd", ",", "Default"}], "]"}], ",", "\n", "\t", 
              "\t\t\t\t\t\t\t", 
              RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"___", ",", "c_"}], "}"}], "\[RuleDelayed]", 
                 RowBox[{"Last", "@", 
                  RowBox[{"First", "@", 
                   RowBox[{"First", "@", "c"}]}]}]}], ",", "\n", "\t", 
                "\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"{", "}"}], "->", 
                 RowBox[{"Notebook", "[", 
                  RowBox[{"{", "}"}], "]"}]}]}], "\n", "\t", "\t\t\t\t\t\t\t",
                "}"}]}], "]"}]}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}], ";", 
        "\n", "\t\t\t\t", 
        RowBox[{"extraStyles", "=", "\n", "\t\t\t\t\t", 
         RowBox[{"Replace", "[", 
          RowBox[{"styleDefs", ",", 
           RowBox[{"{", "\n", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"sd_Notebook", "\[RuleDelayed]", 
              RowBox[{"StyleSheetCells", "[", "sd", "]"}]}], ",", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{"_", "\[RuleDelayed]", 
              RowBox[{"{", "}"}]}]}], "\n", "\t\t\t\t\t\t", "}"}]}], "]"}]}], 
        ";", "\n", "\t", "\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"parentNB", ",", 
            RowBox[{"_String", "|", "_FrontEnd`FileName"}]}], "]"}], ",", 
          "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"parentNB", "=", "\n", "\t\t\t\t\t\t", 
            RowBox[{"Replace", "[", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"stylesheetNotebook", "[", 
               RowBox[{"n", ",", "parentNB"}], "]"}], ",", "\n", "\t", "\t", 
              "\t\t\t\t\t", 
              RowBox[{"s_String", "\[RuleDelayed]", 
               RowBox[{"Get", "@", "s"}]}]}], "\n", "\t", "\t\t\t\t\t\t", 
             "]"}]}], ";", "\n", "\t\t\t\t\t", "parentNB"}]}], "\n", 
         "\t\t\t\t\t", "]"}], ";", "\n", "\t", "\t\t\t", 
        RowBox[{"Replace", "[", "\n", "\t", "\t\t\t\t", 
         RowBox[{
          RowBox[{"NotebookTools`FlattenCellGroups", "@", "parentNB"}], ",", 
          RowBox[{"{", "\n", "\t", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"Notebook", "[", 
              RowBox[{"cells_List", ",", "o___"}], "]"}], "\[RuleDelayed]", 
             "\n", "\t", "\t\t\t\t\t\t", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"styleNB", "=", 
                 RowBox[{"Notebook", "[", 
                  RowBox[{"Flatten", "@", 
                   RowBox[{"{", 
                    RowBox[{"cells", ",", "extraStyles"}], "}"}]}], "]"}]}], 
                "}"}], ",", "\n", "\t", "\t\t\t\t\t\t\t", 
               RowBox[{"Notebook", "[", 
                RowBox[{
                 RowBox[{"Join", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"StyleSheetCells", "[", 
                    RowBox[{"styleNB", ",", "Default"}], "]"}], ",", "\n", 
                   "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"StyleSheetCells", "[", "styleNB", "]"}]}], "]"}], 
                 ",", "\n", "\t", "\t\t\t\t\t\t\t\t", "o"}], "]"}]}], "\n", 
              "\t", "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t", "\t\t\t\t\t", 
            
            RowBox[{"_", "\[Rule]", "parentNB"}]}], "\n", "\t", "\t\t\t\t\t", 
           "}"}]}], "\n", "\t", "\t\t\t\t", "]"}]}]}], "\n", "\t", "\t\t\t", 
      "]"}]}], "\n", "\t", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.685365576574044*^9, 3.685365700703643*^9}, {
   3.685365841880412*^9, 3.6853661670117817`*^9}, {3.685366197562904*^9, 
   3.685366451675989*^9}, {3.6853665719984837`*^9, 3.68536665269112*^9}, {
   3.685366941214559*^9, 3.685366971499591*^9}, 3.685752870546764*^9, 
   3.699985720223925*^9, {3.709207638828437*^9, 3.709207667616578*^9}, {
   3.721838831669363*^9, 3.721838831695182*^9}, 
   3.727899370114869*^9},ExpressionUUID->"8cbf3441-0ce5-4323-83ce-\
fcc75544ab4f"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Styles\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.696796744205615*^9, 
  3.6967967451818*^9}},ExpressionUUID->"72a0bc50-eba0-4131-b24e-3c87a30bde8c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetStyles", "[", 
    RowBox[{"nb", ":", 
     RowBox[{"_Notebook", "|", "_NotebookObject", "|", "Automatic"}], ":", 
     "Automatic"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Module", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"defaultCells", "=", 
       RowBox[{"StyleSheetCells", "[", 
        RowBox[{"nb", ",", "Default"}], "]"}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"n", "=", 
           RowBox[{"StylesheetNotebook", "@", "nb"}]}], "}"}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{
          RowBox[{"defaultCells", "=", 
           RowBox[{"{", "\n", "\t\t\t\t\t", 
            RowBox[{"defaultCells", ",", "\n", "\t\t\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"n", "=!=", "$Failed"}], ",", 
               RowBox[{"StyleSheetCells", "[", 
                RowBox[{"n", ",", "Default"}], "]"}], ",", 
               RowBox[{"{", "}"}]}], "]"}]}], "}"}]}], ";", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"Cases", "[", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"n", "=!=", "$Failed"}], ",", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"StyleSheetCells", "[", "n", "]"}], ",", "\n", 
              "\t\t\t\t\t\t\t", 
              RowBox[{"{", "}"}]}], "]"}], ",", "\n", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Cell", "[", 
              RowBox[{
               RowBox[{"StyleData", "[", 
                RowBox[{
                 RowBox[{"s", ":", 
                  RowBox[{
                   RowBox[{"Except", "[", "_Rule", "]"}], ".."}]}], ",", 
                 "___Rule"}], "]"}], ",", "___"}], "]"}], "\[RuleDelayed]", 
             RowBox[{"Cell", "[", 
              RowBox[{"StyleData", "[", "s", "]"}], "]"}]}]}], "\n", 
           "\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t", "]"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"Join", "@@", "defaultCells"}]}], "\n", "\t\t", "}"}]}], "\n", 
    "\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.685218222070129*^9, 3.685218286746085*^9}, {
   3.6852186203996058`*^9, 3.6852186222684193`*^9}, {3.685218770562133*^9, 
   3.685218772102292*^9}, 3.6852188196209803`*^9, {3.6852190016567*^9, 
   3.685219366739605*^9}, {3.685219411531372*^9, 3.685219449016313*^9}, {
   3.6852196402516537`*^9, 3.685219692806267*^9}, {3.6852197406483517`*^9, 
   3.685219742894525*^9}, {3.685219833318261*^9, 3.685219835305668*^9}, {
   3.685220141098398*^9, 3.685220142047014*^9}, {3.685221522249853*^9, 
   3.6852215300071983`*^9}, {3.685222570810618*^9, 3.68522257442719*^9}, {
   3.6852226157392282`*^9, 3.68522269127905*^9}, 3.685222796805052*^9, {
   3.685222916090405*^9, 3.685223159013623*^9}, {3.685223321996299*^9, 
   3.685223353657075*^9}, {3.685223385327567*^9, 3.685223386270368*^9}, {
   3.685223428560041*^9, 3.68522346514025*^9}, {3.685223536147993*^9, 
   3.6852237676655197`*^9}, {3.685223821705453*^9, 3.6852240609520683`*^9}, {
   3.685224150167849*^9, 3.6852241597986517`*^9}, {3.6852242466271353`*^9, 
   3.685224302295307*^9}, {3.685224449636271*^9, 3.685224525873839*^9}, {
   3.6852247341456738`*^9, 3.685224786417263*^9}, {3.6852251833819237`*^9, 
   3.685225190555181*^9}, {3.6852253460450363`*^9, 3.685225370802598*^9}, 
   3.685225462169388*^9, {3.6853655061839523`*^9, 3.6853655672502823`*^9}, 
   3.6853657070818567`*^9, {3.687192023242921*^9, 3.68719205854364*^9}, {
   3.6871926183071012`*^9, 3.6871926396539783`*^9}, {3.687193053980998*^9, 
   3.687193056921171*^9}, {3.690766098369566*^9, 3.690766103987273*^9}, {
   3.721838831700095*^9, 
   3.721838831717451*^9}},ExpressionUUID->"b125a1c2-ab2d-4fc5-b9f4-\
2d3f755d414b"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ApplyEdits\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.696796750158784*^9, 
  3.696796751813324*^9}},ExpressionUUID->"328c0812-97a1-4e65-8758-\
13d36947f557"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StyleSheetSuspendScreen", "[", "nb_", "]"}], ":=", "\n", "\t", 
  RowBox[{"frontEndExecuteRouter", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"FrontEnd`NotebookSuspendScreenUpdates", "[", "nb", "]"}], ",", 
    "\n", "\t\t", 
    RowBox[{"FrontEndExecute", "@", "\n", "\t\t\t", 
     RowBox[{"FrontEnd`NotebookSuspendScreenUpdates", "[", "nb", "]"}]}]}], 
   "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.716841535535715*^9, 3.7168415367542343`*^9}, {
   3.716841599963367*^9, 3.716841640941565*^9}, 
   3.721838831722231*^9},ExpressionUUID->"012a0aed-2761-4df2-aeec-\
965e869b8923"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StyleSheetResumeScreen", "[", "nb_", "]"}], ":=", "\n", "\t", 
  RowBox[{"frontEndExecuteRouter", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"FrontEnd`NotebookResumeScreenUpdates", "[", "nb", "]"}], ",", 
    "\n", "\t\t", 
    RowBox[{"FrontEndExecute", "@", "\n", "\t\t\t", 
     RowBox[{"FrontEnd`NotebookResumeScreenUpdates", "[", "nb", "]"}]}]}], 
   "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.716841535535715*^9, 3.7168415367542343`*^9}, {
   3.716841599963367*^9, 3.716841640941565*^9}, {3.716841700278404*^9, 
   3.71684170884832*^9}, 
   3.7218388317269506`*^9},ExpressionUUID->"ebd07ea0-985d-4211-9594-\
fbd466631b0b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StyleSheetSelectionMove", "[", "a___", "]"}], ":=", "\n", "\t", 
  RowBox[{"frontEndExecuteRouter", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"FrontEnd`SelectionMove", "[", "a", "]"}], ",", "\n", "\t\t", 
    RowBox[{"SelectionMove", "[", "a", "]"}]}], "\n", "\t\t", 
   "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.716841648357677*^9, 3.716841674407468*^9}, 
   3.7218388317311707`*^9},ExpressionUUID->"f0a150f8-c3e4-4bb3-b66a-\
4f1c2c28f38a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StyleSheetToggleShowExpr", "[", "nb_", "]"}], ":=", "\n", "\t", 
  RowBox[{"frontEndExecuteRouter", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"frontEndExecuteSow", "[", "\n", "\t\t\t", 
     RowBox[{"FrontEndToken", "[", 
      RowBox[{"nb", ",", " ", "\"\<ToggleShowExpression\>\""}], "]"}], "\n", 
     "\t\t\t", "]"}], ",", "\n", "\t\t", 
    RowBox[{"FrontEndTokenExecute", "[", 
     RowBox[{"nb", ",", " ", "\"\<ToggleShowExpression\>\""}], "]"}]}], "\n", 
   "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.716841462917674*^9, 3.716841539256399*^9}, {
   3.716841597218431*^9, 3.716841597680382*^9}, 
   3.72183883173663*^9},ExpressionUUID->"57e9267c-36e6-4c74-844f-\
db9a5d65aa12"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetApplyEdits", "[", 
    RowBox[{"cells", ":", 
     RowBox[{"{", "__CellObject", "}"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"groups", "=", 
        RowBox[{"GroupBy", "[", 
         RowBox[{"cells", ",", "ParentNotebook"}], "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"current", "=", 
        RowBox[{"EvaluationCell", "[", "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"inb", "=", 
        RowBox[{"InputNotebook", "[", "]"}]}]}], "\n", "\t\t", "}"}], ",", 
     "\n", "\t\t", 
     RowBox[{
      RowBox[{"KeyValueMap", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"nb", "=", "#"}], "}"}], ",", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"$frontEndExecuteBlock", "//", "TrueQ"}], ",", "\n", 
              "\t\t\t\t\t", "CheckAll", ",", "\n", "\t\t\t\t\t", 
              RowBox[{"Function", "[", 
               RowBox[{"Null", ",", " ", "#", ",", " ", "HoldAll"}], "]"}]}], 
             "\n", "\t\t\t\t\t", "]"}], "[", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"StyleSheetSuspendScreen", "[", "nb", "]"}], ";", "\n", 
              "\t\t\t\t\t", 
              RowBox[{"Map", "[", "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"StyleSheetSelectionMove", "[", 
                   RowBox[{
                   "#", ",", "All", ",", "Cell", ",", "\n", "\t\t\t\t\t\t\t", 
                    
                    RowBox[{"AutoScroll", "\[Rule]", "False"}]}], "\n", 
                   "\t\t\t\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"StyleSheetToggleShowExpr", "[", "nb", "]"}], "~", 
                   "Do", "~", "2"}], ";"}], "\n", "\t", "\t\t\t\t\t", "&"}], 
                ",", "\n", "\t\t\t\t\t\t", "#2"}], "\n", "\t\t\t\t\t\t", 
               "]"}], ";", "\n", "\t\t\t\t\t", 
              RowBox[{"StyleSheetResumeScreen", "[", "nb", "]"}]}], ",", "\n",
              "\t\t\t\t\t", 
             RowBox[{"StyleSheetResumeScreen", "[", "nb", "]"}]}], "\n", 
            "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}], "&"}], ",", "\n", 
        "\t\t\t", "groups"}], "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"inb", "===", 
         RowBox[{"ParentNotebook", "@", "current"}]}], ",", "\n", "\t\t\t", 
        RowBox[{"StyleSheetSelectionMove", "[", 
         RowBox[{"current", ",", "All", ",", "Cell"}], "]"}]}], "\n", 
       "\t\t\t", "]"}], ";"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetApplyEdits", "[", 
    RowBox[{"nb", ":", 
     RowBox[{"_CellObject", "|", "Automatic"}], ":", "Automatic"}], "]"}], ":=",
    "\n", "\t", 
   RowBox[{"StyleSheetApplyEdits", "[", 
    RowBox[{"{", 
     RowBox[{"Replace", "[", 
      RowBox[{"nb", ",", 
       RowBox[{"Automatic", "\[RuleDelayed]", 
        RowBox[{"EvaluationCell", "[", "]"}]}]}], "]"}], "}"}], "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6845192871977158`*^9, 3.684519327251869*^9}, {
   3.684519429304473*^9, 3.684519449966413*^9}, {3.684519544669128*^9, 
   3.684519547930524*^9}, {3.68451965481136*^9, 3.6845196867086353`*^9}, {
   3.68451979501987*^9, 3.684519808471242*^9}, {3.684519876853332*^9, 
   3.684519883413332*^9}, {3.684520012145453*^9, 3.684520013759981*^9}, {
   3.684520046176489*^9, 3.6845200519499598`*^9}, {3.6967880924599657`*^9, 
   3.6967881069052067`*^9}, {3.6972175836194887`*^9, 3.697217608754634*^9}, 
   3.697217820502214*^9, {3.697217984441288*^9, 3.6972181450278*^9}, {
   3.699968523467939*^9, 3.699968643954956*^9}, {3.699968680374309*^9, 
   3.699968701679693*^9}, {3.699968865194388*^9, 3.699968973571272*^9}, {
   3.6999690239809217`*^9, 3.699969086898448*^9}, {3.699969254401964*^9, 
   3.6999692861845284`*^9}, {3.699970220346034*^9, 3.699970243771769*^9}, {
   3.699977881500711*^9, 3.699977885246085*^9}, {3.699978008291093*^9, 
   3.699978023343875*^9}, {3.699978054269472*^9, 3.699978066166976*^9}, {
   3.7026832424914722`*^9, 3.702683299285083*^9}, {3.702683352561151*^9, 
   3.702683363535686*^9}, {3.702683432040687*^9, 3.702683452664154*^9}, {
   3.702683557977145*^9, 3.702683593781623*^9}, {3.7026836739191513`*^9, 
   3.702683750463471*^9}, {3.702683864703197*^9, 3.702683879953566*^9}, {
   3.70268402519151*^9, 3.702684030580504*^9}, {3.702684081604087*^9, 
   3.702684102156456*^9}, {3.702684196955061*^9, 3.702684316987762*^9}, {
   3.70268436925828*^9, 3.70268437093987*^9}, {3.7026844582687473`*^9, 
   3.7026844823889008`*^9}, {3.702684518760449*^9, 3.702684523654858*^9}, {
   3.702684621612061*^9, 3.7026847829160013`*^9}, {3.702684862238257*^9, 
   3.702684862824782*^9}, {3.7026849104406977`*^9, 3.702684917204485*^9}, {
   3.7058812441465387`*^9, 3.705881304387525*^9}, {3.705881453227922*^9, 
   3.705881586354884*^9}, {3.705881619581685*^9, 3.705881674278079*^9}, {
   3.705881708350635*^9, 3.705881759520644*^9}, {3.705881984083984*^9, 
   3.705882003047261*^9}, {3.7058820528614817`*^9, 3.705882080923736*^9}, {
   3.705885058076088*^9, 3.705885162895875*^9}, {3.7122507441207943`*^9, 
   3.7122508202054367`*^9}, {3.716841436583757*^9, 3.716841455100971*^9}, {
   3.7168416810246553`*^9, 3.7168416811906223`*^9}, {3.716841716194516*^9, 
   3.7168417808681726`*^9}, {3.7168519931691427`*^9, 3.716852009174391*^9}, {
   3.717027228743005*^9, 3.717027238635988*^9}, {3.721838831741763*^9, 
   3.721838831786045*^9}, {3.727830683410468*^9, 
   3.727830689987385*^9}},ExpressionUUID->"5443f77b-7443-4ca0-8daa-\
3623ec9a2791"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]SetOptions\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7168410858776493`*^9, 
  3.716841087768692*^9}},ExpressionUUID->"50529108-af6a-467e-a970-\
86739320274c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StyleSheetSetOptions", "[", 
   RowBox[{"obj_", ",", "ops__"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"If", "[", 
   RowBox[{"$frontEndExecuteBlock", ",", "\n", "\t\t", 
    RowBox[{"frontEndExecuteSow", "[", "\n", "\t\t\t", 
     RowBox[{"FrontEnd`SetOptions", "[", 
      RowBox[{"obj", ",", " ", "ops"}], "]"}], "\n", "\t\t\t", "]"}], ",", 
    "\n", "\t\t", 
    RowBox[{"SetOptions", "[", 
     RowBox[{"obj", ",", "ops"}], "]"}]}], "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.7168410865473623`*^9, 3.7168411366961527`*^9}, {
   3.7168413740714397`*^9, 3.7168413764695272`*^9}, 3.7218388317902117`*^9, {
   3.7278310023791018`*^9, 
   3.7278310222844067`*^9}},ExpressionUUID->"5be19d83-1535-46e2-9f66-\
6db080e5b176"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]StyleSheetEdit\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.685751282723287*^9, 3.685751283738248*^9}, 
   3.72183883183022*^9},ExpressionUUID->"67aeb2cf-fec2-4427-8e04-\
497200402045"],

Cell[BoxData[
 RowBox[{"StyleSheetEdit", "//", "ClearAll"}]], "CodeInput",
 CellChangeTimes->{{3.7278304685908623`*^9, 
  3.727830470155525*^9}},ExpressionUUID->"09ec8e6e-f548-4550-a6fe-\
9c3db15ad27a"],

Cell[CellGroupData[{

Cell["Cell", "CodeSubsubsubsection",
 CellChangeTimes->{{3.700936367074955*^9, 
  3.700936367528801*^9}},ExpressionUUID->"3a7bcf63-661b-4fef-9b7c-\
f90a37bd2f95"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StyleSheetEdit", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"cellExprs", ":", 
     RowBox[{"_Cell", "|", 
      RowBox[{"{", "__Cell", "}"}]}]}], ",", "\n", "\t", 
    RowBox[{"conf", ":", 
     RowBox[{"_", "?", "OptionQ"}]}]}], "\n", "\t", "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cells", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"{", "cellExprs", "}"}]}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"del", "=", "\n", "\t\t\t", 
        RowBox[{"Alternatives", "@@", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Rule", "|", "RuleDelayed"}], ")"}], "[", 
             RowBox[{
              RowBox[{"First", "@", "#"}], ",", "_"}], "]"}], "&"}], ",", 
           RowBox[{"Flatten", "@", 
            RowBox[{"{", "conf", "}"}]}]}], "]"}]}]}], "\n", "\t\t\t", "}"}], 
      ",", "\n", "\t\t\t", 
      RowBox[{"Table", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"Join", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{"c", ",", "del"}], "]"}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"Cell", "[", "conf", "]"}], "/.", 
           RowBox[{"(", "\n", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"h", ":", 
                RowBox[{"Rule", "|", "RuleDelayed"}]}], ")"}], "[", 
              RowBox[{"k_", ",", "f_Function"}], "]"}], "\[RuleDelayed]", 
             "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"o", "=", 
                 RowBox[{"f", "@", 
                  RowBox[{"(", 
                   RowBox[{"k", "/.", 
                    RowBox[{"Quiet", "@", 
                    RowBox[{"Options", "[", 
                    RowBox[{"c", ",", "k"}], "]"}]}]}], ")"}]}]}], "}"}], ",",
                "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{"h", "[", 
                RowBox[{"k", ",", "o"}], "]"}]}], "\n", "\t\t\t\t\t\t\t\t", 
              "]"}]}], "\n", "\t\t\t\t\t\t", ")"}]}]}], "\n", "\t\t\t\t\t", 
         "]"}], ",", "\n", "\t\t\t\t\t", 
        RowBox[{"{", 
         RowBox[{"c", ",", "cells"}], "}"}]}], "\n", "\t\t\t\t\t", "]"}]}], 
     "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.685749850773196*^9, 3.685750048910705*^9}, {
   3.685750099370521*^9, 3.6857501250136547`*^9}, {3.6857501807283792`*^9, 
   3.685750191581696*^9}, {3.685750249231695*^9, 3.6857502529576283`*^9}, {
   3.6857503189687567`*^9, 3.6857503213990707`*^9}, {3.685752357180606*^9, 
   3.685752417234558*^9}, {3.685752482329145*^9, 3.685752522968533*^9}, {
   3.685752576912087*^9, 3.6857526217559*^9}, {3.7009363437381163`*^9, 
   3.700936362291811*^9}, {3.709206988813155*^9, 3.709207001194128*^9}, {
   3.709207704818809*^9, 3.7092077373321133`*^9}, 
   3.721838831843953*^9},ExpressionUUID->"f477c11a-02b4-4f0c-b907-\
95663469efdc"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cell Object", "CodeSubsubsubsection",
 CellChangeTimes->{{3.700936372003304*^9, 
  3.700936374897277*^9}},ExpressionUUID->"564220ff-b7f0-483e-bf02-\
1c8388a986f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$StyleSheetEditApplyFunctions", "=", "False"}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.729719912885619*^9, 
  3.729719933572015*^9}},ExpressionUUID->"3642c260-d484-454a-857d-\
944b29a76142"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StyleSheetEdit", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"cellObs", ":", 
     RowBox[{"_CellObject", "|", 
      RowBox[{"{", "__CellObject", "}"}]}]}], ",", "\n", "\t", 
    RowBox[{"conf_", "?", "OptionQ"}]}], "\n", "\t", "]"}], ":=", "\n", "\t", 
  
  RowBox[{"frontEndExecuteBlock", "@", "\n", "\t\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cells", "=", 
       RowBox[{"Flatten", "@", 
        RowBox[{"{", "cellObs", "}"}]}]}], "}"}], ",", "\n", "\t", "\t\t", 
     RowBox[{
      RowBox[{"Do", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"With", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"{", "\n", "\t\t\t\t\t\t", 
           RowBox[{"oplist", "=", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
             "$StyleSheetEditApplyFunctions", ",", "\n", "\t", "\t", 
              "\t\t\t\t\t\t", 
              RowBox[{"Table", "[", "\n", "\t", "\t", "\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"MatchQ", "[", 
                   RowBox[{"o", ",", "_Rule"}], "]"}], ",", "\n", "\t", "\t", 
                  "\t", "\t", "\t\t\t\t\t\t", 
                  RowBox[{"With", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"op", "=", 
                    RowBox[{"Options", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"First", "@", "o"}]}], "]"}]}], "}"}], ",", "\n", 
                    "\t", "\t", "\t", "\t", "\t", "\t\t\t\t\t\t", 
                    RowBox[{"Replace", "[", 
                    RowBox[{
                    "op", ",", "\n", "\t", "\t", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "{", "\n", "\t", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k_", "\[Rule]", "v_"}], ",", "___"}], "}"}], 
                    "\[RuleDelayed]", "\n", "\t", "\t", "\t", "\t", "\t", 
                    "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"(", 
                    RowBox[{
                    "k", "->", "\n", "\t", "\t", "\t", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{"Last", "@", "o"}], ",", "\n", "\t", "\t", "\t", 
                    "\t", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"f_Function", ":>", 
                    RowBox[{"(", 
                    RowBox[{"f", "[", 
                    RowBox[{"v", ",", "c"}], "]"}], ")"}]}]}], "]"}]}], "\n", 
                    "\t", "\t", "\t", "\t", "\t", "\t", "\t\t\t\t\t\t\t\t\t", 
                    ")"}]}], ",", "\n", "\t", "\t", "\t", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", "}"}], "\[Rule]", "o"}]}], "\n", "\t", "\t", 
                    "\t", "\t", "\t\t\t\t\t\t\t\t\t", "}"}]}], "\n", "\t", 
                    "\t", "\t", "\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t", 
                   "\t", "\t", "\t\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t", 
                  "\t", "\t", "\t\t\t\t\t\t\t", "o"}], "\n", "\t", "\t", "\t",
                  "\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t", "\t", 
                "\t\t\t\t\t\t\t", 
                RowBox[{"{", 
                 RowBox[{"o", ",", " ", 
                  RowBox[{"Flatten", "@", 
                   RowBox[{"{", "conf", "}"}]}]}], "}"}]}], "\n", "\t", "\t", 
               "\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t", "\t", "\t\t\t\t\t\t", 
              RowBox[{"Flatten", "@", 
               RowBox[{"{", "conf", "}"}]}]}], "\n", "\t", "\t", 
             "\t\t\t\t\t\t", "]"}]}], "\n", "\t", "\t\t\t\t\t", "}"}], ",", 
          "\n", "\t\t\t\t\t", 
          RowBox[{"StyleSheetSetOptions", "[", 
           RowBox[{"c", ",", " ", "oplist"}], "]"}]}], "\n", "\t", "\t\t\t\t",
          "]"}], ",", "\n", "\t\t\t", 
        RowBox[{"{", 
         RowBox[{"c", ",", "cells"}], "}"}]}], "\n", "\t\t\t", "]"}], ";", 
      "\n", "\t\t", 
      RowBox[{"StyleSheetApplyEdits", "@", "cells"}], ";"}]}], "\n", "\t\t", 
    "]"}]}]}]], "CodeInput",
 CellChangeTimes->{{3.685279102832871*^9, 3.685279168644643*^9}, {
   3.685302205846921*^9, 3.685302302340707*^9}, 3.685302982821631*^9, {
   3.696792229345645*^9, 3.696792406584648*^9}, {3.696792460035955*^9, 
   3.696792465347056*^9}, {3.696792631677017*^9, 3.696792663633596*^9}, {
   3.69679269423802*^9, 3.696792697469488*^9}, {3.6967927411949167`*^9, 
   3.696792790456168*^9}, {3.696792820949875*^9, 3.6967928230085583`*^9}, {
   3.696800623852024*^9, 3.696800644837531*^9}, {3.6972530830903378`*^9, 
   3.697253083639333*^9}, 3.700936384731885*^9, {3.709207013595746*^9, 
   3.709207022225964*^9}, {3.716841033535315*^9, 3.716841082802215*^9}, {
   3.7168413811903353`*^9, 3.7168413852406197`*^9}, {3.717027334687436*^9, 
   3.717027342643312*^9}, 3.717027399406714*^9, {3.7218388318504457`*^9, 
   3.7218388318619204`*^9}, {3.727830607045924*^9, 3.7278306280992813`*^9}, {
   3.7278309744318867`*^9, 3.7278309903183727`*^9}, {3.72971994469268*^9, 
   3.7297200322268867`*^9}},ExpressionUUID->"0a548a37-f548-4fee-a925-\
b0b240b2c447"]
}, Closed]],

Cell[CellGroupData[{

Cell["Notebook", "CodeSubsubsubsection",
 CellChangeTimes->{{3.700936386728436*^9, 
  3.7009364144959383`*^9}},ExpressionUUID->"14d16ec2-abfb-4de0-b514-\
771d29cb7d55"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StyleSheetEdit", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"StyleData", "[", 
     RowBox[{"nb", ":", "_NotebookObject"}], "]"}], ",", "\n", "\t", 
    RowBox[{"types", ":", "$StyleSheetCellStylePatterns"}], ",", "\n", "\t", 
    RowBox[{"conf_", "?", "OptionQ"}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"snb", "=", 
      RowBox[{"StyleDefinitions", "/.", 
       RowBox[{"Options", "[", 
        RowBox[{"nb", ",", "StyleDefinitions"}], "]"}]}]}], "}"}], ",", "\n", 
    "\t\t\t", 
    RowBox[{"SetOptions", "[", 
     RowBox[{"nb", ",", "\n", "\t\t\t\t", 
      RowBox[{"StyleDefinitions", "->", 
       RowBox[{"Replace", "[", 
        RowBox[{"snb", ",", 
         RowBox[{"{", "\n", "\t", "\t\t\t\t", 
          RowBox[{
           RowBox[{"_Notebook", "\[RuleDelayed]", "\n", "\t", "\t\t\t\t\t", 
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"n", "=", 
                RowBox[{"NotebookTools`FlattenCellGroups", "@", "snb"}]}], 
               "}"}], ",", "\n", "\t", "\t\t\t\t\t\t", 
              RowBox[{"ReplacePart", "[", 
               RowBox[{"n", ",", "\n", "\t", "\t\t\t\t\t\t\t", 
                RowBox[{"1", "\[Rule]", 
                 RowBox[{"With", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"c", "=", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Replace", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"StyleSheetCells", "[", 
                    RowBox[{"n", ",", "StyleData", ",", "types"}], "]"}], ",",
                     "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"l_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "#"}], "<", 
                    RowBox[{"Length", "@", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", "types", "}"}]}]}]}], "&"}], ")"}]}], 
                    "\[RuleDelayed]", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"stypes", "=", 
                    RowBox[{"First", "/@", 
                    RowBox[{"First", "/@", "l"}]}]}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    "l", ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cell", "[", 
                    RowBox[{"StyleData", "[", "#", "]"}], "]"}], "&"}], "/@", 
                    
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", "types", "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Alternatives", "@@", "stypes"}]}], "]"}]}]}], 
                    "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n",
                     "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t", "]"}]}], "}"}], ",", "\n", 
                   "\t\t\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"Join", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"First", "@", "n"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Alternatives", "@@", 
                    RowBox[{
                    "DeleteDuplicates", "[", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cell", "[", 
                    RowBox[{
                    RowBox[{"StyleData", "[", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"First", "@", "#"}]}], ",", "___"}], "]"}], ",", 
                    "___"}], "]"}], "&"}], "/@", "c"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"StyleSheetEdit", "[", 
                    RowBox[{"c", ",", "conf"}], "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                  "\t\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
               "\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}],
            ",", "\n", "\t\t\t\t\t", 
           RowBox[{"_String", "\[RuleDelayed]", "\n", "\t", "\t\t\t\t\t", 
            RowBox[{"Notebook", "[", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Prepend", "[", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"StyleSheetEdit", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Cell", "[", 
                    RowBox[{"StyleData", "[", "#", "]"}], "]"}], "&"}], "/@", 
                   
                   RowBox[{"Flatten", "@", 
                    RowBox[{"{", "types", "}"}]}]}], ",", "conf"}], "]"}], 
                ",", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{"Cell", "@", 
                 RowBox[{"StyleData", "[", 
                  RowBox[{"StyleDefinitions", "\[Rule]", "snb"}], "]"}]}]}], 
               "\n", "\t", "\t\t\t\t\t\t\t", "]"}], ",", "\n", 
              "\t\t\t\t\t\t\t\t", 
              RowBox[{
              "StyleDefinitions", "\[Rule]", "\n", "\t\t\t\t\t\t\t\t\t", 
               RowBox[{"Notebook", "[", 
                RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"Cell", "[", 
                   RowBox[{"StyleData", "[", 
                    RowBox[{
                    "StyleDefinitions", "->", 
                    "\"\<StylesheetFormatting.nb\>\""}], "]"}], "]"}], ",", 
                  "\n", "\t", "\t", "\t", "\t", "\t\t\t\t\t\t", 
                  RowBox[{"Cell", "[", 
                   RowBox[{
                    RowBox[{"StyleData", "[", "\"\<Notebook\>\"", "]"}], ",", 
                    "\n", "\t", "\t", "\t", "\t", "\t\t\t\t\t\t\t", 
                    RowBox[{"Saveable", "\[Rule]", "True"}], ",", "\n", "\t", 
                    "\t", "\t", "\t", "\t\t\t\t\t\t\t", 
                    RowBox[{"Editable", "\[Rule]", "True"}]}], "\n", "\t", 
                   "\t", "\t", "\t", "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t", 
                 "\t", "\t", "\t", "\t\t\t\t\t\t", "}"}], "]"}]}]}], "\n", 
             "\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t\t\t\t\t", "\n", 
          "\t\t\t\t\t", "}"}]}], "]"}]}]}], "\n", "\t\t\t\t", "]"}]}], "\n", 
   "\t\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.685750370124733*^9, 3.685750655345543*^9}, {
   3.685750703024613*^9, 3.685751138280243*^9}, {3.6857512674145193`*^9, 
   3.68575126755788*^9}, {3.685751307783936*^9, 3.685751453254027*^9}, {
   3.685751505024559*^9, 3.6857516219630203`*^9}, {3.685751692041431*^9, 
   3.6857517303373413`*^9}, {3.685751804106739*^9, 3.68575182609785*^9}, 
   3.685752884838722*^9, 3.685752933468594*^9, {3.685753012838993*^9, 
   3.6857530150336933`*^9}, {3.685753056183839*^9, 3.6857531832378693`*^9}, {
   3.68575346555455*^9, 3.685753496392148*^9}, 3.696792618535261*^9, {
   3.707998429773003*^9, 3.7079984339685583`*^9}, 3.709154508520441*^9, {
   3.70915773398787*^9, 3.709157743348021*^9}, {3.709206971336636*^9, 
   3.709206974614011*^9}, {3.709207684660776*^9, 3.709207699153632*^9}, 
   3.7092096382092*^9, {3.72183883187085*^9, 
   3.7218388319074593`*^9}},ExpressionUUID->"3bf2c019-ab69-4f55-b0ad-\
03acabd42620"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cell Style", "CodeSubsubsubsection",
 CellChangeTimes->{{3.700936405961893*^9, 
  3.700936407616123*^9}},ExpressionUUID->"f96a8b9f-ed86-4470-880b-\
1beff4d9a6da"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "StyleSheetEdit", "]"}], "=", "\n", "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Options", "[", "StyleSheetCells", "]"}], ",", "\n", "\t\t", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{"\"\<ApplyFunctions\>\"", "\[Rule]", "False"}], "\n", "\t\t\t", 
      "}"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetEdit", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"nb", ":", 
      RowBox[{"_NotebookObject", "|", "Automatic"}], ":", "Automatic"}], ",", 
     "\n", "\t", 
     RowBox[{"types", ":", "$StyleSheetCellStylePatterns"}], ",", "\n", "\t", 
     
     RowBox[{"conf_", "?", "OptionQ"}], ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"Block", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{"$StyleSheetEditApplyFunctions", "=", "\n", "\t\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<ApplyFunctions\>\"", "]"}], ",", 
         "\n", "\t\t\t\t", 
         RowBox[{"{", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"Automatic", "\[RuleDelayed]", 
            RowBox[{"Not", "@", 
             RowBox[{"FreeQ", "[", 
              RowBox[{"conf", ",", " ", 
               RowBox[{
                RowBox[{"Verbatim", "[", "Function", "]"}], "[", 
                RowBox[{"___", ",", " ", "_Function", ",", " ", "___"}], 
                "]"}]}], "]"}]}]}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"Except", "[", "True", "]"}], "\[Rule]", "False"}]}], 
          "\n", "\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", 
      "\t\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"With", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t\t", 
        RowBox[{"cells", "=", "\n", "\t\t\t\t\t", 
         RowBox[{"StyleSheetCells", "[", 
          RowBox[{"nb", ",", "types", ",", "\n", "\t\t\t\t\t\t", 
           RowBox[{"FilterRules", "[", 
            RowBox[{
             RowBox[{"{", "ops", "}"}], ",", " ", 
             RowBox[{"Options", "[", "StyleSheetCells", "]"}]}], "]"}]}], 
          "\n", "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "}"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "cells"}], "===", "0"}], ",", "\n", "\t", 
         "\t\t\t", "$Failed", ",", "\n", "\t", "\t\t\t", 
         RowBox[{"StyleSheetEdit", "[", 
          RowBox[{"cells", ",", " ", "conf"}], "]"}]}], "\n", "\t\t\t\t", 
        "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.684513750781829*^9, 3.684513865279707*^9}, {
   3.6845139209971857`*^9, 3.684514103693997*^9}, 3.6845142038180923`*^9, {
   3.684515477120038*^9, 3.684515618956538*^9}, {3.6845157024265347`*^9, 
   3.6845157049291*^9}, {3.684515887296874*^9, 3.684515935579398*^9}, {
   3.684515983135778*^9, 3.684515998206287*^9}, {3.684518444620195*^9, 
   3.684518449882049*^9}, {3.684519256895402*^9, 3.684519284615054*^9}, {
   3.68451989218145*^9, 3.684519902782442*^9}, 3.684519975330834*^9, {
   3.684520033632934*^9, 3.684520061794086*^9}, {3.684523845133006*^9, 
   3.684523851730701*^9}, {3.685278361114366*^9, 3.685278394935299*^9}, {
   3.685278484854739*^9, 3.685278486980225*^9}, {3.6852786472494287`*^9, 
   3.685278681342164*^9}, {3.685279136591345*^9, 3.6852791395520773`*^9}, {
   3.6852791740225782`*^9, 3.6852791767641773`*^9}, {3.685292273192206*^9, 
   3.685292275411919*^9}, {3.685294149927297*^9, 3.685294167899439*^9}, 
   3.6853023194521437`*^9, {3.685302957384286*^9, 3.685302967781941*^9}, {
   3.685303016433022*^9, 3.685303018714733*^9}, {3.685750338187131*^9, 
   3.685750347288743*^9}, {3.6857529044882298`*^9, 3.685752917345357*^9}, {
   3.685752994107193*^9, 3.685752994951926*^9}, {3.696792610963934*^9, 
   3.696792613725325*^9}, {3.7009364241037207`*^9, 3.700936441511945*^9}, {
   3.708702133278921*^9, 3.708702166012583*^9}, {3.7087023139885187`*^9, 
   3.708702321201887*^9}, {3.7092070382426157`*^9, 3.7092070429211397`*^9}, {
   3.709207771198078*^9, 3.709207835329495*^9}, 3.709209629030078*^9, {
   3.709242931240889*^9, 3.709242931421742*^9}, {3.721838831912779*^9, 
   3.7218388319370193`*^9}, {3.7278304165530243`*^9, 3.727830432289278*^9}, {
   3.727830581965128*^9, 3.7278306026636972`*^9}, 3.7278309686851*^9, {
   3.729720047740396*^9, 3.729720091156005*^9}, {3.72972013430752*^9, 
   3.729720239921495*^9}},ExpressionUUID->"fed7b5f7-078c-49c0-a1d5-\
dfe0f6219fed"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]StyleSheetValue\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6871145558467007`*^9, 3.687114556901389*^9}, 
   3.721838831952465*^9},ExpressionUUID->"2157b779-b3a2-4bab-bb9d-\
5d6e9f149836"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$StyleSheetCellOptionPatterns", "=", "\n", "\t", 
   RowBox[{"_String", "|", "_Symbol", "|", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"_String", "|", "_Symbol"}], ")"}], ".."}], "}"}]}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.709212024776425*^9, 3.709212044262308*^9}, 
   3.721838831963949*^9},ExpressionUUID->"2c5eb59f-0dbf-4a55-84df-\
dbd0a27641a0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "StyleSheetValue", "]"}], "=", "\n", "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Options", "[", "StyleSheetCells", "]"}], ",", "\n", "\t\t", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{"\"\<ValueFunction\>\"", "\[Rule]", "CurrentValue"}], "\n", 
      "\t\t\t", "}"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetValue", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"cellOb", ":", 
      RowBox[{"_CellObject", "|", 
       RowBox[{"{", "__CellObject", "}"}]}]}], ",", "\n", "\t", 
     RowBox[{"ops", ":", "$StyleSheetCellOptionPatterns"}], ",", 
     RowBox[{"(*", "\n", "\t", 
      RowBox[{
       RowBox[{"part", ":", 
        RowBox[{"_Integer", "|", 
         RowBox[{"{", 
          RowBox[{"Repeated", "[", 
           RowBox[{"__Integer", ",", "2"}], "]"}], "}"}], "|", "_Span", "|", 
         "All"}], ":", "All"}], ","}], "*)"}], "\n", "\t", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "\n", "\t", "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{"mode", "=", "\n", "\t\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<ValueFunction\>\"", "]"}], ",", 
         RowBox[{"{", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"Automatic", "\[Rule]", "CurrentValue"}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{"\"\<Absolute\>\"", "\[Rule]", "AbsoluteCurrentValue"}]}], 
          "\n", "\t\t\t\t", "}"}]}], "]"}]}], "\n", "\t\t", "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ListQ", "@", "cellOb"}], ",", "\n", "\t", "\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", "cellOb"}], ">", "1"}], ",", "\n", 
          "\t\t\t\t", "Transpose", ",", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "\n", "\t\t\t\t", "]"}], 
        
        RowBox[{"(*", 
         RowBox[{"[", 
          RowBox[{"[", "part", "]"}], "]"}], "*)"}], ",", "\n", "\t\t\t", 
        "Identity"}], "\n", "\t\t\t", "]"}], "@", "\n", "\t\t\t", 
      RowBox[{"Map", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"mode", "[", 
          RowBox[{"cellOb", ",", "#"}], "]"}], "&"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"Flatten", "@", 
         RowBox[{"{", "ops", "}"}]}]}], "\n", "\t\t\t\t", "]"}]}]}], "\n", 
    "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetValue", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"nb", ":", 
      RowBox[{"_NotebookObject", "|", "Automatic"}], ":", "Automatic"}], ",", 
     "\n", "\t", 
     RowBox[{"cellStyle", ":", "$StyleSheetCellStylePatterns"}], ",", "\n", 
     "\t", 
     RowBox[{"op", ":", "$StyleSheetCellOptionPatterns"}], ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cells", "=", "\n", "\t\t", 
       RowBox[{"StyleSheetCells", "[", 
        RowBox[{"nb", ",", "cellStyle", ",", "\n", "\t\t\t", 
         RowBox[{"FilterRules", "[", 
          RowBox[{
           RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t", 
           RowBox[{"Options", "[", "StyleSheetCells", "]"}]}], "\n", 
          "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}], "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{"Replace", "[", 
      RowBox[{"cells", ",", 
       RowBox[{"{", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"c", ":", 
           RowBox[{"{", "__", "}"}]}], "\[RuleDelayed]", "\n", "\t\t\t\t", 
          RowBox[{"StyleSheetValue", "[", 
           RowBox[{"c", ",", "op", ",", "\n", "\t\t\t\t\t", 
            RowBox[{"FilterRules", "[", 
             RowBox[{
              RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{"Options", "[", "StyleSheetCells", "]"}]}], "\n", 
             "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], ",", "\n", 
         "\t\t\t", 
         RowBox[{
          RowBox[{"{", "}"}], "\[RuleDelayed]", "\n", "\t\t\t\t", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", "\n", "\t\t\t\t\t", 
             RowBox[{"mode", "=", "\n", "\t\t\t\t\t\t", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"OptionValue", "[", "\"\<ValueFunction\>\"", "]"}], 
                ",", 
                RowBox[{"{", "\n", "\t", "\t", "\t", "\t\t\t\t", 
                 RowBox[{
                  RowBox[{"Automatic", "\[Rule]", "CurrentValue"}], ",", "\n",
                   "\t", "\t", "\t", "\t\t\t\t", 
                  RowBox[{
                  "\"\<Absolute\>\"", "\[Rule]", "AbsoluteCurrentValue"}]}], 
                 "\n", "\t", "\t", "\t", "\t\t\t\t", "}"}]}], "]"}]}], "\n", 
             "\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"Map", "[", "\n", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"Replace", "[", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"mode", "[", "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"StyleSheetNotebookObject", "@", "nb"}], ",", "\n",
                    "\t", "\t", "\t", "\t\t\t\t\t", 
                   RowBox[{"{", 
                    RowBox[{"StyleDefinitions", ",", "cellStyle", ",", "#"}], 
                    "}"}]}], "\n", "\t", "\t", "\t\t\t\t\t\t", "]"}], ",", 
                 "\n", "\t", "\t", "\t\t\t\t\t", 
                 RowBox[{"$Failed", "\[Rule]", "Inherited"}]}], "\n", "\t", 
                "\t\t\t\t\t\t", "]"}], "&"}], ",", "\n", "\t", "\t\t\t\t\t", 
              RowBox[{"Flatten", "@", 
               RowBox[{"{", "op", "}"}]}]}], "\n", "\t\t\t\t\t\t", "]"}]}], 
           "\n", "\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t", "}"}]}], "]"}]}], 
    "\n", "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6871145602540283`*^9, 3.687114664319791*^9}, {
   3.687114714118828*^9, 3.68711474279661*^9}, {3.6871148503376093`*^9, 
   3.687114994356051*^9}, {3.687115033567273*^9, 3.687115067820266*^9}, {
   3.68935297455447*^9, 3.689352976735837*^9}, {3.700878222933316*^9, 
   3.7008783143440237`*^9}, {3.700878397790983*^9, 3.700878445282933*^9}, {
   3.700878488452969*^9, 3.700878513827626*^9}, {3.7009364711250277`*^9, 
   3.70093648769645*^9}, {3.7020749128464212`*^9, 3.7020750227502413`*^9}, {
   3.709157505278338*^9, 3.709157553526534*^9}, {3.709157593160821*^9, 
   3.7091576489011593`*^9}, {3.7092068671919107`*^9, 3.709206953797163*^9}, {
   3.7092083933001842`*^9, 3.709208685722279*^9}, 3.7092096552863007`*^9, {
   3.709211995979809*^9, 3.709212056548004*^9}, {3.709212092040942*^9, 
   3.709212124584778*^9}, {3.7092378996439257`*^9, 3.7092379005021772`*^9}, {
   3.709237981277556*^9, 3.709237982766129*^9}, {3.7218388319729223`*^9, 
   3.721838832048585*^9}, {3.722989215316689*^9, 3.722989252028513*^9}, {
   3.722989291599531*^9, 3.7229893011291943`*^9}, 
   3.727899370126845*^9},ExpressionUUID->"cff9bea5-ec14-41ae-9e26-\
46b4fc951fae"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]StyleSheetSync\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.700878515680295*^9, 3.700878517953802*^9}, 
   3.721838832064033*^9},ExpressionUUID->"e4c8a7b9-c182-4589-a393-\
f8be4e1039b6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "StyleSheetSync", "]"}], "=", "\n", "\t", 
   RowBox[{
    RowBox[{"DeleteDuplicatesBy", "[", "First", "]"}], "@", "\n", "\t", 
    RowBox[{"Join", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{"Options", "[", "StyleSheetEdit", "]"}], ",", "\n", "\t\t", 
      RowBox[{"Options", "[", "StyleSheetValue", "]"}]}], "\n", "\t\t", 
     "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetSync", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"nb", ":", 
      RowBox[{"_NotebookObject", "|", "Automatic"}], ":", "Automatic"}], ",", 
     "\n", "\t", 
     RowBox[{"toStyle", ":", "$StyleSheetCellStyleSinglePattern"}], ",", "\n",
      "\t", 
     RowBox[{"fromStyle", ":", "$StyleSheetCellStyleSinglePattern"}], ",", 
     "\n", "\t", 
     RowBox[{"op", ":", "$StyleSheetCellOptionPatterns", ":", "Automatic"}], 
     ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"o", "=", "\n", "\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{"op", ",", 
          RowBox[{"Automatic", ":>", "$StyleSheetCellDisplayStyleOptions"}]}],
          "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"c", "=", "\n", "\t\t\t", 
        RowBox[{"StyleSheetCells", "[", 
         RowBox[{"nb", ",", "fromStyle", ",", "\n", "\t\t\t\t", 
          RowBox[{"FilterRules", "[", 
           RowBox[{
            RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"Options", "[", "StyleSheetCells", "]"}]}], "\n", 
           "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}]}]}], "\n", "\t\t", 
      "}"}], ",", "\n", "\t\t", 
     RowBox[{"StyleSheetEdit", "[", 
      RowBox[{"nb", ",", "toStyle", ",", "\n", "\t", "\t\t", 
       RowBox[{"Thread", "[", "\n", "\t\t\t\t", 
        RowBox[{"o", "->", "\n", "\t\t\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "c"}], ">", "0"}], ",", "\t", "\n", 
           "\t\t\t\t\t\t", 
           RowBox[{"StyleSheetValue", "[", 
            RowBox[{
             RowBox[{"First", "@", "c"}], ",", "o", ",", "\n", 
             "\t\t\t\t\t\t\t", 
             RowBox[{"FilterRules", "[", 
              RowBox[{
               RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{"Options", "[", "StyleSheetValue", "]"}]}], "\n", 
              "\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t", "]"}], ",",
            "\n", "\t\t\t\t\t\t", 
           RowBox[{"StyleSheetValue", "[", 
            RowBox[{
            "nb", ",", "\n", "\t", "\t", "\t\t\t\t\t", "fromStyle", ",", "\n",
              "\t", "\t", "\t\t\t\t\t", "o", ",", "\n", "\t", "\t", 
             "\t\t\t\t\t", 
             RowBox[{"FilterRules", "[", 
              RowBox[{
               RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{"Options", "[", "StyleSheetValue", "]"}]}], "\n", 
              "\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}], 
          "\n", "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"Options", "[", "StyleSheetEdit", "]"}]}], "\n", "\t\t\t\t", 
        "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6871145602540283`*^9, 3.687114664319791*^9}, {
   3.687114714118828*^9, 3.68711474279661*^9}, {3.6871148503376093`*^9, 
   3.687114994356051*^9}, {3.687115033567273*^9, 3.687115067820266*^9}, {
   3.68935297455447*^9, 3.689352976735837*^9}, {3.700878222933316*^9, 
   3.7008783143440237`*^9}, {3.700878397790983*^9, 3.700878445282933*^9}, {
   3.700878488452969*^9, 3.700878513827626*^9}, {3.709206848495224*^9, 
   3.709206862830493*^9}, {3.709207397819166*^9, 3.709207437656754*^9}, {
   3.7092074963694153`*^9, 3.709207537735531*^9}, {3.709208710624895*^9, 
   3.709208782168764*^9}, {3.7092096661494617`*^9, 3.7092096795389843`*^9}, 
   3.70921206299625*^9, {3.7092122566377487`*^9, 3.709212416379027*^9}, {
   3.709212459834659*^9, 3.709212462779542*^9}, {3.721838832079233*^9, 
   3.721838832169482*^9}},ExpressionUUID->"b7aef935-a937-4845-aa13-\
3987896ef10d"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]StyleSheetDrop\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.68575128968183*^9, 3.685751290522093*^9}, 
   3.721838832186048*^9},ExpressionUUID->"ce8b42ca-3f0e-4e03-a355-\
fa708f053bf7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StyleSheetDrop", "[", 
   RowBox[{
    RowBox[{"cellObs", ":", 
     RowBox[{"_CellObject", "|", 
      RowBox[{"{", "__CellObject", "}"}]}]}], ",", "ops__"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"StyleSheetEdit", "[", 
   RowBox[{"cellObs", ",", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"{", "ops", "}"}], "\[Rule]", "Inherited"}], "]"}]}]}], 
   "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.685279193350196*^9, 3.685279236210251*^9}, {
   3.685279295546054*^9, 3.685279309552064*^9}, {3.6852797236039143`*^9, 
   3.6852797559368877`*^9}, 3.685302986395711*^9, {3.721838832200399*^9, 
   3.721838832206085*^9}},ExpressionUUID->"6dfa6972-8492-4071-a4d9-\
01437ac35d0d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "StyleSheetDrop", "]"}], "=", "\n", "\t", 
   RowBox[{"Options", "[", "StyleSheetCells", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetDrop", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"nb", ":", 
      RowBox[{"_NotebookObject", "|", "Automatic"}], ":", "Automatic"}], ",", 
     "\n", "\t\t", 
     RowBox[{"types", ":", "$StyleSheetCellStylePatterns", ":", "\"\<*\>\""}],
      ",", "\n", "\t\t", 
     RowBox[{"op", ":", "$StyleSheetCellOptionPatterns"}], ",", "\n", "\t\t", 
     
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t\t", "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{"cells", "=", "\n", "\t\t\t", 
       RowBox[{"StyleSheetCells", "[", 
        RowBox[{"nb", ",", "types", ",", "\n", "\t\t\t\t", 
         RowBox[{"FilterRules", "[", 
          RowBox[{
           RowBox[{"{", "ops", "}"}], ",", 
           RowBox[{"Options", "[", "StyleSheetCells", "]"}]}], "]"}]}], "\n", 
        "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"StyleSheetDrop", "[", 
      RowBox[{"cells", ",", "op", ",", "ops"}], "]"}]}], "\n", "\t\t", 
    "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.684513750781829*^9, 3.684513865279707*^9}, {
   3.6845139209971857`*^9, 3.684514103693997*^9}, 3.6845142038180923`*^9, {
   3.684515477120038*^9, 3.684515618956538*^9}, {3.6845157024265347`*^9, 
   3.6845157049291*^9}, {3.684515887296874*^9, 3.684515935579398*^9}, {
   3.684515983135778*^9, 3.684516097302758*^9}, {3.684516158842311*^9, 
   3.684516240008506*^9}, {3.684516388916144*^9, 3.6845165440746307`*^9}, {
   3.68451986446989*^9, 3.6845198707575703`*^9}, 3.684520066562027*^9, {
   3.6845238568831787`*^9, 3.684523860449984*^9}, {3.685200231602355*^9, 
   3.685200329164497*^9}, {3.685278421762164*^9, 3.685278430055366*^9}, {
   3.6852786877518044`*^9, 3.685278699772694*^9}, {3.685278882681752*^9, 
   3.685278883870255*^9}, {3.685279210470359*^9, 3.685279215490937*^9}, {
   3.6852922798204823`*^9, 3.685292281523724*^9}, {3.6853023278776417`*^9, 
   3.685302355137763*^9}, {3.709207365581352*^9, 3.709207367417144*^9}, {
   3.709207544480928*^9, 3.709207546096486*^9}, {3.709209724947002*^9, 
   3.709209839120544*^9}, 3.7092120672811127`*^9, {3.72183883221352*^9, 
   3.721838832246931*^9}},ExpressionUUID->"8f36554f-44d2-440b-aa16-\
ff85785a546c"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]StyleSheetEditRuleListOption\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.685200374311994*^9, 3.6852003751041813`*^9}, 
   3.700935190615994*^9, 3.7218388322622757`*^9, {3.7229735403801327`*^9, 
   3.722973540720995*^9}},ExpressionUUID->"a793a22c-352f-4b2f-a8ab-\
5e8fe1679da8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"resolveStyleSheetRuleListMergeTag", "[", "e_", "]"}], ":=", 
  "e"}]], "CodeInput",
 CellChangeTimes->{{3.716852105920336*^9, 3.716852108663507*^9}, 
   3.7218388322736797`*^9},ExpressionUUID->"6f76c85a-0f74-4423-b1f6-\
8cdff7af09f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"resolveStyleSheetRuleListMerge", "[", "merge_", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{
   RowBox[{"Normal", "@", "\n", "\t\t", 
    RowBox[{"Merge", "[", 
     RowBox[{"merge", ",", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"resolveStyleSheetRuleListMergeTag", "[", "\n", "\t\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"OptionQ", "[", "#", "]"}], ",", " ", "\n", "\t\t\t\t\t", 
          RowBox[{"resolveStyleSheetRuleListMerge", "[", "#", "]"}], ",", 
          "\n", "\t\t\t\t\t", 
          RowBox[{"Last", "[", "#", "]"}]}], "\n", "\t\t\t\t\t", "]"}], "\n", 
        "\t\t\t\t", "]"}], "&"}]}], "\n", "\t\t\t", "]"}]}], "//.", 
   RowBox[{"{", "\n", "\t\t\t\t", 
    RowBox[{
     RowBox[{
      RowBox[{"HoldPattern", "[", "\n", "\t\t\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{
         "resolveStyleSheetRuleListMergeTag", "[", "\n", "\t\t\t\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{"_", ",", "_", ",", "_"}], "]"}], "\n", "\t\t\t\t\t\t", 
          "]"}], "&"}], "[", 
        RowBox[{"{", 
         RowBox[{"___", ",", "a_"}], "}"}], "]"}], "\n", "\t\t\t\t\t", "]"}], 
      "\[RuleDelayed]", "a"}], ",", "\n", "\t\t\t\t", 
     RowBox[{
      RowBox[{"HoldPattern", "[", "\n", "\t\t\t\t\t", 
       RowBox[{"resolveStyleSheetRuleListMergeTag", "[", "e_", "]"}], "\n", 
       "\t\t\t\t\t", "]"}], "\[RuleDelayed]", "e"}]}], "\n", "\t\t\t\t", 
    "}"}]}]}]], "CodeInput",
 CellChangeTimes->{{3.71684213916889*^9, 3.7168422263706923`*^9}, {
  3.716852096003029*^9, 3.716852149761991*^9}, {3.7168523357019033`*^9, 
  3.716852344131587*^9}, {3.7168524090213137`*^9, 3.7168524108843527`*^9}, {
  3.716852485827093*^9, 3.716852519434862*^9}, {3.716852560845446*^9, 
  3.716852587118569*^9}, {3.716852647514732*^9, 3.716852693896895*^9}, {
  3.716852731549274*^9, 3.716852758342965*^9}, {3.7168528204595547`*^9, 
  3.716852841318749*^9}, {3.721838832279714*^9, 
  3.721838832299155*^9}},ExpressionUUID->"bb3039ad-1781-4657-9d71-\
1b6a3d8ab52b"],

Cell["\<\
\[LeftCeiling]This should really be done in terms of CurrentValue but I didn\
\[CloseCurlyQuote]t think to do it initially, so we\[CloseCurlyQuote]ll run \
with it.\[RightFloor]\
\>", "Text",
 Evaluatable->True,
 CellChangeTimes->{{3.7168420856078653`*^9, 3.716842099566824*^9}, {
  3.716851960044281*^9, 
  3.716851966893095*^9}},ExpressionUUID->"72014688-a00b-45bf-a464-\
cdcefde47f07"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$StyleSheetRuleListOptionPattern", "=", "\n", "\t", 
   RowBox[{"_Rule", "|", "_RuleDelayed", "|", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], ".."}], "}"}]}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.709909292475313*^9, 3.7099093057158127`*^9}, {
   3.709909440389353*^9, 3.7099094428738317`*^9}, 
   3.7218388323035803`*^9},ExpressionUUID->"0b348e1b-ce75-4eb9-8a58-\
92b255d1cba4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "StyleSheetEditRuleListOption", "]"}], "=", "\n", 
   "\t", 
   RowBox[{"Options", "[", "StyleSheetEdit", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetEditRuleListOption", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"obs", ":", 
      RowBox[{
       RowBox[{"{", "__CellObject", "}"}], "|", 
       RowBox[{"{", "__NotebookObject", "}"}]}]}], ",", "\n", "\t", "op_", 
     ",", "\n", "\t", 
     RowBox[{"new", ":", "$StyleSheetRuleListOptionPattern"}]}], "\n", "\t", 
    "]"}], ":=", "\n", "\t", 
   RowBox[{"frontEndExecuteBlock", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Do", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"StyleSheetSetOptions", "[", 
        RowBox[{"ob", ",", "\n", "\t\t\t\t", 
         RowBox[{"op", "\[Rule]", "\n", "\t\t\t\t\t", 
          RowBox[{"resolveStyleSheetRuleListMerge", "@", "\n", "\t\t\t\t\t\t", 
           RowBox[{"Flatten", "@", 
            RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"op", "/.", 
                 RowBox[{"Options", "[", 
                  RowBox[{"ob", ",", "op"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"Except", "[", "_List", "]"}], ":>", 
                 RowBox[{"{", "}"}]}]}], "]"}], ",", "\n", "\t", 
              "\t\t\t\t\t\t", "new"}], "\n", "\t\t\t\t\t\t\t", "}"}]}]}]}]}], 
        "\n", "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
       RowBox[{"{", 
        RowBox[{"ob", ",", "obs"}], "}"}]}], "\n", "\t\t\t", "]"}], ";", "\n",
      "\t\t", 
     RowBox[{"StyleSheetApplyEdits", "[", "obs", "]"}], ";"}], "\n", "\t\t", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetEditRuleListOption", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"nb", ":", 
      RowBox[{"_NotebookObject", "|", "Automatic"}], ":", "Automatic"}], ",", 
     "\n", "\t", "cellStyles_", ",", "\n", "\t", "op_", ",", "\n", "\t", 
     RowBox[{"events", ":", "$StyleSheetRuleListOptionPattern"}], ",", "\n", 
     "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"Replace", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"StyleSheetCells", "[", 
      RowBox[{"nb", ",", "cellStyles", ",", "\n", "\t\t\t", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"{", "ops", "}"}], ",", 
         RowBox[{"Options", "[", "StyleSheetCells", "]"}]}], "]"}]}], "\n", 
      "\t\t\t", "]"}], ",", 
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"c", ":", 
         RowBox[{"{", "__", "}"}]}], ":>", "\n", "\t\t\t", 
        RowBox[{"StyleSheetEditRuleListOption", "[", 
         RowBox[{"c", ",", "op", ",", "events"}], "]"}]}], ",", "\n", "\t\t", 
       
       RowBox[{"_", "\[Rule]", "Null"}]}], "\n", "\t\t", "}"}]}], "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.68520038969985*^9, 3.685200475277796*^9}, {
  3.6852005955162687`*^9, 3.6852005966260777`*^9}, {3.68521837025504*^9, 
  3.685218372046825*^9}, {3.68521842262339*^9, 3.685218449194787*^9}, {
  3.685218559026462*^9, 3.6852185646467457`*^9}, {3.685282246352953*^9, 
  3.685282304436244*^9}, {3.685293442120882*^9, 3.685293446757463*^9}, {
  3.697398023751872*^9, 3.6973980274480963`*^9}, {3.697398190266614*^9, 
  3.697398251937668*^9}, {3.700934296034213*^9, 3.700934356152481*^9}, {
  3.700934389538144*^9, 3.700934475464533*^9}, {3.700934841600814*^9, 
  3.700934888570477*^9}, {3.7092088047778378`*^9, 3.709208913436599*^9}, {
  3.709909312197165*^9, 3.709909318852619*^9}, {3.716841809192355*^9, 
  3.716841826324914*^9}, {3.7168421269684362`*^9, 3.716842130042039*^9}, {
  3.716842235567719*^9, 3.716842283121003*^9}, {3.7218388323092203`*^9, 
  3.721838832369183*^9}},ExpressionUUID->"aec6face-3f74-4743-b97c-\
b437334175a9"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]StyleSheetEditEvents\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{3.7009351949190493`*^9, 
  3.721838832389567*^9},ExpressionUUID->"3098a6f2-746f-4fa0-8775-\
488e7d21afc8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "StyleSheetEditEvents", "]"}], "=", "\n", "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Options", "[", "StyleSheetEditRuleListOption", "]"}], ",", "\n",
      "\t\t", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{"\"\<EditOption\>\"", "->", "Automatic"}], "\n", "\t\t\t", 
      "}"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetEditEvents", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"nb", ":", 
      RowBox[{"(", 
       RowBox[{"_NotebookObject", "|", "_CellObject", "|", 
        RowBox[{"{", "__CellObject", "}"}], "|", "Automatic"}], ")"}], ":", 
      "Automatic"}], ",", "\n", "\t", 
     RowBox[{"events", ":", "$StyleSheetRuleListOptionPattern"}], ",", "\n", 
     "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{"op", "=", "\n", "\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<EditOption\>\"", "]"}], ",", "\n", 
         "\t\t\t", 
         RowBox[{
          RowBox[{"Except", "[", 
           RowBox[{
           "CellEventActions", "|", "NotebookEventActions", "|", 
            "Automatic"}], "]"}], "\[Rule]", "Automatic"}]}], "\n", "\t\t\t", 
        "]"}]}], "\n", "\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"obop", "=", "\n", "\t", "\t\t", 
         RowBox[{"Replace", "[", 
          RowBox[{"nb", ",", 
           RowBox[{"{", "\n", "\t", "\t\t\t", 
            RowBox[{
             RowBox[{"Automatic", "\[RuleDelayed]", "\n", "\t\t\t\t\t", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"StyleSheetNotebookObject", "[", "nb", "]"}], ",", 
                "\n", "\t", "\t\t\t\t\t", 
                RowBox[{"Replace", "[", 
                 RowBox[{"op", ",", 
                  RowBox[{"Automatic", ":>", "NotebookEventActions"}]}], 
                 "]"}]}], "\n", "\t", "\t\t\t\t\t", "}"}]}], ",", "\n", "\t", 
             "\t\t\t", 
             RowBox[{
              RowBox[{"_CellObject", "|", 
               RowBox[{"{", "__CellObject", "}"}]}], "\[RuleDelayed]", "\n", 
              "\t", "\t\t\t\t", 
              RowBox[{"{", 
               RowBox[{"nb", ",", "\n", "\t", "\t\t\t\t\t", 
                RowBox[{"Replace", "[", 
                 RowBox[{"op", ",", 
                  RowBox[{
                  "Automatic", "\[RuleDelayed]", "CellEventActions"}]}], 
                 "]"}]}], "\n", "\t", "\t\t\t\t\t", "}"}]}], ",", "\n", "\t", 
             "\t\t\t", 
             RowBox[{"_NotebookObject", ":>", "\n", "\t", "\t\t\t\t", 
              RowBox[{"{", 
               RowBox[{"nb", ",", "\n", "\t", "\t\t\t\t\t", 
                RowBox[{"Replace", "[", 
                 RowBox[{"op", ",", 
                  RowBox[{
                  "Automatic", "\[RuleDelayed]", "NotebookEventActions"}]}], 
                 "]"}]}], "\n", "\t", "\t\t\t\t\t", "}"}]}]}], "\n", "\t", 
            "\t\t\t", "}"}]}], "]"}]}], "}"}], ",", "\n", "\t\t\t", 
       RowBox[{"StyleSheetEditRuleListOption", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"Flatten", "@", 
          RowBox[{"{", 
           RowBox[{"First", "@", "obop"}], "}"}]}], ",", "\n", "\t", "\t\t\t", 
         RowBox[{"Last", "@", "obop"}], ",", "\n", "\t", "\t\t\t", "events", 
         ",", "\n", "\t\t\t\t", "ops"}], "\n", "\t\t\t\t", "]"}]}], "\n", 
      "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetEditEvents", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"nb", ":", 
      RowBox[{"_NotebookObject", "|", "Automatic"}], ":", "Automatic"}], ",", 
     "\n", "\t", 
     RowBox[{"cellStyles", ":", "$StyleSheetCellStylePatterns"}], ",", "\n", 
     "\t", 
     RowBox[{"events", ":", "$StyleSheetRuleListOptionPattern"}], ",", "\n", 
     "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"Replace", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"StyleSheetCells", "[", 
      RowBox[{"nb", ",", "cellStyles", ",", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"{", "ops", "}"}], ",", 
         RowBox[{"Options", "[", "StyleSheetCells", "]"}]}], "]"}]}], "]"}], 
     ",", 
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"c", ":", 
         RowBox[{"{", "__", "}"}]}], ":>", "\n", "\t\t\t", 
        RowBox[{"StyleSheetEditEvents", "[", 
         RowBox[{"c", ",", "events", ",", "ops"}], "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"_", "\[Rule]", "Null"}]}], "\n", "\t\t", "}"}]}], "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.685100221511146*^9, 3.685100228790572*^9}, {
   3.6851003070792007`*^9, 3.685100343093192*^9}, {3.685200481854804*^9, 
   3.685200527877287*^9}, {3.685200563652255*^9, 3.685200591533187*^9}, {
   3.685200649938992*^9, 3.685200801132135*^9}, 3.685282307215206*^9, 
   3.6973981192067003`*^9, {3.699985649605476*^9, 3.699985657380233*^9}, {
   3.700934202963316*^9, 3.700934217151668*^9}, {3.700934262399695*^9, 
   3.700934283093996*^9}, {3.700934341847385*^9, 3.700934371913062*^9}, {
   3.70093442158778*^9, 3.7009344257784653`*^9}, {3.700934596760236*^9, 
   3.7009346367702637`*^9}, {3.7009346719598093`*^9, 3.700934798319211*^9}, 
   3.700934900033956*^9, 3.700935073346648*^9, {3.7009365100537987`*^9, 
   3.7009365192492847`*^9}, {3.709208934751686*^9, 3.709209148062879*^9}, {
   3.709209559686002*^9, 3.709209562243951*^9}, {3.7092118339083223`*^9, 
   3.709211835067986*^9}, 3.709211869204423*^9, {3.709909321750696*^9, 
   3.709909327268217*^9}, {3.7218388324111032`*^9, 3.7218388324773207`*^9}, 
   3.727899370140449*^9},ExpressionUUID->"818891a3-4b0e-4d6c-9686-\
2de601fc2ee9"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]StyleSheetEditAliases\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.700935200588537*^9, 3.700935203167644*^9}, 
   3.721838832496833*^9},ExpressionUUID->"f5c7b007-262f-4a95-8b90-\
9c0c2532f891"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "StyleSheetEditAliases", "]"}], "=", "\n", "\t", 
   RowBox[{"Options", "[", "StyleSheetEditRuleListOption", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetEditAliases", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"nb", ":", 
      RowBox[{"(", 
       RowBox[{"_NotebookObject", "|", "_CellObject", "|", 
        RowBox[{"{", "__CellObject", "}"}], "|", "Automatic"}], ")"}], ":", 
      "Automatic"}], ",", "\n", "\t", 
     RowBox[{"events", ":", "$StyleSheetRuleListOptionPattern"}], ",", "\n", 
     "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"obop", "=", "\n", "\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{"nb", ",", 
         RowBox[{"{", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{"Automatic", "\[RuleDelayed]", "\n", "\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"StyleSheetNotebookObject", "[", "nb", "]"}], ",", "\n",
               "\t\t\t\t\t", "InputAliases"}], "\n", "\t\t\t\t\t", "}"}]}], 
           ",", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{"_CellObject", "|", 
             RowBox[{"{", "__CellObject", "}"}]}], "\[RuleDelayed]", "\n", 
            "\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{"nb", ",", "\n", "\t\t\t\t\t", "InputAliases"}], "\n", 
             "\t\t\t\t\t", "}"}]}], ",", "\n", "\t\t\t", 
           RowBox[{"_NotebookObject", ":>", "\n", "\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{"nb", ",", "\n", "\t\t\t\t\t", "InputAliases"}], "\n", 
             "\t\t\t\t\t", "}"}]}]}], "\n", "\t\t\t", "}"}]}], "]"}]}], "}"}],
      ",", "\n", "\t\t", 
     RowBox[{"StyleSheetEditRuleListOption", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Flatten", "@", 
        RowBox[{"{", 
         RowBox[{"First", "@", "obop"}], "}"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"Last", "@", "obop"}], ",", "\n", "\t\t\t", "events", ",", 
       "\n", "\t\t\t", "ops"}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetEditAliases", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"nb", ":", 
      RowBox[{"_NotebookObject", "|", "Automatic"}], ":", "Automatic"}], ",", 
     "\n", "\t", 
     RowBox[{"cellStyles", ":", "$StyleSheetCellStylePatterns"}], ",", "\n", 
     "\t", 
     RowBox[{"events", ":", "$StyleSheetEventPatterns"}], ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"Replace", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"StyleSheetCells", "[", 
      RowBox[{"nb", ",", "cellStyles", ",", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"{", "ops", "}"}], ",", 
         RowBox[{"Options", "[", "StyleSheetCells", "]"}]}], "]"}]}], "]"}], 
     ",", 
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"c", ":", 
         RowBox[{"{", "__", "}"}]}], ":>", "\n", "\t\t\t", 
        RowBox[{"StyleSheetEditAliases", "[", 
         RowBox[{"c", ",", "events", ",", "ops"}], "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"_", "\[Rule]", "Null"}]}], "\n", "\t\t", "}"}]}], "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6851001632024384`*^9, 3.685100204490952*^9}, {
   3.685100235102654*^9, 3.685100267200452*^9}, {3.685200607572019*^9, 
   3.685200639875247*^9}, {3.685282291829878*^9, 3.685282308191*^9}, 
   3.697398064194062*^9, {3.700934805217244*^9, 3.70093480536661*^9}, {
   3.7009349032965727`*^9, 3.700934976322691*^9}, 3.7009350662637672`*^9, {
   3.700936529011579*^9, 3.70093656243999*^9}, {3.7092091655832148`*^9, 
   3.709209267586116*^9}, 3.709209423425518*^9, {3.709209543174777*^9, 
   3.709209545612904*^9}, 3.709209581876604*^9, {3.709211876077516*^9, 
   3.709211877170369*^9}, {3.7099092780858793`*^9, 3.709909285812018*^9}, {
   3.709909329677045*^9, 3.709909331036985*^9}, {3.721838832510407*^9, 
   3.721838832567737*^9}, 
   3.727899370150144*^9},ExpressionUUID->"c685af3a-6bff-4196-9c39-\
50a01b15971c"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]StyleSheetEditAutoReplacements\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.700935213481365*^9, 3.700935220377287*^9}, 
   3.7009353048058968`*^9, 3.709209431248351*^9, 
   3.72183883258226*^9},ExpressionUUID->"49b086a7-11ac-416d-a79b-\
1ad11f7f013b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "StyleSheetEditAutoReplacements", "]"}], "=", "\n",
    "\t", 
   RowBox[{"Options", "[", "StyleSheetEditRuleListOption", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetEditAutoReplacements", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"nb", ":", 
      RowBox[{"(", 
       RowBox[{"_NotebookObject", "|", "_CellObject", "|", 
        RowBox[{"{", "__CellObject", "}"}], "|", "Automatic"}], ")"}], ":", 
      "Automatic"}], ",", "\n", "\t", 
     RowBox[{"events", ":", "$StyleSheetRuleListOptionPattern"}], ",", "\n", 
     "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"obop", "=", "\n", "\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{"nb", ",", 
         RowBox[{"{", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{"Automatic", "\[RuleDelayed]", "\n", "\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"StyleSheetNotebookObject", "[", "nb", "]"}], ",", "\n",
               "\t\t\t\t\t", "InputAutoReplacements"}], "\n", "\t\t\t\t\t", 
             "}"}]}], ",", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{"_CellObject", "|", 
             RowBox[{"{", "__CellObject", "}"}]}], "\[RuleDelayed]", "\n", 
            "\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{"nb", ",", "\n", "\t\t\t\t\t", "InputAutoReplacements"}],
              "\n", "\t\t\t\t\t", "}"}]}], ",", "\n", "\t\t\t", 
           RowBox[{"_NotebookObject", ":>", "\n", "\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{"nb", ",", "\n", "\t\t\t\t\t", "InputAutoReplacements"}],
              "\n", "\t\t\t\t\t", "}"}]}]}], "\n", "\t\t\t", "}"}]}], "]"}]}],
       "}"}], ",", "\n", "\t\t", 
     RowBox[{"StyleSheetEditRuleListOption", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Flatten", "@", 
        RowBox[{"{", 
         RowBox[{"First", "@", "obop"}], "}"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"Last", "@", "obop"}], ",", "\n", "\t\t\t", "events", ",", 
       "\n", "\t\t\t", "ops"}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetEditAutoReplacements", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"nb", ":", 
      RowBox[{"_NotebookObject", "|", "Automatic"}], ":", "Automatic"}], ",", 
     "\n", "\t", 
     RowBox[{"cellStyles", ":", "$StyleSheetCellStylePatterns"}], ",", "\n", 
     "\t", 
     RowBox[{"events", ":", "$StyleSheetRuleListOptionPattern"}], ",", "\n", 
     "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"Replace", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"StyleSheetCells", "[", 
      RowBox[{"nb", ",", "cellStyles", ",", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"{", "ops", "}"}], ",", 
         RowBox[{"Options", "[", "StyleSheetCells", "]"}]}], "]"}]}], "]"}], 
     ",", 
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"c", ":", 
         RowBox[{"{", "__", "}"}]}], ":>", "\n", "\t\t\t", 
        RowBox[{"StyleSheetEditAutoReplacements", "[", 
         RowBox[{"c", ",", "events", ",", "ops"}], "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"_", "\[Rule]", "Null"}]}], "\n", "\t\t", "}"}]}], "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6851001632024384`*^9, 3.685100204490952*^9}, {
   3.685100235102654*^9, 3.685100267200452*^9}, {3.685200607572019*^9, 
   3.685200639875247*^9}, {3.685282291829878*^9, 3.685282308191*^9}, 
   3.697398064194062*^9, {3.700934805217244*^9, 3.70093480536661*^9}, {
   3.7009349032965727`*^9, 3.700934976322691*^9}, 3.7009350662637672`*^9, {
   3.700935222561659*^9, 3.700935237365438*^9}, {3.700935307192473*^9, 
   3.7009353104795628`*^9}, {3.700936551652482*^9, 3.700936558910853*^9}, {
   3.709209304443899*^9, 3.709209431218087*^9}, {3.709209522639909*^9, 
   3.7092095317162123`*^9}, 3.709211883790885*^9, {3.709909253375564*^9, 
   3.709909269164212*^9}, {3.709909336220739*^9, 3.709909340236081*^9}, {
   3.721838832595148*^9, 3.721838832654108*^9}, 
   3.727899370159937*^9},ExpressionUUID->"7b8fe57f-d110-4839-b2c0-\
d959bc6403de"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]StyleSheetEditTaggingRules\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.700935213481365*^9, 3.700935220377287*^9}, 
   3.7009353048058968`*^9, 3.709209431248351*^9, {3.71684230492148*^9, 
   3.716842306671925*^9}, 
   3.7218388326696367`*^9},ExpressionUUID->"658c6a6e-80b5-4404-926f-\
419ac36fbc80"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "StyleSheetEditTaggingRules", "]"}], "=", "\n", 
   "\t", 
   RowBox[{"Options", "[", "StyleSheetEditRuleListOption", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetEditTaggingRules", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"nb", ":", 
      RowBox[{"(", 
       RowBox[{"_NotebookObject", "|", "_CellObject", "|", 
        RowBox[{"{", "__CellObject", "}"}], "|", "Automatic"}], ")"}], ":", 
      "Automatic"}], ",", "\n", "\t", 
     RowBox[{"events", ":", "$StyleSheetRuleListOptionPattern"}], ",", "\n", 
     "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"obop", "=", "\n", "\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{"nb", ",", 
         RowBox[{"{", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{"Automatic", "\[RuleDelayed]", "\n", "\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"StyleSheetNotebookObject", "[", "nb", "]"}], ",", "\n",
               "\t\t\t\t\t", "TaggingRules"}], "\n", "\t\t\t\t\t", "}"}]}], 
           ",", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{"_CellObject", "|", 
             RowBox[{"{", "__CellObject", "}"}]}], "\[RuleDelayed]", "\n", 
            "\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{"nb", ",", "\n", "\t\t\t\t\t", "TaggingRules"}], "\n", 
             "\t\t\t\t\t", "}"}]}], ",", "\n", "\t\t\t", 
           RowBox[{"_NotebookObject", ":>", "\n", "\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{"nb", ",", "\n", "\t\t\t\t\t", "TaggingRules"}], "\n", 
             "\t\t\t\t\t", "}"}]}]}], "\n", "\t\t\t", "}"}]}], "]"}]}], "}"}],
      ",", "\n", "\t\t", 
     RowBox[{"StyleSheetEditRuleListOption", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Flatten", "@", 
        RowBox[{"{", 
         RowBox[{"First", "@", "obop"}], "}"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"Last", "@", "obop"}], ",", "\n", "\t\t\t", "events", ",", 
       "\n", "\t\t\t", "ops"}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StyleSheetEditTaggingRules", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"nb", ":", 
      RowBox[{"_NotebookObject", "|", "Automatic"}], ":", "Automatic"}], ",", 
     "\n", "\t", 
     RowBox[{"cellStyles", ":", "$StyleSheetCellStylePatterns"}], ",", "\n", 
     "\t", 
     RowBox[{"events", ":", "$StyleSheetRuleListOptionPattern"}], ",", "\n", 
     "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"Replace", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"StyleSheetCells", "[", 
      RowBox[{"nb", ",", "cellStyles", ",", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"{", "ops", "}"}], ",", 
         RowBox[{"Options", "[", "StyleSheetCells", "]"}]}], "]"}]}], "]"}], 
     ",", 
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"c", ":", 
         RowBox[{"{", "__", "}"}]}], ":>", "\n", "\t\t\t", 
        RowBox[{"StyleSheetEditTaggingRules", "[", 
         RowBox[{"c", ",", "events", ",", "ops"}], "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"_", "\[Rule]", "Null"}]}], "\n", "\t\t", "}"}]}], "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6851001632024384`*^9, 3.685100204490952*^9}, {
   3.685100235102654*^9, 3.685100267200452*^9}, {3.685200607572019*^9, 
   3.685200639875247*^9}, {3.685282291829878*^9, 3.685282308191*^9}, 
   3.697398064194062*^9, {3.700934805217244*^9, 3.70093480536661*^9}, {
   3.7009349032965727`*^9, 3.700934976322691*^9}, 3.7009350662637672`*^9, {
   3.700935222561659*^9, 3.700935237365438*^9}, {3.700935307192473*^9, 
   3.7009353104795628`*^9}, {3.700936551652482*^9, 3.700936558910853*^9}, {
   3.709209304443899*^9, 3.709209431218087*^9}, {3.709209522639909*^9, 
   3.7092095317162123`*^9}, 3.709211883790885*^9, {3.709909253375564*^9, 
   3.709909269164212*^9}, {3.709909336220739*^9, 3.709909340236081*^9}, {
   3.7168423117355623`*^9, 3.7168423559555264`*^9}, {3.721838832682345*^9, 
   3.7218388327441883`*^9}, 
   3.727899370169783*^9},ExpressionUUID->"e7dac99b-1bf9-4691-8fcf-\
afeb86f2e7dd"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Autocompletions\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7297202623822203`*^9, 
  3.7297202671006527`*^9}},ExpressionUUID->"64af8ed3-9ec6-4c4c-8251-\
4b7e7a297b72"],

Cell[BoxData[
 RowBox[{"PackageAddAutocompletions", "@", "\n", "\t", 
  RowBox[{"Map", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "\[Rule]", 
      RowBox[{"{", "Style", "}"}]}], "&"}], ",", "\n", "\t\t", 
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{
     "\"\<StyleSheetEdit\>\"", ",", "\n", "\t\t\t", "\"\<StyleSheetNew\>\"", 
      ",", "\n", "\t\t\t", "\"\<StyleSheetCells\>\""}], "\n", "\t\t\t", 
     "}"}]}], "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.72913998155599*^9, 3.729139991787788*^9}, {
   3.729140846612211*^9, 3.729140923308486*^9}, {3.729720277908183*^9, 
   3.729720296702794*^9}, 
   3.729720493122342*^9},ExpressionUUID->"733d0c76-bbbd-4df2-ac93-\
7510eabee0a2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Style Stuff\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.729626872395348*^9, 
  3.729626876995303*^9}},ExpressionUUID->"eb0e78a6-bf01-4c7e-b915-\
ea9fe5066801"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StyleDefinitionsValue", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"bobj", ":", "\n", "\t\t", 
     RowBox[{
     "$FrontEndSession", "|", "_FrontEndObject", "|", "_NotebookObject", "|", 
      "_CellObject", "|", "\n", "\t\t\t", "_BoxObject", "|", 
      "_FrontEnd`EvaluationNotebook", "|", "_FrontEnd`InputNotebook", "|", 
      "\n", "\t\t\t", "_FrontEnd`EvaluationCell", "|", 
      "_FrontEnd`EvaluationBox", "|", "_FrontEnd`Self", "|", "\n", "\t\t\t", 
      "_FrontEnd`ButtonNotebook", "|", "_FrontEnd`MessagesNotebook", "|", 
      "\n", "\t\t\t", "_FrontEnd`ClipboardNotebook", "|", "Automatic"}], ":", 
     "Automatic"}], ",", " ", "\n", "\t", 
    RowBox[{"styles", ":", 
     RowBox[{"All", "|", "_StringPattern`StringPatternQ"}], ":", 
     "\"\<*\>\""}], ",", " ", "\n", "\t", "attr_"}], "\n", "\t", "]"}], ":=", 
  "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"obj", "=", 
      RowBox[{"Replace", "[", 
       RowBox[{"bobj", ",", " ", 
        RowBox[{"Automatic", "\[RuleDelayed]", 
         RowBox[{"InputNotebook", "[", "]"}]}]}], "]"}]}], "}"}], ",", "\n", 
    "\t\t", 
    RowBox[{"With", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t\t\t", 
       RowBox[{"stills", "=", "\n", "\t\t\t\t\t", 
        RowBox[{"Select", "[", "\n", "\t\t\t\t\t\t", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Values", "@", 
             RowBox[{"FE`Evaluate", "@", 
              RowBox[{"FEPrivate`GetPopupList", "[", 
               RowBox[{"obj", ",", " ", "\"\<MenuListStyles\>\""}], "]"}]}]}],
             ",", "\n", "\t\t\t\t\t\t\t", "StringQ"}], "\n", "\t\t\t\t\t\t\t",
            "]"}], ",", "\n", "\t\t\t\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"styles", "===", "All"}], ",", " ", 
            RowBox[{"True", "&"}], ",", " ", 
            RowBox[{"StringMatchQ", "[", "styles", "]"}]}], "]"}]}], "\n", 
         "\t\t\t\t\t\t", "]"}]}], "}"}], ",", "\n", "\t", "\t\t", 
      RowBox[{"AssociationMap", "[", "\n", "\t", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"CurrentValue", "[", 
          RowBox[{"obj", ",", " ", 
           RowBox[{"{", 
            RowBox[{"StyleDefinitions", ",", " ", "#", ",", " ", "attr"}], 
            "}"}]}], "]"}], "&"}], ",", "\n", "\t", "\t\t\t", "stills"}], 
       "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
   "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.72962687763727*^9, 3.729627203965477*^9}, {
  3.729627300902748*^9, 3.729627345569438*^9}, {3.7296273761161747`*^9, 
  3.729627379176978*^9}},ExpressionUUID->"8d890d59-2f53-43d1-85a1-\
b7ccc590e98e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"62979cd9-27e9-4a4d-a752-\
7c1f6565ac32"]
}, Open  ]],

Cell["", "SectionSeparator",ExpressionUUID->"f6246742-626a-4435-bd5f-\
dc169d9a9b37"]
},
WindowSize->{808, 852},
WindowMargins->{{Automatic, 227}, {Automatic, 0}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->FrontEnd`FileName[{"BTools"}, "CodePackage.nb", 
  CharacterEncoding -> "UTF-8"]
]

