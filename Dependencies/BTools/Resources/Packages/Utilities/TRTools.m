(* ::Package:: *)

(* Autogenerated Package *)

$FrontEndDirectory::usage=
  "The root internal front end directory";


$FEResourceGroups::usage="The resource sets I know about";
FEResourceKeys::usage=
  "Extracts keys from resource file";
FEResourceFind::usage=
  "Tries to find resources by that name in the known resources sets";
FEResourceGroup::usage=
  "Goes from a resource name to the groups that include it";
FEResourceBrowse::usage="Browses front end resources found by FEResourceFind";
FEFormatResource::usage="Applies standard formatting rules to a resource";


$FEResourceDirectory::usage=
  "The base directory for FE resources";
$FEResourceFiles::usage=
  "The .tr files in the base directory";


FEAddResource::usage=
  "Adds a FE resource";
FELoadResources::usage=
  "Loads all FE resources";


$FEKeyEventsDirectory::usage=
  "The directory the KeyEventTranslations.tr file dumps to";
$FEKeyEvents::usage=
  "The listing of keyboard events";
FEKeyEventAdd::usage=
  "Adds key events";
FEKeyEventDrop::usage=
  "Drops key events";
FEResetKeyEvents::usage=
  "Resets the key events";


$FEMenuSetupDirectory::usage=
  "The directory the MenuSetup.tr file dumps to";
$FEMenuSetup::usage=
  "The association of menu items";
FEMenuSetupAdd::usage=
  "Adds to the MenuSetup.tr file";
FEMenuSetupDrop::usage=
  "Drops from the MenuSetup.tr file";
FEMenuSetupGet::usage=
  "Gets stuff from the MenuSetup.tr file";
FEResetMenuSetup::usage=
  "Resets the MenuSetup.tr file";


Begin["`Private`"];


Begin["System`"];
ToExpression@{
  "HelpMenu","AlternateItems","LinkedItems",
  "MenuKey","Modifiers","MenuAnchor",
  "RemoveMask","Scope"
  };
End[];


(* ::Subsubsection::Closed:: *)
(*FEResources*)



FEResourceKeys[tr_String?FileExistsQ]:=
  StringCases[Import[tr, "Text"],
    Shortest[StartOfLine~~"@@resource"~~r__~~EndOfLine]:>
    Replace[StringSplit[StringTrim[r]], {l_}:>l]
    ];


FEResourceKeys[s_String]:=
  With[
    {
      r=
        FEResourceKeys@
          FEFindFileOnPath[s, "TextResource"]
      },
    r/;ListQ@r
    ]


$FEResourceCompleteListing={
  "aboutBoxMenuItemString","aboutBoxStringNum",
  "AccessDenied","actionNoteStringTable",
  "ActivationDialog","AlignBothString",
  "AlignCenterString","AlignLeftString",
  "AlignmentString","AlignRightString",
  "allAutomaticFitStringTable","allAutomaticStringTable",
  "AllFilesString","allNoneAutomaticStringTable",
  "allowedDimensionsStringTable","AlphabeticallyString",
  "AlphabeticalOnlyOptionsCategory","alwaysButtonText",
  "alwaysButtonTextWithMnemonic","AnimationCategory",
  "animationCountStringTable","animationDirectionStringTable",
  "animatorElementsStringTable","anotherClientRequestingFileOpen",
  "appearanceManagerRequiredError","appearanceSizeStringTable",
  "appearanceStateStringTable","ApplyString",
  "askCantStartRefSystem","askDeleteStaleRefs",
  "askIfAbortCloudTasks","askIfConvertToNotebook",
  "askIfDeleteSessionDumpFile","askIfRemoveQuotedPrefix",
  "askIfRenderClipboardData","askInitStringNumA",
  "askInitStringNumB","askStartRefSystem",
  "AssertFailedBoxExpression","AssertFailedErrorString",
  "AssertFailedHyperlink","AssertInformationFailedBoxExpression",
  "AssertInformationFailedHyperlink","associatedEvaluationString",
  "AsTextString","automaticFullStringTable",
  "automaticInfinityStringTable","AutomaticNumberingCategory",
  "AutoStyleOptionsCategory","autoStyleReasonAutoItalicWords",
  "autoStyleReasonAutoStyleWords","autoStyleReasonComment",
  "autoStyleReasonExcessArgument","autoStyleReasonFirstRedColoring",
  "autoStyleReasonFunctionLocalVariable","autoStyleReasonGlobalSymbol",
  "autoStyleReasonGlobalToLocalScopeConflict","autoStyleReasonGraphicsCompatibilityProblem",
  "autoStyleReasonGreekStyle","autoStyleReasonLastRedColoring",
  "autoStyleReasonLocalScopeConflict","autoStyleReasonLocalVariable",
  "autoStyleReasonLowerCaseStyle","autoStyleReasonMissingArgument",
  "autoStyleReasonMisspelledWord","autoStyleReasonMultiLetterItalics",
  "autoStyleReasonMultiLetterStyle","autoStyleReasonNoKernelPresent",
  "autoStyleReasonNotebookVariable","autoStyleReasonOrderOfEvaluationConflict",
  "autoStyleReasonPatternVariable","autoStyleReasonSingleLetterItalics",
  "autoStyleReasonSingleLetterStyle","autoStyleReasonString",
  "autoStyleReasonSymbolContext","autoStyleReasonSymbolShadowing",
  "autoStyleReasonSyntaxError","autoStyleReasonUndefinedSymbol",
  "autoStyleReasonUnknownOption","autoStyleReasonUnwantedAssignment",
  "backgroundAppearanceOptionsStringTable","BackString",
  "badCellUuid","badElementInCharacterEncodingFile",
  "badExpressionInDictionaryFile","BadNumberOfArgsToAlternateItems",
  "BadNumberOfArgsToLinkedItems","BadNumberOfArgsToMenuObject",
  "badThirdArgInCharacterEncodingFile","BasicMathAssistantPalette",
  "bibTeXLinkNotRunningWarning","BookmarksString",
  "boolAndAllStringTable","boolAndAutomaticStringTable",
  "boolNoneAutomaticStringTable","boolStringTable",
  "BoundingBoxCategory","BoxOptionsCategory",
  "browserCategoryElementNotItemOrCategory","buildingAFMCache",
  "buildingHelpBrowserCache","buttonAlignmentStringTable",
  "buttonFrameStringTable","buttonSourceStringTable",
  "ByCategoryString","CachedDataHeader",
  "cancelButtonText","cancelButtonTextWithMnemonic",
  "canOnlySetBreakpointsInStandardFormCells","cantAdjustApplicationRegionCode",
  "cantAlignSelectionWithNoGraphics","cantAlignSelectionWithOneGraphic",
  "cantAllocate","cantAllocateSoundMemory",
  "cantAnimateSelectionWithNoVisibleGraphics","cantCloseFile",
  "cantCloseGroupUngroupedCell","cantCompleteNoKernel",
  "cantCompleteNonContentSelection","cantCompleteNonIdentifier",
  "cantConcatStrangeFormatSounds","cantConvertTypesetExprInOldKernel",
  "cantCopyBecauseCopyDisabled","cantCopyFromAboveNonContent",
  "cantCreate1x1GridBox","cantCreateCompanionPackageFile",
  "cantCreateCounterBoxInTypesetCell","cantCreateDefaultsDirectory",
  "cantCreateSoundHandle","cantDeleteNonDeletableCell",
  "cantDeletePendingCell","cantDeleteSessionDumpFile",
  "cantDontEvaluateActiveCell","cantDoToBitmapCell",
  "cantDoToFormattedCell","cantDoToMetafileCell",
  "cantDoToOleCell","cantDoToPICTCell",
  "cantDoToPostScriptOutCell","cantEditLockedCell",
  "cantEditLockedNotebook","cantEditNoSelection",
  "cantEditPrefsCell","cantEnterSearchNonTextSelection",
  "cantEnterSearchNoSelection","cantEvalNonEvalCells",
  "cantEvalNoSelection","cantEvaluateTypesetExprInOldKernel",
  "cantFindAnyFonts","cantFindCharacterEncodingFile",
  "cantFindHelpFile","cantFindHyphenationDictionaries",
  "cantFindItem","cantFindKernelHostName",
  "cantFindMacResourcesFile","cantFindMatchParenthesis",
  "cantFindNativeSystemResources","cantFindNoSelection",
  "cantFindResourceFiles","cantFindSpellingDictionaries",
  "cantFindSpellingDictionariesGeneric","cantFindXFontPattern",
  "cantFinishOpeningFile","cantGroupContentSelection",
  "cantGroupDisjointSelection","cantGroupSingleCellSelection",
  "cantImportTIFF","cantIncreaseSizeOfFile",
  "cantInsertInlineCellBecauseDisallowed","cantInsertInlineCellInUnformattedCell",
  "cantInstallExistingFile","cantOpenCharacterEncodingFile",
  "cantOpenDefaultsFile","cantOpenDictionaryCacheFile",
  "cantOpenDuplicateFile","cantOpenFile",
  "cantOpenFileB","cantOpenGroupUngroupedCell",
  "cantOpenPrefsFile","cantOpenPrintFile",
  "cantOpenPrintPipe","cantOpenSelectedFileName",
  "cantOpenSoundDevice","cantPasteColorNonContentSelection",
  "cantPasteNoKernel","cantPastePathNonContentSelection",
  "cantPastePicturesIntoText","cantPasteSoundNonCellInsertionSelection",
  "cantPasteViewPointThere","cantPrintSelectionNoSelection",
  "cantReadDataFromFile","cantReadFromDirectory",
  "cantReadResource","cantReadSpellingDictionaries",
  "cantReadTIFFObjectFromFile","cantRecordBecauseNoInitInstalled",
  "cantRemovedProtectedItemFromOrderedList","cantRenderMetafile",
  "cantReplaceNonTextSelection","cantReplaceNoSelection",
  "cantSaveOverOpenFile","cantSaveSelection",
  "cantSetAnimationParametersNoCellsSelected","cantSetDefsToDefaultStyles",
  "cantShiftNonIndented","cantSplitCellFromCurrentSelection",
  "cantStoreSealBecauseProgramLocked","cantTemplateNoKernel",
  "cantTemplateNonContentSelection","cantTemplateNonIdentifier",
  "cantTypeToCellLabelSelection","cantTypeToCellRangeSelection",
  "cantTypeToNameSelection","cantTypeToSoundSelection",
  "cantUndoThat","cantUndoTooBig",
  "cantUngroupContentSelection","cantUngroupDisjointSelection",
  "cantUngroupNonGroupedCells","cantUseKernelDuringEvaluation",
  "cantUseRefGuideBadSelection","cantWriteDataToFile",
  "CategoriesString","CDFNotebookHeader",
  "cdfPreviewMenuItems","CellBracketOptionsCategory",
  "cellClosedDueToOutOfMemory","cellContextStringTable",
  "cellCouldNotBeFormatted","CellDisplayOptionsCategory",
  "CellElementSpacingsCategory","CellEvaluationOptionsCategory",
  "cellFrameMarginsStringTable","CellFrameOptionsCategory",
  "cellFrameStringTable","cellGoneError",
  "CellInsertionMenu","CellLabelCategory",
  "cellLabelPositioningStringTable","cellNoteFoundWhereSpecified",
  "CellOptionsCategory","CellPageBreakingCategory",
  "CellPropertiesCategory","cellTagNotFoundInRefGuide",
  "CellTagsCategory","changedScriptRestartWarning",
  "changingExternalChannelFunctionsMainText","changingExternalChannelFunctionsSubText",
  "changingTrustedPathMainText","changingTrustedPathSubText",
  "characterEncodingStringTable","ChartElementSchemesPalette",
  "CheckBoxChecked","CheckBoxMixed",
  "CheckBoxUnchecked","checkingSaveFileString",
  "childProcessError","choosePrintFileString",
  "ClassroomAssistantPalette","cleanStartMessage",
  "clickOptionsPrompt","cLineTokenStringID",
  "closedOpenStringTable","closeRunningStringNumA",
  "closeRunningStringNumB","CloudDialogs",
  "CloudLoginDialog","CloudLoginDialogStrings",
  "CMYKColorValueSelectorStrings","codeAssistColorChooseMenuString",
  "codeAssistColorSchemeChooseMenuString","codeAssistConvertToMenuString",
  "codeAssistConvertToSectionCellMenuString","codeAssistConvertToTextCellMenuString",
  "codeAssistDirectoryBrowseMenuString","codeAssistDocumentationMenuString",
  "codeAssistFileBrowseMenuString","codeAssistFreeFormInputMenuString",
  "codeAssistGradientChooseMenuString","codeAssistIncludedCompletionsStringTable",
  "codeAssistIndexedChooseMenuString","codeAssistMatchingAlgorithmStringTable",
  "CodeAssistOptionsCategory","codeAssistStaticMenuExpr",
  "codeAssistWolframAlphaChooseMenuString","CodeCaptionsText",
  "codeConvertToStringMenuString","codeFreeFormLinguisticInputMenuString",
  "ColorSchemeChooserStrings","ColorSchemesPalette",
  "colorSelectorPrompt","ColorSelectorSettingsCategory",
  "colorSetterElementsStringTable","columnAlignStringTable",
  "columnLinesStringTable","CommandCompletion",
  "commandTargetStringTable","CommonDefaultFormatTypesCategory",
  "CompatibilityToolbarText","compressedDataStringTable",
  "ConnectSecondaryLinks","continueButtonText",
  "continueButtonTextWithMnemonic","controlPlacementStringTable",
  "ControlsOptionsCategory","controlsRenderingStringTable",
  "conversionCellTypesStringTable","ConversionOptionsCategory",
  "convertedFileStepAsideString","convertingFileProgress",
  "convertingFileProgressRendering","convertingFileProgressStandardForm",
  "coordinatePairString","copySpecialStringTable",
  "corruptedUnicodeResource","CorruptFileLine1",
  "CorruptFileLine2","couldNotGenerateOutputForm",
  "couldntFindUnicodeCharactersTextResource","CounterBoxCategory",
  "CounterControlCategory","counterDataStringTable",
  "counterFunctionStringTable","createGridBoxTypeStringTable",
  "creatingEPSPreviewString","ctbChooseDisaster",
  "ctbChooseFailed","ctbConnectionVanished",
  "ctbConnToolFailCreate","ctbNoCommTools",
  "ctbNoTermTools","ctbNotInstalled",
  "ctbOpenConnectionFailed","ctbTermToolFailCreate",
  "CurrentColorString","DangerousSymbols",
  "DateFormat","DayNames",
  "debuggerBreakpointsWindowContents","debuggerBreakpointsWindowName",
  "DebuggerDialogs","debuggerMessageBreakpointsWindowName",
  "DebuggerSettingsCategory","debuggerStackWindowContents",
  "debuggerStackWindowName","debuggerToolsWindowContents",
  "debuggerToolsWindowName","debuggingTitleStringNum",
  "DefaultConnectionRecordName","defaultFormatTypeStringTable",
  "DefaultInlineFormatTypeStringTable","defaultKeyString",
  "DefaultLocalKernelExecutableName","defaultNewFontName",
  "defaultPasswordString","DefaultRemoteAccessString",
  "DefaultRemoteKernelExecutableName","DefaultRemoteLoginString",
  "defaultsNotebookPromptString","DefaultTemplate",
  "DelimiterWithNonStringArg","DelimiterWithTooManyArgs",
  "DeployCDFDialog","deprecatedSymbolWarningString",
  "destroyingPrivateStylesWarningStyle","DialogSettingsCategory",
  "dingbatCellStyleStringTable","DirectoryNoExist",
  "DirectoryTooLong","diskFullError",
  "diskLockedError","displayAsString",
  "displayImagePixelsStringTable","displayImageSizeString",
  "dontSaveAnyButtonText","dontSaveButtonText",
  "dontSaveButtonTextWithMnemonic","dragginFrameString",
  "DrawingToolsDialog","dummyPendingOutputForm",
  "duplicateAutoConnectPacketName","DynamicRegistrationURL",
  "DynamicUpdatingToolbarText","EditCellTagsSettingsCategory",
  "EditingOptionsCategory","editSharedStyleSheetText",
  "elapsedTimeString","embeddedCDFTemplate",
  "embeddedCDFTemplateWithAltImage","EmbededPSHeaderStringID",
  "EmbededPSPreHeaderStringID","endNoteNotRunningWarning",
  "enterPasswordTitleString","EnterpriseCDFNotebookHeader",
  "EPSDummyText1","EPSDummyText2",
  "EPSDummyText3","EPSFHeaderStringID",
  "EPSFIncludeResourceAtEndStringID","EPSFScalingID",
  "EPSFTrailerStringID","errorInConvertColorFunction",
  "errorInPacket","errorLaunchingWebBrowser",
  "ErrorsDialogSettingsCategory","errorTimeStringANum",
  "errorTimeStringBNum","errorWhileOpeningURL",
  "evaluationCompletionStringTable","evaluationDoneAlert",
  "evaluationModeStringTable","evaluationNonStandardFormMainText",
  "evaluationNonStandardFormSubText","evaluationPendingDescription",
  "evaluationQueueActionsTable","evaluationTraditionalFormMainText",
  "execFailed","ExperimentalBoxOptionsCategory",
  "ExpirationDateFormat","expirationDateStringPrefix",
  "ExportDialogs","ExportMultipleCellsOptionsCategory",
  "ExportNativeGraphicsOptionsCategory","ExportPostScriptOptionsCategory",
  "ExportQuickTimeOptionsCategory","ExportTypesetOptionsCategory",
  "ExpressionFormattingCategory","ExpressionFormattingDisplayCategory",
  "ExpressionFormattingTraditionalCategory","extraFrontEndSymbolsTable",
  "FailedToFindExpression","FailedToReplaceOccurrences",
  "falseOrAutomaticStringTable","FavoriteFileDefaultName",
  "featureEnableFailureAlternateFileFormats","featureEnableFailureCopy",
  "featureEnableFailureEdit","featureEnableFailureEvaluate",
  "featureEnableFailureLocalEvaluate","featureEnableFailurePlaceOutput",
  "featureEnableFailurePrint","featureEnableFailureSave",
  "FEBitmaps","FEExpressions",
  "FEStrings","fileChangeProtectionStringsTable",
  "fileContentsStringTable","fileFilters",
  "fileGoneButInMemory","fileGoneError",
  "fileLeaderTrailerStringTable","FileLocationsCategory",
  "FileNameDialogSettingsCategory","fileNotifyError",
  "fileOnDiskChanged","fileOnDiskChangedWarning",
  "fileOutlineNotFoundWhereSpecified","FileWriteFailed",
  "findPrefsPromptString","FindReplaceDialog",
  "FindSettingsCategory","findSharedStyleSheetString",
  "findUserFilePromptString","findWebBrowserString",
  "finishedSpellChecking","FirstArgOfAlternateItemsWasNotList",
  "firstArgOfBrowserCategoryNotString","FirstArgOfLinkedItemsWasNotList",
  "FirstArgOfMenuWasNotString","firstArgToFunctionBrowserItemNotString",
  "FirstOptionsCategory","fixCoordOrAutomaticAngleStringTable",
  "fixCoordOrAutomaticOrFitStringTable","fixCoordOrAutomaticStringTable",
  "FontOptionsCategory","fontPostScriptNameNoteFontStringTable",
  "FontPropertiesCategory","fontsNotListedInFontsMenu",
  "fontTypeStringTable","FontVariationsCategory",
  "formattingHaltedByUserInterrupt","formattingNotebookContents",
  "FormattingOptionsCategory","ForwardString",
  "FoundExpression","FoundExpressionInBeginningOfNotebook",
  "FoundExpressionInEndOfNotebook","FoundOccurrence",
  "FoundOccurrences","fractionMultilineStringTable",
  "FrontEndPostScriptDefinitions","frontEndPromptName",
  "functionInformationContextError","functionInformationOptionsError",
  "functionInformationTemplateError","GEArrowheadsArgCount",
  "GEArrowheadsBadForm","GEArrowheadsBadGraphics",
  "GEArrowheadsBadPosition","GEArrowheadsBadPositionRange",
  "GEArrowheadsBadScale","GEArrowheadsBadShaftForeshortening",
  "GEArrowheadsErrorsInGraphics","GEArrowheadsExtraElements",
  "GEArrowMultiObjectNotSupported","GEAxesBadTicksSpec",
  "GEAxesBadTicksSpecList","GEAxesNotListOrFunction",
  "GEBad2DCoordinate","GEBad2DSingleCoordinate",
  "GEBad3DCoordinate","GEBadAngleOrder",
  "GEBadAngleSpecification","GEBadArrayDimensionsCoordinate",
  "GEBadArrowheadAppearanceOption","GEBadCoordList",
  "GEBadCylinderCoordinatePairSpecification","GEBadCylinderRadiusListSpecification",
  "GEBadDimension","GEBadLightAngleSpecification",
  "GEBadLightColorSpecification","GEBadLightDistanceAttenuationSpecification",
  "GEBadLightingSpecification","GEBadLightPositionSpecification",
  "GEBadNumberPair","GEBadOffsetBase",
  "GEBadRadius","GEBadRadiusList",
  "GEBadRadiusMember","GEBadRaster3DDataCMYKColorPlural",
  "GEBadRaster3DDataCMYKColorSingular","GEBadRaster3DDataLABColorPlural",
  "GEBadRaster3DDataLABColorSingular","GEBadRaster3DDataLCHColorPlural",
  "GEBadRaster3DDataLCHColorSingular","GEBadRaster3DDataLUVColorPlural",
  "GEBadRaster3DDataLUVColorSingular","GEBadRaster3DDataXYZColorPlural",
  "GEBadRaster3DDataXYZColorSingular","GEBadRasterDataCMYKColorPlural",
  "GEBadRasterDataCMYKColorSingular","GEBadSimple2DCoordinate",
  "GEBadSimple3DCoordinate","GEBadViewMatrix",
  "GEBadViewMatrixPosition","GEBadViewpoint",
  "GEBadViewpointForPerspectiveProjection","GEBadViewRange",
  "GEBadViewVector","GEDirectiveBadContext",
  "GEDirectiveReadError","GEEdgeFormBadArgument",
  "GEFaceGridBadSpec","GEFaceGridsBadFaceSpecNotList",
  "GEFaceGridsBadFaceVector","GEFaceGridsBadFaceVectorValue",
  "GEFaceGridsBadLineSpec","GEFaceGridsBadStyledLineSpec",
  "GEFaceGridsBadValue","GEFaceGridsElementNotNumberOrList",
  "GEFaceGridsOneOneRequired","GEFaceGridsOnlyOneOneAllowed",
  "GEFrameTicksBadTickSpec","GEFrameTicksBadTicksSpec",
  "GEGeometricTransformation3DBadTranslation","GEGLViewDebugPrint",
  "GEGraphCoordBadCoordinate","GEGraphCoordBadInvisibleListForm",
  "GEGraphCoordBadMultiObjectForm","GEGraphCoordBadSingleObjectForm",
  "GEGraphCoordCoordCountNotToSpec","GEGraphCoordIndexToLarge",
  "GEGraphCoordIndexToSmall","GEGraphCoordObjectCountNotToSpec",
  "GEGraphicsComplexIndexOutOfRangeCoordinate","GEGridLinesBadAxisSpec",
  "GEGridLinesBadLineSpec","GEGridLinesBadStyle",
  "GEGridLinesBadValue","GEHeadOnly",
  "GEIgnoringExpression","GEInsetBadDestination",
  "GEInsetBadObj","GEInsetBadObjUnsupported",
  "GEInsetBadSize","GEInsetBadSource",
  "GELocatorBadDestination","GeneralArgb",
  "GeneralArgbu","GeneralArgm",
  "GeneralArgmu","GeneralArgr",
  "GeneralArgrx","GeneralArgt",
  "GeneralArgtu","GeneralArgx",
  "GeneralGmat","Generallvsym",
  "GeneralMatrix","GeneratedCellStylesCategory",
  "GENotDirective","GENotPrimitiveOrDirective",
  "GEOpenGLRunningError","GEOpenGLShaderCompileError",
  "GEOpenGLShaderLinkError","GEOperationNotPermitted",
  "GEPlotRangePaddingBadValue","GERaster3DBadDataAutomaticPlural",
  "GERaster3DBadDataAutomaticSingular","GERaster3DBadDataGrayLevelPlural",
  "GERaster3DBadDataGrayLevelSingular","GERaster3DBadDataHuePlural",
  "GERaster3DBadDataHueSingular","GERaster3DBadDataRGBColorPlural",
  "GERaster3DBadDataRGBColorSingular","GERaster3DBadDestination",
  "GERaster3DBadDestinationCoord","GERaster3DBadRange",
  "GERaster3DBadRangeValue","GERaster3DNullRange",
  "GERasterBadDataAutomaticPlural","GERasterBadDataAutomaticSingular",
  "GERasterBadDataGrayLevelPlural","GERasterBadDataGrayLevelSingular",
  "GERasterBadDataHuePlural","GERasterBadDataHueSingular",
  "GERasterBadDataLABColorPlural","GERasterBadDataLABColorSingular",
  "GERasterBadDataLCHColorPlural","GERasterBadDataLCHColorSingular",
  "GERasterBadDataLUVColorPlural","GERasterBadDataLUVColorSingular",
  "GERasterBadDataRGBColorPlural","GERasterBadDataRGBColorSingular",
  "GERasterBadDataXYZColorPlural","GERasterBadDataXYZColorSingular",
  "GERasterBadDestinationRect","GERasterBadDestinationRectCoord",
  "GERasterBadRange","GERasterBadRangeValue",
  "GERasterNullRange","GERectangleBadThirdArg",
  "GERectangleSecondPointRequired","getCoordinatesExplanationDialogMainText",
  "getCoordinatesExplanationDialogSubText","GETicksBadStyle",
  "GETicksBadTickLength","GETicksBadTickPosition",
  "GETicksTooManyElements","GETransformBadTransform",
  "GETransformBadTranslation","GEViewAngleRange",
  "GEViewPointAtViewCenter","GEViewVectorParallelToViewVertical",
  "GEViewVerticalLength","GlobalOptionsCategory",
  "globalVariableNamesStringTable","graphCoord2DHorizontalStringTable",
  "graphCoord2DSizeStringTable","graphCoord2DStringTable",
  "graphCoord2DVerticalStringTable","Graphics3DRelatedBoxOptionsCategory",
  "graphics3DRendererStringTable","GraphicsGpt",
  "GraphicsGptn","GraphicsInspectorDialog",
  "GraphicsOptionsCategory","graphicsPrintingFormatStringTable",
  "GraphicsRelatedBoxOptionsCategory","GrayLevelValueSelectorStrings",
  "grepSyntaxError","gridboxFrameStringTable",
  "GridCreationSettingsCategory","groupLikeCellStyleStringTable",
  "HandwritingInputSettingsCategory","HandwritingInputTitle",
  "HeadersFootersDialog","HeadOfMenuSetupIsNotMenu",
  "HelpBrowserSettingsCategory","HelpBrowserSetup",
  "HelpString","HelpToolbarText",
  "HelpViewerHistoryAction","HelpViewerSettingsCategory",
  "hideBrowsersButtonTitleString","HistoryOverviewDialog",
  "horizontalAlignStringTable","horizontalVerticalStringTable",
  "hostNameString","HueValueSelectorStrings",
  "HyperlinkCreationSettingsCategory","hyphenationCharacterStringTable",
  "HyphenationOptionsCategory","IFskippedUnknownSoundStringID",
  "IFsoundDataStringID","IFsoundHeaderStringID",
  "IFsoundTrailerStringID","illegalDirective",
  "illegalDirectiveHead","IllegalDirectiveValue",
  "illegalFormatForBoxData","illegalGroupingOperation",
  "illegalImageMarkersOption","illegalMathEditString",
  "illegalNinePatchImageOption","illegalOptionHeadIsNotToken",
  "IllegalOptionRHS","IllegalSurfaceColor",
  "illegalUngroupingOperation","illustratorColorsStringTable",
  "Image3DEditModeMenu","imageCacheContentsStringTable",
  "ImageEditModeMenu","imageRenderingStringTable",
  "imageSizeActionStringTable","imageSizeStringTable",
  "ImportDialogs","ImportExportOptionsCategory",
  "importPrivateCopyText","ImportTypesetOptionsCategory",
  "indexCreationFormatStringTable","InitializingSearchSystem",
  "InlineCellOptionsCategory","InputField",
  "inputPromptDebugging","inputPromptExtraManyDialog",
  "inputPromptExtraManyDialogNoKernel","inputPromptExtraNoDialog",
  "inputPromptExtraNoDialogNoKernel","inputPromptExtraOneDialog",
  "inputPromptExtraOneDialogNoKernel","InputSettingsCategory",
  "InsertCitationDialog","insertFileString",
  "insertPictureString","insertTemplateMenuString",
  "InsetBadHeight","InsetBadObject",
  "InsetBadWidth","inspectorGlobalScopeTitleString",
  "inspectorScopeInDialogStringTable","inspectorScopeStringTable",
  "inspectorSessionScopeTitleString","inspectorViewAsInDialogStringTable",
  "inspectorViewAsStringTable","installBaseDirectoryPromptString",
  "installConfirmationPromptString","installNotebookNotAPackage",
  "installNotebookNotAPalette","installNotebookNotAStyleSheet",
  "installSourceFilePromptString","InsufficientPrecision",
  "internalSyntaxError","InternationalOptionsCategory",
  "interruptedLocalized","InterruptSettingsCategory",
  "invalidClipboardContents","invalidFileOutline",
  "invalidFilePath","invalidFileType",
  "InvisibleOptionsCategory","IPCErrorEmptySelection",
  "IPCErrorNoKernel","IPCErrorNoOutput",
  "IPCErrorSyntaxError","ISOdef",
  "JapanesePostScriptFontAscent","JapanesePostScriptFontLBearing",
  "JapanesePostScriptFontName","JapanesePostScriptFontRBearing",
  "JapanesePostScriptFontWidth","kernelExitedDuringEval",
  "kernelInitWindowName","kernelNameInUse",
  "KernelPostScriptDefinitions","KernelPostScriptDefinitionsTrailer",
  "KernelPostScriptHeader","KernelPostScriptTrailer",
  "KeyEventTranslations","keysStylesStringTable",
  "LABColorValueSelectorStrings","languageCategoryStringTable",
  "languageNotAllowedByPassword","languageStringTable",
  "LastOptionsCategory","LCHColorValueSelectorStrings",
  "leftRightBottomTopStringTable","leftRightStringTable",
  "LegacyNotebookHeader","lfontNamesStringID",
  "lhsOfOptionInHelpBrowserItemNotRule","LicenseAgreement",
  "licenseExpiredTitle","licenseExpiringTitle",
  "LicenseFailureDialog","LicensingErrors",
  "LinebreakingOptionsCategory","linebreakSemicolonWeightStringTable",
  "LoadingFile","LocalizedBitmaps",
  "LocalKernelLoginCommandTemplate","LocalKernelMLOpenArgumentsTemplate",
  "localKernelName","locatorAppearanceStringTable",
  "locatorConstraintStringTable","LongDateFormat",
  "LookupString","lrMarginsTooLarge",
  "LUVColorValueSelectorStrings","machineIDString",
  "MacintoshRomanEncoding","magnificationInWindowStringTable",
  "magnificationStringTable","MainToolbarText",
  "manualAutomaticStringTable","mathEditRemoveBoxString",
  "MathematicaClosingDialog","mathematicaFontsNotInstalledError",
  "mathLinkDiedBeforeConnect","mathLinkErrorKilled",
  "mathLinkErrorNotKilled","mathlmSaysGoodByeSoonMessage",
  "MatrixDatumNonNumerical2","MatrixDatumNonNumerical3",
  "MatrixDatumNotList","MatrixDatumWrongLength",
  "maxErrorCountExceeded","maxSubsessionLevelExceeded",
  "MEArgumentCount","MEBadGridBoxReplaceDimensions",
  "MEBadOptions","MEBadSize",
  "MEBoxArgumentNotList","MEBoxNotPairs",
  "MEcursorPosition","MEExceededMaximumFormatDepth",
  "MEFormBoxBadForm","MEGeneralArgb",
  "MEGeneralArgbu","MEGeneralArgm",
  "MEGeneralArgmu","MEGeneralArgr",
  "MEGeneralArgrx","MEGeneralArgt",
  "MEGeneralArgtu","MEGeneralArgx",
  "MEGridBoxArgumentNotList","MEGridBoxNoRows",
  "MEGridBoxOutsideAllowedDimensions","MEGridBoxRowNoElements",
  "MEGridBoxUnequalRows","MEillegalOptionBadHead",
  "MEillegalOptionBadRHS","MEillegalOptionLHSIsNotToken",
  "MEillegalOptionName","MEIllegalOptionName",
  "MEillegalOptionNotARule","MEIllegalStyleBoxOptionalArg",
  "MEInputFieldBadType","MEinternalEditingErrorBadPattern",
  "MEinternalEditingErrorParserError","MEinternalErrorUndefinedOperator",
  "MEinternalFormattingErrorZeroWidthRepeat","MEinternalLineWrappingError",
  "MEinternalSelectionError","MEMathLinkErrorWhileReadingBox",
  "MEMissingBoxData","MEMultiscriptBoxBadBase",
  "MEMultiscriptBoxBadPostscriptPair","MEMultiscriptBoxBadPostscriptPairCount",
  "MEMultiscriptBoxBadPostscripts","MEMultiscriptBoxBadPrescriptPair",
  "MEMultiscriptBoxBadPrescriptPairCount","MEMultiscriptBoxBadPrescripts",
  "MEMultiscriptBoxBadTag","MEMultiscriptBoxPostscriptsNotList",
  "MEMultiscriptBoxPrescriptsNotList","MEMultivaluedControlDefaultAppearanceSpecified",
  "MEMultivaluedControlMissingValue","MEMultivaluedControlMissingValueList",
  "MEMultivaluedControlNonDefaultAppearance","MEMultivaluedControlValuesListShort",
  "MEnoDestination","MEnoEmptyBox",
  "MEnotMathEditCell","menuAppearanceStringTable",
  "menuCommandKeyStringTable","MENumberExceedesMaximumDigits",
  "MenuSetup",
  "MenuSettingsCategory","MEOutputOnly",
  "MEOverlayBoxMissingOverlayList","MEPaneSelectorBoxBadViewSpecifier",
  "MEPaneSelectorBoxMissingSpecifierList","MEPaneSelectorBoxMissingValue",
  "MERowBoxArgumentNotList","MEShortNameConflict",
  "MEShowStringCharactersDisallowsEdits","MessageOptionsCategory",
  "messageTimeStampFormat","MessageToolbarText",
  "MEsubSuperAdd","METabViewBoxBadLabelBox",
  "METabViewBoxMissingSpecifierList","METabViewBoxMissingValue",
  "METabViewBoxViewSpecifierBadLength","METabViewBoxViewSpecifierNotList",
  "METemplateArgBoxSlot","METemplateBoxBadArgs",
  "METemplateBoxBadDisplayFunction","METemplateBoxBadDspFuncTooltipMsg",
  "METemplateBoxBadTag","METemplateBoxDefaultDspFuncTooltipMsg",
  "METemplateBoxUnstableDisplayFunction","MEUnknownError",
  "MEUnknownMathEditBox","missingCascadingStyleSheet",
  "missingTextResource","MLErrorStringMLEABORT",
  "MLErrorStringMLEACCEPT","MLErrorStringMLEARGV",
  "MLErrorStringMLEBADHOST","MLErrorStringMLEBADNAME",
  "MLErrorStringMLECLOSED","MLErrorStringMLECONNECT",
  "MLErrorStringMLEDEAD","MLErrorStringMLEDEPTH",
  "MLErrorStringMLEFAILED","MLErrorStringMLEGBAD",
  "MLErrorStringMLEGETENDPACKET","MLErrorStringMLEGSEQ",
  "MLErrorStringMLEINIT","MLErrorStringMLELAUNCH",
  "MLErrorStringMLELAUNCHAGAIN","MLErrorStringMLELAUNCHFAILED",
  "MLErrorStringMLELAUNCHNAME","MLErrorStringMLELAUNCHSPACE",
  "MLErrorStringMLEMEM","MLErrorStringMLEMODE",
  "MLErrorStringMLENAMETAKEN","MLErrorStringMLENEXTPACKET",
  "MLErrorStringMLENODATA","MLErrorStringMLENODUPFCN",
  "MLErrorStringMLENOLISTEN","MLErrorStringMLENOMSG",
  "MLErrorStringMLENOPARENT","MLErrorStringMLENOTDELIVERED",
  "MLErrorStringMLEOK","MLErrorStringMLEOVFL",
  "MLErrorStringMLEPBIG","MLErrorStringMLEPBTK",
  "MLErrorStringMLEPROTOCOL","MLErrorStringMLEPSEQ",
  "MLErrorStringMLEPUTENDPACKET","MLErrorStringMLERESOURCE",
  "MLErrorStringMLEUNKNOWNPACKET","MLErrorStringMLUnknownError14",
  "MLErrorStringMLUnknownError15","MLErrorStringMLUnknownError20",
  "MLErrorStringMLUnknownError26","MLErrorStringMLUnknownError27",
  "MLErrorStringMLUnknownError28","MLErrorStringMLUnknownError29",
  "MLErrorStringMLUnknownError30","MLErrorStringMLUnknownError31",
  "MLOpenFailedError","modifyThisMenuString",
  "MonthNames","mruFunctionsMenuString",
  "multilineStringTable","multipleCitationsWarning",
  "MUnitExpressions","MUnitStrings",
  "names","NamespaceBoxTooltips",
  "neverButtonText","neverButtonTextWithMnemonic",
  "NewCellDefaultsCategory","NewGraphicsCategory",
  "newlineCorruption","NeXTAppOpeningOptionsStringTable",
  "NextString","ninePatchAppearanceStringTable",
  "noAFMFilesFound","noArgumentsToFunctionBrowserItem",
  "noButtonText","noButtonTextWithMnemonic",
  "noCompletionsError","noErrorYet",
  "noGraphicsCellsInPICSFile","noHelpFilesFound",
  "noItemsToIndex","noKernelCommand",
  "noMatchesForFindAll","noMoreInputCellsToEvaluate",
  "noMoreMatchesForFindNext","noMoreParenthesisToBalance",
  "noneAllStringTable","noneAutomaticManualStringTable",
  "noneAutomaticNumberStringTable","noneAutomaticStringTable",
  "nonUniqueCompletion","noPlaceToPasteTemplate",
  "noPrinterInstalled","noRhsNameStringTable",
  "noSuchEncodingForFont","noSuchFaceForFont",
  "noSuchFontFamily","noSuchOption",
  "NotARegularFile","NotebookConvertSettingsCategory",
  "NotebookDisplayOptionsCategory","NotebookEvaluationOptionsCategory",
  "notebookExpressionErrorNoArgs","notebookExpressionErrorNoFunction",
  "notebookExpressionErrorNoList","NotebookFileOptionsCategory",
  "notebookFindElementsStringTable","NotebookHeader",
  "notebookOpeningOptionsStringTable","NotebookOptionsCategory",
  "NotebookPropertiesCategory","notebookRendererStringTable",
  "NotebookSecurityOptionsCategory","NotebookStatisticsSettingsCategory",
  "NotebookTemplatingBitmaps","NotebookTemplatingExpressions",
  "NotebookTemplatingStrings","NotebookTrailer",
  "nothingToCopyFromAbove","nothingToExec",
  "notifyUserSavingLosesSignature","noViablePSNameForFont",
  "nowPrintingStringNum","nowSpoolingStringNum",
  "oglLoadLibraryFailed","oglPlatformNotSupported",
  "okButtonText","okButtonTextWithMnemonic",
  "oldPrefsFoundString","omegaSyntaxError",
  "onlyAutomaticStringTable","onlyNoneStringTable",
  "openFileTypesListID","openGLNotPresentError",
  "openingHelpTopic","openingNotebookFromFutureVersion",
  "openingNotebookFromFutureVersionDeadly","openingUnsupportedPackageFile",
  "openMenuItems","OptionInspectorHeading1",
  "OptionInspectorHeading2","OptionInspectorSettingsCategory",
  "optionPositionInHelpBrowserItemNotRule","optionRangeCheckError",
  "optionsButtonString","OptionTargetGlobalPreferences",
  "OptionTargetSelectedNotebook","OptionTargetSelection",
  "OtherBoxOptionsCategory","otherFunctionsMenuString",
  "OtherString","outOfServerMemory",
  "outOfStackSpace","overwriteFileStringID",
  "PackageHeader","PackageTemplate",
  "PackageToolbarText","pageNumberString",
  "pageWidthStringTable","paginatingProgressString",
  "palettesMenuAdditionalItems","paletteTypeCellStyleStringTable",
  "paneElementsStringTable","paperOrientationStringTable",
  "parsingProgressString","PartOfPathNotDirectory",
  "pasteAsMathMLMainText","pasteAsTeXMainText",
  "pasteDynamicMainText","pasteLiteralButtonText",
  "pastePathPromptString","pastePathPromptStringB",
  "pasteTemplateString","pastingCellExpressionString",
  "pastingIntoMStringString","pastingMathMLExpressionString",
  "pastingNotebookExpressionString","pastingStyleNotPresentInNotebook",
  "pastingTraditionalFormWarningMainText","pastingTraditionalFormWarningSubText",
  "pathToFileDoesntExist","personalizeProduct",
  "pictureFilesString","pipeDied",
  "pLabelString","placeholderStringTable",
  "PlayerNotebookHeader","PopupMenu",
  "positionNotIntegerInCharacterEncodingFile","positionOutOfRangeAInCharacterEncodingFile",
  "positionOutOfRangeBInCharacterEncodingFile","PostScriptColorDotID",
  "PostScriptDontPreserveAspectStringID","PostScriptFontSetupID",
  "PostScriptGrayDotID","PostScriptNameToFontDescription",
  "PostScriptPreserveAspectStringID","PostScriptScalingString1ID",
  "PostScriptScalingString2ID","PostScriptSetScreenStringID",
  "PostScriptToMacFaceNamesID","PostScriptToMacFontNamesID",
  "PostScriptUseImageStringID","PostScriptUseMimageStringID",
  "PostScriptUseSpecialMimageStringID","postSelectionStringTable",
  "PredictiveInterfaceBitmaps","PredictiveInterfaceExpressions",
  "PredictiveInterfaceLocalizableBitmaps","PredictiveInterfaceStrings",
  "preemptiveOrQueuedStringTable","PreferencesDialog",
  "PreferencesSettingsCategory","prefsFileModifiedMainText",
  "prefsFileModifiedSubText","prefsFileNotReadable",
  "previewProWindowTitle","previewWindowTitle",
  "PreviousString","PrintingCategory",
  "printingError","PrintingOptionsCategory",
  "printSelectionFrom","PrivateCellOptionsCategory",
  "PrivateEditingOptionsCategory","PrivateEvaluationOptionsCategory",
  "PrivateFontOptionsCategory","PrivateFrontEndOptionsCategory",
  "PrivateNotebookOptionsCategory","PrivatePathsCategory",
  "ProductSpecificToolbarText","ProgressBar",
  "ProgressBarBackground","ProgressBarIndeterminate",
  "progressTextBackColor","progressTextColor",
  "progressTextLocation","PSCodeError",
  "PSDummyText1","PSDummyText2",
  "PSDummyText3","PSDummyText4",
  "PSDummyText5","pserr",
  "PSHeaderStringID","PSIncludeResourceAtEndStringID",
  "purchaseLicenseButtonText","quitButtonText",
  "quitButtonTextWithMnemonic","quitKernelDialogMainText",
  "quittingWithOpenParentLinks","RadioButtonChecked",
  "RadioButtonUnchecked","Raster3DRslim",
  "Raster3DRsrec","rasterizationResolutionStringTable",
  "RasterRslim","RasterRsrec",
  "reachedEndOfNotebookString","readingCellsProgressString",
  "readingTypeStringTable","reallyDeleteAllOutputMainText",
  "reallyDeleteAllOutputSubText","recursiveButtonText",
  "refDatabaseParseError","refSystemFormatFailure",
  "refSystemNotRunning","regconvBadCKey",
  "regconvBadList","regconvBadOptn",
  "regconvCbckFcn","regconvConvBin",
  "regconvFlbrDes","regconvFmtName",
  "regconvIntFunc","regconvMacFile",
  "regconvMimeTyp","regconvObjcTyp",
  "regconvPersist","regconvRawData",
  "regconvWldCard","relativeOrAbsoluteStringTable",
  "RemoteKernelMLOpenArgumentsTemplate","RemoteSSHKernelLoginCommandTemplate",
  "removeOptionsWarningMainText","removeOptionsWarningSubText",
  "renderingDeviceStringTable","renderingEngineStringTable",
  "renderingEngineWinStringTable","renderingMethodStringTable",
  "RenderingOptionsCategory","renderingTitleStringNum",
  "ReplacedOccurrence","ReplacedOccurrences",
  "reportActionStringTable","reportConsoleActionStringTable",
  "requestedPartOutOfRangeError","resizingFrameString",
  "resizingGraphicString","resizingShadeString",
  "retryServerText","revertText",
  "reviewButtonText","reviewUnsavedDocsClosingDialogMainText",
  "reviewUnsavedDocsDialogSubText","reviewUnsavedDocsLoggingOutDialogMainText",
  "reviewUnsavedDocsQuittingDialogMainText","RGBColorValueSelectorStrings",
  "rLabelString","rotationActionStringTable",
  "roundingStringTable","rowLinesStringTable",
  "rulerUnitsStringTable","runningTitleStringNum",
  "SafeContexts","SafeExpressions",
  "safeFileOpenStringTable","safeFileSaveStringTable",
  "saveAsSpecialStringTable","saveAsStringNum",
  "saveButtonText","saveButtonTextWithMnemonic",
  "saveChangesBeforeQuittingStringNum","saveChangesStringNum",
  "saveClosedGroupChangesBeforeQuittingStringNum","saveClosedGroupChangesStringNum",
  "saveCompanionPackageMainText","saveCompanionPackageSubText",
  "saveFilePromptString","saveMenuItems",
  "savePackageMainText","savePackageSubText",
  "savingFileString","savingRenderedImagesProgressString",
  "ScopeString","ScrollingOptionsCategory",
  "scrollPositionStringTable","searchHaltedByUserInterrupt",
  "SearchString","searchStringTooLong",
  "searchTypeCellStyleStringTable","SearchTypeString",
  "secondArgOfBrowserCategoryNotString","SecondArgOfMenuWasNotList",
  "SecurityToolbarText","SelectAFile",
  "selectFilePromptString","selectionMoveDirectionStringTable",
  "selectionUnitStringTable","semanticErrorDuringFileReading",
  "sharedStyleSheetNotFound","ShortDayNames",
  "ShortMonthNames","showAllMenuString",
  "showAtStartupStringTable","showBrowsersButtonTitleString",
  "showTemplatesMenuString","sizeNoteFontStringTable",
  "skippedUnknownSoundStringID","slantNoteFontStringTable",
  "sliderAppearanceStringTable","SliderBackground2D",
  "SliderBar2DHorizontal","SliderBar2DVertical",
  "SliderBarHorizontal","SliderBarVertical",
  "SliderThumb2D","SliderThumbDownArrow",
  "SliderThumbHorizontal","SliderThumbLeftArrow",
  "SliderThumbRightArrow","SliderThumbUpArrow",
  "SliderThumbVertical","SlideShowPalette",
  "SlideshowToolbarText","soundHeaderStringID",
  "soundPlayerElementsStringTable","soundTrailerStringID",
  "spanboxBadFont","spanboxHashTableBroken",
  "spanMaxStringTable","spanMinStringTable",
  "SpanningCharacterOptionsCategory","SpeakAboveCellSelection",
  "SpeakBelowCellSelection","SpeakCellRangeSelection",
  "SpeakEmptyNotebookSelection","SpeakNoSelection",
  "SpecialCharactersPalette","specialEditButtonStringTable",
  "speechManagerNotInstalled","SpeechNavigationOptionsCategory",
  "spellCheckerScopeInDialogStringTable","SpellCheckerSettingsCategory",
  "SpellingDictionariesCategory","SpellingOptionsCategory",
  "spellingOptionsLanguageStringTable","spellingOptionsWordSplittingStringTable",
  "spellingOptionsWordTypesStringTable","spellMenuItemAddToDictionary",
  "spellMenuItemIgnore","spellMenuItemIgnoreAll",
  "spellMenuItemNoSuggestions","spherCartStringTable",
  "sshCantFindKernelHostName","sshConnectionTerminated",
  "sshFailedToExecute","sshFailedToNetwork",
  "sshHostKeyChanged","sshHostKeyRejected",
  "sshHostKeyUnknown","sshInvalidPrivateKey",
  "sshKnownHostFormat","sshLocalNetworkError",
  "sshLowNetworkResources","sshNetworkUnreachable",
  "sshRefusedConnection","sshTimedOut",
  "startupMessageActivation","startupMessageEight",
  "startupMessageFive","startupMessageFour",
  "startupMessageNine","startupMessageOne",
  "startupMessageSeven","startupMessageSix",
  "startupMessageThree","startupMessageTwo",
  "statisticsDomainStringTable","studentTitle",
  "styleDataStringA","styleDataStringB",
  "styleDataStringC","styleDataStringD",
  "styleDataStringIllFormed","styleDataStringInherited",
  "StyleDialogDockedCell","StyleNameDialogSettingsCategory",
  "stylesDialogMainText","styleSheetMenuAdditionalItems",
  "StylesheetThumbnails","StylesheetToolbarText",
  "stylesTitleStringNum","StyleString",
  "subMenuIsEmpty","synchronousUpdatingStringTable",
  "syntaxErrorInBrowserIndexFile","syntaxErrorInCellContent",
  "syntaxErrorInCellExpressionText","syntaxErrorInCharacterEncodingFile",
  "syntaxErrorInDictionaryFile","syntaxErrorInFileMainText",
  "syntaxErrorInFileSubText","syntaxErrorInHelpBrowserFormat",
  "syntaxErrorInLinkSetupFile","syntaxErrorInNotebookFile",
  "syntaxErrorInPreferencesFile","syntaxErrorInTextResource",
  "syntaxErrorInValueString","syntaxErrorReadingNotebookData",
  "SystemConfigurationOptionsCategory","SystemInformationDialog",
  "SystemMenuSetup","tabFillingStringTable",
  "TagBoxTooltips","tbMarginsTooLarge",
  "TemplateBoxTooltips","textAlignmentStringTable",
  "TextBadDirection","TextBadOffset",
  "textCapTypeStringTable","textClipboardTypeTable",
  "TextContentOptionsCategory","TextDirectionIndeterminate",
  "textJustificationStringTable","TextLayoutOptionsCategory",
  "textScriptPositionStringTable","thirdArgOfBrowserCategoryNotList",
  "tLabelString","tokenNotFoundInHelpBrowser",
  "TokenTranslationDictionary","toolStringTable",
  "ToolTipBack","ToolTipBackward",
  "ToolTipBadgeOfShame","ToolTipCenter",
  "ToolTipCopy","ToolTipCut",
  "ToolTipCyclic","ToolTipDoubleClickToEdit",
  "ToolTipDoubleClickToEditKeyForDrawingTools","ToolTipFaster",
  "ToolTipForward","ToolTipForwardBackward",
  "ToolTipFunctionBrowserBack","ToolTipFunctionBrowserForward",
  "ToolTipFunctionBrowserNext","ToolTipFunctionBrowserPrevious",
  "ToolTipJustified","ToolTipKeyToGetCoordinates",
  "ToolTipKeyToGetPixels","ToolTipLeft",
  "ToolTipMagnifier","ToolTipMonitor",
  "ToolTipNew","ToolTipOpen",
  "ToolTipPaste","ToolTipPause",
  "ToolTipPlay","ToolTipPrint",
  "ToolTipProperties","ToolTipReset",
  "ToolTipResetPlay","ToolTipRight",
  "ToolTipSave","ToolTipSlower",
  "ToolTipStatus","ToolTipStepLeft",
  "ToolTipStepRight","ToolTipStyle",
  "ToolTipUndo","TooManyFilesOpenForProcess",
  "TooManyFilesOpenForSystem","tooManyUnicodeSubfonts",
  "ToPostScriptOptionsCategory","trackingNoteFontStringTable",
  "transitionDirectionStringTable","transitionDurationStringTable",
  "transitionEffectStringTable","TranslationOptionsCategory",
  "triedToAutoSaveUntitledNotebook","TRMcantFindAnyResourceFiles",
  "TRMcantOpenRawResourceFile","TRMcantOpenResourceFile",
  "TRMcantReadFullResource","TRMcantReadRawResourceFile",
  "TRMnoFileForResource","TRMresourceOutOfRange",
  "TRMsyntaxErrorInResourceFile","twoByteSyntaxCharacterAutoReplacementsTable",
  "UnableToCompleteSelection","unableToFindKernel",
  "unableToLaunchKernel","unableToOpenFileForWrite",
  "unableToOverwriteFile","unchangedVersionMessage",
  "UndocumentedDynamicTrafficOptionsCategory","UndocumentedEventOptionsCategory",
  "UndocumentedExperimentalOptionsCategory","UndocumentedGraphicsAttributesCategory",
  "UndocumentedObsoleteOptionsCategory","UndocumentedOptionsCategory",
  "UndocumentedRenderingOptionsCategory","undoInformationDescriptionText",
  "UndoOptionsCategory","UnicodeCharacters",
  "unicodeEntryInvalidInCharacterEncodingFile","unicodeOutOfRangeInCharacterEncodingFile",
  "UnknownCommandInKeyEvents","UnknownCommandInMenu",
  "unknownEncodingTypeInCharacterEncodingFile","UnknownHeadInMenuSetup",
  "unknownKernelName","unknownMenuItemTarget",
  "UnknownObjectInMenuSetup","unknownOptionInHelpBrowserItem",
  "unknownPacket","UnknownSymbolInMenuSetup",
  "unrecognizedOrBoxHeadInTextData","unrecoverableFileError",
  "unrecoverableMathLinkError","untitledStringNoNum",
  "untitledStringNum","URL2HyperlinkTemplate",
  "URLConnecting","URLDetectingProxy",
  "URLDownloading","URLLocating",
  "urlPrefixStrings","URLRedirecting",
  "usedConvertCommandWithNoGoodCells","UsingUnknownCommandKey",
  "ValueBoxCategory","variablesMenuString",
  "VersionedStylesheetToolbar","versionString",
  "verticalAlignStringTable","ViewAsString",
  "viewProjectionStringTable","WABitmaps",
  "WAExpressions","WALocalizableBitmaps",
  "warningOrErrorBeep","WAStrings",
  "weightNoteFontStringTable","WelcomeScreen",
  "windowElementsStringTable","windowFrameElementsStringTable",
  "windowFrameStringTable","WindowPropertiesCategory",
  "WindowsANSIEncoding","windowSizeStringTable",
  "windowTitleStringTable","windowToolbarsStringTable",
  "WolframCloudAccountSettingsURL","WolframCloudLoginErrors",
  "WolframCloudSettingsCategory","wolframCloudSignIn",
  "wolframCloudSignOut","WolframCloudSyncToolbar",
  "WolframPlayerPublishURL","wordInIncorrectWordsString",
  "wordTypesAlternateSpellingsString","wordTypesCaseDifferencesString",
  "wordTypesCompoundWordsWithHyphensString","wordTypesCompoundWordsWithInternalCapsString",
  "wordTypesCompoundWordsWithUnderscoresString","wordTypesEncliticFormsString",
  "wordTypesMisspelledWordString","wordTypesNumbersString",
  "wordTypesRepeatedWordsString","wordTypesRomanNumeralsString",
  "wordTypesSingleCharacterWordsString","wordTypesUncapitalizedStartOfSentenceString",
  "wordTypesWordsInAllCapsString","wordTypesWordsInURLString",
  "wordTypesWordsWithNumbersString","WrappedAroundNotebookEnd",
  "wrappedToBeginningText","wrappedToEndText",
  "WritingAssistantPalette","wrongArgCountInCharacterEncodingFile",
  "wrongHeadInCharacterEncodingFile","wrongNumberOfArgumentsInBrowserIndex",
  "wrongTypeOfParenthesis","wrshConnectionTerminated",
  "wrshFailedToExecute","wrshFailedToNetwork",
  "wrshLocalNetworkError","wrshLowNetworkResources",
  "wrshNetworkUnreachable","wrshRefusedConnection",
  "wrshTimedOut","xLabelString",
  "xyAlignmentStringTable","XYZColorValueSelectorStrings",
  "yesButtonText","yesButtonTextWithMnemonic",
  "yLabelString","yourConnectionToolNotInstalled",
  "yourTerminalToolNotInstalled","zLabelString"
  };


$FEResourceRuleListing={"NotebookTemplatingExpressions", "NotebookTemplatingBitmaps", "NotebookTemplatingStrings", "PredictiveInterfaceStrings", "PredictiveInterfaceExpressions", "PredictiveInterfaceBitmaps", "WAExpressions", "WABitmaps", "WAStrings", "WALocalizableBitmaps", "FEBitmaps", "ActivationDialog", "DeployCDFDialog", "PreferencesDialog", "ImportDialogs", "ExportDialogs", "HistoryOverviewDialog", "GraphicsInspectorDialog", "HeadersFootersDialog", "InsertCitationDialog", "SystemInformationDialog", "LicenseFailureDialog", "WelcomeScreen", "CloudLoginDialog", "CloudDialogs", "MathematicaClosingDialog", "LicensingErrors", "WolframCloudLoginErrors", "RGBColorValueSelectorStrings", "GrayLevelValueSelectorStrings", "CMYKColorValueSelectorStrings", "HueValueSelectorStrings", "LABColorValueSelectorStrings", "LCHColorValueSelectorStrings", "LUVColorValueSelectorStrings", "XYZColorValueSelectorStrings", "ColorSchemeChooserStrings", "LocalizedBitmaps", "twoByteSyntaxCharacterAutoReplacementsTable", "FEStrings", "Image3DEditModeMenu", "ImageEditModeMenu", "undoInformationDescriptionText", "SlideshowToolbarText", "HelpToolbarText", "PackageToolbarText", "CompatibilityToolbarText", "SecurityToolbarText", "CodeCaptionsText", "DynamicUpdatingToolbarText", "MessageToolbarText", "StylesheetToolbarText", "ProductSpecificToolbarText", "VersionedStylesheetToolbar", "WolframCloudSyncToolbar", "TemplateBoxTooltips", "FindReplaceDialog", "DebuggerDialogs", "FEExpressions", "StylesheetThumbnails", "CloudLoginDialogStrings"};


$FEResourceStringListing=
  {
    "CMYKColorValueSelector",
    "ColorSchemeSelector",
    "CommonFrontEndInit",
    "ContextMenus",
    "FEKernelInit",
    "FontMap",
    "GetFEKernelInit",
    "GrayLevelColorValueSelector",
    "HueColorValueSelector",
    "LABColorValueSelector",
    "LCHColorValueSelector",
    "LUVColorValueSelector",
    "RGBColorValueSelector",
    "XYZColorValueSelector"
    };


$FEResourceGroups=
  Select[
    $FEResourceRuleListing,
    StringContainsQ["Expressions"|"Bitmaps"]
    ];


FEResourceFind[resources:{__Rule},resourceChunk_]:=
  Select[resources,
    StringMatchQ[ToString@First@#, ___~~resourceChunk~~___]&
    ];
FEResourceFind[feList:{__String}, resourceChunk_]:=
FEResourceFind[
    Join@@(
      Replace[FrontEndResource[#],
        e:Except[_List]:>{#->e}]&/@feList),
    resourceChunk];
FEResourceFind[fe_String, resourceChunk_]:=
  FEResourceFind[{fe}, resourceChunk];
FEResourceFind[resourceSet_List]:=
  FEResourceFind[resourceSet, "*"];
FEResourceFind[Automatic,resourceChunk_]:=
  FEResourceFind[$FEResourceGroups, resourceChunk];
FEResourceFind[All,resourceChunk_]:=
  FEResourceFind[$FEResourceRuleListing, resourceChunk];
FEResourceFind[Full,resourceChunk_]:=
  FEResourceFind[$FEResourceCompleteListing, resourceChunk];
FEResourceFind[resourceChunk:Except[_List]]:=
  If[MemberQ[$FEResourceGroups,resourceChunk],
    FEResourceFind[resourceChunk,"*"],
    FEResourceFind[$FEResourceGroups,resourceChunk]
    ];


FEResourceGroup[g_]:=
  Replace[
    Select[$FEResourceGroups, MemberQ[First/@FrontEndResource[#], g]&],
    {}:>Select[$FEResourceRuleListing, MemberQ[First/@FrontEndResource[#],g]&]
    ];


FEFormatResource//Clear;
FEFormatResource[s_String]:=s;
FEFormatResource[r_Function]:=Mouseover["Function",r];
FEFormatResource[r:Except[_String]?BoxQ]:=
  RawBoxes@r;
FEFormatResource[f_String?FileExistsQ]:=
  Import[f];
FEFormatResource[FEImport[f_]]:=
  f;
FEFormatResource[n_->r_]:=n->FEFormatResource[r];
FEFormatResource[e:Except[_List|_String]]:=
  Quiet@
    Replace[
      ToExpression@e,
      $Failed:>
        Check[FEFormatResource@FEImport[e],e]
      ];
FEFormatResource~SetAttributes~Listable


Options[FEResourceBrowse]=
  {
    Format->Automatic,
    "ReturnGroup"->False
    };
FEResourceBrowse[
  rList:_?StringPattern`StringPatternQ|All|None|Automatic:None,
  pat:_?StringPattern`StringPatternQ,
  ops:OptionsPattern[]]:=
  With[
    {
      formatFunction=
        Replace[
          OptionValue[Format],
          {
            Automatic:>
              (Replace[FEFormatResource@#, $Failed:>#]&),
            None->Identity
            }
          ],
      resRaw=
        If[rList=!=None,
          FEResourceFind[rList, pat],
          FEResourceFind[pat]
          ],
      retG=TrueQ@OptionValue["ReturnGroup"]
      },
    With[
      {
        res=
          If[retG,
            Thread[
              Thread[{FEResourceGroup/@resRaw[[All, 1]], resRaw[[All, 1]]}]->
              resRaw[[All, 2]]
              ],
            resRaw
            ]
        },
      Interpretation[
        PaneColumn[
          Table[
            With[{r=r},
              Interpretation[
                Button[
                  Tooltip[formatFunction@Last@r, First@r],
                  Print@(First@r->formatFunction@Last@r),
                  Appearance->"Frameless"
                  ],
                First@r
                ]
              ],
            {r, res}
            ]
          ],
        res[[All, 1]]
        ]
      ]
    ];
FEResourceBrowse[
  s:Except[_Rule|_RuleDelayed],
  ops:OptionsPattern[]
  ]:=
  FEResourceBrowse[None,s,ops];


ButtonAppearanceBrowser[pat_]:=
  FEResourceBrowse["Appearance"]/.
    Tooltip[a_,l_]:>
      Button[l,Appearance->Replace[a,s_Symbol:>ToString[s],1]]


$FETrBaseName=
  "TokenTranslationDictionary";
$FETrFileBaseName=
  "ExtendedFEResources";
If[!ListQ@$FETrResources,
  $FETrResources=
    FrontEndResource[$FETrBaseName]
  ];
$FETrBaseFile=
  FileNameJoin@{
    $InstallationDirectory,
    "SystemFiles",
    "FrontEnd",
    "TextResources",
    "TokenTranslationDictionary.tr"
    };
$FETrListing=
  AssociationMap[
    Null&,
    $FEResourceCompleteListing
    ];
$FEResourceDirectory=
  $FETemporaryResources=
    FrontEnd`FileName@{
      $TemporaryDirectory,
      "SystemFiles",
      "FrontEnd",
      "TextResources"
      };
$FEPersistentResources=
  FrontEnd`FileName@{
    $UserBaseDirectory,
    "SystemFiles",
    "FrontEnd",
    "TextResources"
    };
$FEResourceFiles:=
  FileNames["*.tr",ToFileName@@$FEResourceDirectory,\[Infinity]];


FELoadResources[]:=(
  CurrentValue[$FrontEndSession,
    {PrivatePaths,"TextResources"}
    ]=
    DeleteDuplicates@
      Prepend[
        CurrentValue[$FrontEndSession,
          {PrivatePaths,"TextResources"}
          ],
        FrontEnd`FileName[
          Evaluate@{ToFileName@@$FEResourceDirectory}
          ]
        ];
  FrontEndExecute@FrontEnd`FlushTextResourceCaches[]
  );


$FETrTemplate=
"@|
@|
@@resource `name`
`value`
@|
";
Options[FETrExport]={
  InputForm->True,
  TemplateApply->True
  };
FETrExport[name_,value_,
  OptionsPattern[]
  ]:=
  With[{file=
    If[MatchQ[$FEResourceDirectory,_FrontEnd`FileName],
      ToFileName@@
        Append[$FEResourceDirectory,
          If[StringQ@name,
              name<>".tr",
            Switch[Last@name,
              _String,
                Last@name<>".tr",
              _List,
                FileNameJoin[Last@name]<>".tr"
              ]
            ]
          ],
      FileNameJoin@{
        $FEResourceDirectory,
        If[StringQ@name,
              name<>".tr",
            Switch[Last@name,
              _String,
                Last@name<>".tr",
              _List,
                FileNameJoin[Last@name]<>".tr"
              ]
            ]
        }
      ]
    },
    If[value===Inherited,
      Quiet@DeleteFile[file],
      Quiet@
        CreateDirectory[
          DirectoryName@file,
          CreateIntermediateDirectories->True
          ];
      Export[
        file,
        If[OptionValue[TemplateApply]//TrueQ,
          TemplateApply[
            $FETrTemplate,<|
              "name"->
                If[StringQ@name,
                  name,
                  First@name
                  ],
              "value"->
                If[OptionValue[InputForm]//TrueQ,
                  ToString[value,InputForm],
                  value
                  ]
              |>],
          If[OptionValue[InputForm]//TrueQ,
            ToString[value,InputForm],
            ToString@value
            ]
          ],
        "Text"
        ]
      ]
    ];


Options[FEAddResource]=
  Options[FETrExport];
FEAddResource[
  name_String|
    (name_String->path_),
  value_,
  ops:OptionsPattern[]
  ]:=(
  If[KeyMemberQ[$FETrListing,name],
    If[MatchQ[{path},Except[{_String}|{_List}]],
      FETrExport[name,value,
        ops,
        InputForm->False
        ],
      FETrExport[name->path,value,
        ops,
        InputForm->False
        ]
      ],
    $FETrResources=
      Normal@DeleteCases[Inherited]@
        Merge[{$FETrResources,name->value},Last];
    Quiet@
      CopyFile[$FETrBaseFile,
        ToFileName@@
          Append[$FEResourceDirectory,
            FileNameTake@$FETrFileBaseName
            ]
        ];
    FETrExport[
      $FETrBaseName->$FETrFileBaseName,
      $FETrResources
      ]
    ];
  FELoadResources[]
  );
FEAddResource[r:{(_String->_)..}]:=(
  $FETrResources=
    Normal@DeleteCases[Inherited]@
      Merge[{$FETrResources,r},Last];
  Quiet@
      CopyFile[$FETrBaseFile,
        ToFileName@@
          Append[$FEResourceDirectory,
            $FETrFileBaseName<>".tr"
            ]
        ];
    FETrExport[
      $FETrBaseName->$FETrFileBaseName,
      $FETrResources
      ]
  );


$FEExtraResources=True;
Unprotect/@{FrontEndResource,FrontEndResourceString};
FrontEndResource[
  k_String?(!KeyMemberQ[$FETrListing,#]&)
  ]/;TrueQ@$FEExtraResources:=
  FrontEndResource[$FETrBaseName,k];
FrontEndResource/:
  Set[
    FrontEndResource[k_String],
    v_
    ]/;TrueQ@$FEExtraResources:=
  (FEAddResource[k,v];v);
FrontEndResourceString/:
  Set[
    FrontEndResourceString[k_String?(KeyMemberQ[$FETrListing,#]&)],
    v_
    ]/;TrueQ@$FEExtraResources:=
  (FEAddResource[k,ToString@v];FrontEndResourceString[k]);
FrontEndResource/:
  Unset[FrontEndResource[k_String]]:=
    (FrontEndResource[k]=Inherited;)
FrontEndResourceString/:
  Unset[
    FrontEndResourceString[
      k_String?(KeyMemberQ[$FETrListing,#]&)]
    ]:=
    (FrontEndResourceString[k]=Inherited;)
Protect/@{FrontEndResource,FrontEndResourceString};


$FEKeyEventsDirectory=
  $FETemporaryResources;


$FEKeyEvents:=
  Replace[$feKeyEvents,
    Except[_Association]:>
      Set[$feKeyEvents,
        Begin["System`"];
        (End[];#)&[
          Replace[
            ToExpression[
              FrontEndResourceString["KeyEventTranslations"],
              StandardForm,
              HoldComplete
              ],
            Item[k_,a_]:>
              (k:>HoldComplete[a]),
            3]//ReleaseHold//Apply[Association]
          ]
        ]
    ];
$FEKeyEvents/:
  Unset[$FEKeyEvents]:=
    (Clear@$feKeyEvents;FEResetKeyEvents[]);
$FEKeyEvents/:
  Set[$FEKeyEvents,a_Association]:=
    ($feKeyEvents=a;feKeyEventExport[];a);


feKeyEventExport[]:=
  Block[{
    $FEResourceDirectory=
      $FEKeyEventsDirectory,
    $ContextPath=
      Prepend[$ContextPath,"FrontEnd`"]
    },
    Begin["System`"];
    (End[];#)&@
      FEAddResource[
        "KeyEventTranslations"->
          {
            Switch[$OperatingSystem,
               "MacOSX",
                 "Macintosh",
               "Windows",
                 "Windows",
               "Unix",
                 "X"],
            "KeyEventTranslations"
            },
        "EventTranslations[{\n\t``\n\t}]"~TemplateApply~
          StringRiffle[
            Map[ToString,
              ReleaseHold@
                Replace[
                  Hold@Evaluate@
                    Normal@$FEKeyEvents,{
                  (Rule|RuleDelayed)[k_,HoldComplete[v_]|v_]:>
                    RuleCondition[
                      ToString[Unevaluated@Item[k,v],InputForm],
                      True
                      ]
                  },
                  2]
              ],
            ",\n\t"
            ]
        ]
    ]


keyEventListing[k_]:=
  KeyMap[
    ReplaceAll[
      s_Symbol?(
        Function[Null,
          Context[#]===$Context,
          HoldFirst
          ]
        ):>
        RuleCondition[
          Symbol["FrontEnd`"<>SymbolName@Unevaluated[s]],
          True
          ]
        ]@*
      Replace[{
        key_String:>
          FrontEnd`KeyEvent[key],
        {key_,(Modifiers->modifiers_)|modifiers_}:>
          FrontEnd`KeyEvent[key,
            Modifiers->
              (Begin["System`"];(End[];#)&@
                ToExpression@Flatten@{modifiers})
            ]
        }]
    ]@
    Association[k]


FEKeyEventAdd[
  k:(_RuleDelayed|_Rule)|{(_RuleDelayed|_Rule)..}
  ]:=
  (
    $FEKeyEvents=
      Join[
        $FEKeyEvents,
        keyEventListing[k]
        ];
    );
FEKeyEventDrop[k_]:=
  (
    KeyDropFrom[$FEKeyEvents,
      Keys@keyEventListing@AssociationMap[Null&,Flatten@{k}]
      ];(*
		feKeyEventExport[]*)
    );
FEResetKeyEvents[]:=
  Block[{
    $FEResourceDirectory=
      $FETemporaryResources
    },
    Begin["System`"];
    (End[];#)&@
      FEAddResource[
        "KeyEventTranslations"->
          {
            Switch[$OperatingSystem,
               "MacOSX",
                 "Macintosh",
               "Windows",
                 "Windows",
               "Unix",
                 "X"],
            "KeyEventTranslations"
            },
        Inherited
        ];
    $feKeyEvents//Clear;
    ]


$FEMenuSetupDirectory=
  $FETemporaryResources;


$feMSDelimiterKey:=
  CreateUUID["Delimiter-"];
$feMSItemsKey:=
  CreateUUID["Items-"];


feUnspoolMenuExpr[e_]:=
  Replace[e,
    {
      MenuItem[l_,arg_,ops___]:>
        (
          If[MemberQ[{ops},_System`MenuKey],
            {l,FirstCase[{ops},_System`MenuKey]},
            l
            ]-><|
          "Command":>arg,
          "Options"->{ops}
          |>),
      (t:AlternateItems|LinkedItems)[items_,ops___]:>
        (
          RuleCondition[
            With[{rules=feUnspoolMenuExpr/@items},
              With[{a=Alternatives@@Map[Association,rules]},
                $feMSItemsKey-><|
                  "Type"->t,
                  "Items"->a,
                  "Options"->{ops}
                  |>
                ]
              ],
            True
            ]),
      Delimiter:>(
        $feMSDelimiterKey->
          Delimiter
          ),
      (t:Menu|HelpMenu)[l_,items_,ops___]:>
        RuleCondition[
          With[{rules=feUnspoolMenuExpr/@items},
            With[{a=Association[rules]},
              l-><|
                "Type"->t,
                "Items"->a,
                "Options"->{ops}
                |>
              ]
            ],
          True
          ]
      }];
feRespoolMenuExpr[a_Alternatives]:=
  Flatten[feRespoolMenuExpr/@Apply[List,a]];
feRespoolMenuExpr[a_Association]:=
  KeyValueMap[
    Replace[{#,#2},{
      {_,Delimiter}:>
        Delimiter,
      {l_,m_Association?(KeyMemberQ["Items"])}:>
        Switch[m["Type"],
          AlternateItems|LinkedItems,
            m["Type"][
              feRespoolMenuExpr@
                m["Items"],
              Sequence@@Lookup[m,"Options",{}]
              ],
          _,
            Lookup[m,"Type",Menu][
              l,
                feRespoolMenuExpr@
                  m["Items"],
                Sequence@@Lookup[m,"Options",{}]
              ]
        ],
      {l_,m_Association?(KeyMemberQ["Command"])}:>
        With[{
          c=Extract[m,"Command",Hold],
          o=Sequence@@m["Options"]
          },
          Replace[c,
            Hold[cmd_]:>
              MenuItem[
                If[ListQ@l,
                  First@l,
                  l
                  ],
                cmd,
                o
                ]
            ]
          ]
      }]&,
  a
  ];


If[!BooleanQ@$FEMenuExportOnEdit,
  $FEMenuExportOnEdit=True
  ];
$FEMenuSetup:=
  Replace[$feMenuSetup,
    Except[_Association]:>
      Set[$feMenuSetup,
        Begin["System`"];
        (End[];#)&[
          Association@
            feUnspoolMenuExpr@
              FrontEndResource["MenuSetup"]
          ]
        ]
    ];
$FEMenuSetup/:
  Unset[$FEMenuSetup]:=
    (Clear@$feMenuSetup;
      FEResetMenuSetup[];
      );
$FEMenuSetup/:
  Set[$FEMenuSetup,a_Association]:=
    (
      $feMenuSetup=a;
      If[$FEMenuExportOnEdit,feMenuSetupExport[]];
      a
      );
$FEMenuSetup/:
  Set[$FEMenuSetup[part___,key_],val_]:=
    (
      $FEMenuSetup;
      If[Length@{part}>0,
        Do[
          With[{p=Sequence@@Take[{part},n]},
            If[Not@AssociationQ@$feMenuSetup[p],
              $feMenuSetup[p]=
                If[Last@{p}==="Items",
                  <||>,
                  <|
                    "Type"->Menu,
                    "Items"-><||>
                    |>
                  ]
              ]
            ],
          {n,Length@{part}}
          ]
        ];
      $feMenuSetup[part,key]=val;
      If[$FEMenuExportOnEdit,feMenuSetupExport[]];
      val
      );
$FEMenuSetup/:
  Unset[$FEMenuSetup[part___,key_]]:=
    (
      $FEMenuSetup;
      $feMenuSetup[part,key]=.;
      If[$FEMenuExportOnEdit,feMenuSetupExport[]];
      );


feMenuSetupExport[]:=
  Block[{
    $FEResourceDirectory=
      $FEMenuSetupDirectory
    },
    Begin["System`"];
    (End[];#)&@
      FEAddResource[
        "MenuSetup"->
          {
            Switch[$OperatingSystem,
               "MacOSX",
                 "Macintosh",
               "Windows",
                 "Windows",
               "Unix",
                 "X"],
            "MenuSetup"
            },
        First@FrontEndExecute@
          ExportPacket[
            Cell[BoxData@
              First@
                NewlineateCodeRecursive[
                  First@feRespoolMenuExpr@$FEMenuSetup,
                  _Menu|_List
                  ],
              ExportAutoReplacements->{
                ParentList,
                "\[Infinity]"->"Infinity",
                "\.14"->" "
                }
              ],
            "InputText"
            ],
        TemplateApply->False,
        InputForm->False
        ];
    FrontEndExecute@
      FrontEnd`ResetMenusPacket[{Automatic,Automatic}]
    ]


feMenuSetupObject[cmd_,ops___]:=
  Switch[Unevaluated[cmd],
    Delimiter,
      Delimiter,
    _MenuItem|_Menu|_Association,
      cmd,
    {(_Menu|_MenuItem|Delimiter)...},
      <|
        "Items"->cmd,
        "Options"->{ops}
        |>,
    _,
      <|
        "Command":>cmd,
        "Options"->{ops}
        |>
    ];
feMenuSetupObject~SetAttributes~HoldFirst;


feMenuPath[path__]:=
  Append["Items"]@
    Riffle[
      Switch[{path},
        {"Mathematica",___},
          {path},
        _,
          {"Mathematica",path}
        ],
      "Items"]


FEMenuSetupGet[{path___String,key:{_String,___}|_String|_Integer}]:=
  With[{p=Sequence@@feMenuPath[path]},
    Replace[$FEMenuSetup[p],
      a_Association:>
        Which[
          IntegerQ@key,
            Normal[a][[key]],
          StringQ@key,
            Lookup[a,key,
               If[Length[#]>0,
                 First@#,
                 Missing["KeyAbsent",key]
                 ]&@
                 KeySelect[a,
                   MatchQ[{key,___}]
                   ]
               ],
          True,
            Lookup[$FEMenuSetup[p], Key[key]]
           ]
          ]
    ];
FEMenuSetupGet[path_String]:=
  FEMenuSetupGet@{path};


FEMenuSetupAdd[
  {path__String,pos:_Integer|None:None},
  (Rule|RuleDelayed)[lab_,cmd_],
  ops___
  ]:=
  With[{
    p=
      Sequence@@feMenuPath[path],
    lab2=
      If[MemberQ[{ops},_System`MenuKey],
        {lab,FirstCase[{ops},_System`MenuKey]},
        lab
        ]
    },
    If[pos===None,
      $FEMenuSetup[p,lab2]=
        feMenuSetupObject[cmd,ops];,
      $FEMenuSetup[p]=
        Insert[
          $FEMenuSetup[p],
          lab2->feMenuSetupObject[cmd,ops],
          pos
          ];
      ]
    ];
FEMenuSetupAdd[
  p_String,
  r:(_Rule|_RuleDelayed),
  ops___
  ]:=
  FEMenuSetupAdd[{p},r,ops];
FEMenuSetupAdd[
  p_,
  Delimiter
  ]:=
  FEMenuSetupAdd[p,
    $feMSDelimiterKey->Delimiter
    ];
FEMenuSetupAdd~SetAttributes~HoldRest;


FEMenuSetupDrop[
  {path___String,pos:(_String|{_String,___}|_Integer|None):None}
  ]:=
  With[{p=Sequence@@Most@feMenuPath[path]},
    Switch[pos,
      None,
        $FEMenuSetup[p]=.,
      _String|_List,
        $FEMenuSetup[p,pos]=.,
      _Integer,
        With[{base=$FEMenuSetup[p]},
          If[AssociationQ@#,
            $FEMenuSetup[p]=#,
            #
            ]&@
            With[{k=Keys[base["Items"]][[pos]]},
              If[KeyMemberQ[base["Items"],k],
                ReplacePart[base,
                  "Items"->
                    KeyDrop[base["Items"],If[ListQ@k,{k},k]]
                  ],
                $Failed
                ]
              ]
          ]
      ]
    ];
FEMenuSetupDrop[path_String]:=
  FEMenuSetupDrop[{path}]


FEResetMenuSetup[]:=
  Block[{
    $FEResourceDirectory=
      $FETemporaryResources
    },
    Begin["System`"];
    (End[];#)&@
      FEAddResource[
        "MenuSetup"->
          {
            Switch[$OperatingSystem,
               "MacOSX",
                 "Macintosh",
               "Windows",
                 "Windows",
               "Unix",
                 "X"],
            "MenuSetup"
            },
        Inherited
        ];
    $feMenuSetup//Clear;
    FrontEndExecute@ResetMenusPacket[{Automatic,Automatic}]
    ]


End[];



